

##### æ‚¨è¯´ï¼š

x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1) print("è®­ç»ƒé›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_train, y_train) print("è®­ç»ƒé›†ç‰¹å¾å€¼shape", x_train.shape) print('-'*50)è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä»€ä¹ˆ  print("æµ‹è¯•é›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_test, y_test) print("æµ‹è¯•é›†ç‰¹å¾å€¼shape", x_test.shape)



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªæ•°æ®é›†ï¼ˆ`li.data` ä¸ºç‰¹å¾å€¼ï¼Œ`li.target` ä¸ºç›®æ ‡å€¼ï¼‰**æŒ‰æ¯”ä¾‹åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†**ï¼Œå¹¶æ‰“å°åˆ’åˆ†åçš„æ•°æ®å†…å®¹åŠå…¶å½¢çŠ¶ã€‚ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š

------

### 1ï¸âƒ£ æ•°æ®åˆ’åˆ†ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1)
```

**å«ä¹‰ï¼š**

- `train_test_split` æ˜¯ sklearn ä¸­çš„å‡½æ•°ï¼Œç”¨æ¥**å°†åŸå§‹æ•°æ®é›†éšæœºåˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†**ã€‚
- `li.data`ï¼šæ ·æœ¬çš„ç‰¹å¾ï¼ˆäºŒç»´æ•°ç»„ï¼‰
- `li.target`ï¼šå¯¹åº”çš„æ ‡ç­¾ï¼ˆç›®æ ‡å€¼ï¼‰
- `test_size=0.25`ï¼šè¡¨ç¤º 25% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œ75% ä½œä¸ºè®­ç»ƒé›†
- `random_state=1`ï¼šè®¾ç½®éšæœºç§å­ï¼Œä¿è¯æ¯æ¬¡åˆ’åˆ†çš„ç»“æœä¸€è‡´ï¼ˆå¯å¤ç°ï¼‰

------

### 2ï¸âƒ£ æ‰“å°è®­ç»ƒé›†å†…å®¹ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print("è®­ç»ƒé›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_train, y_train)
print("è®­ç»ƒé›†ç‰¹å¾å€¼shape", x_train.shape)
```

**å«ä¹‰ï¼š**

- è¾“å‡ºåˆ’åˆ†å¾—åˆ°çš„è®­ç»ƒé›†ç‰¹å¾ï¼ˆ`x_train`ï¼‰å’Œç›®æ ‡å€¼ï¼ˆ`y_train`ï¼‰
- è¾“å‡ºè®­ç»ƒé›†ç‰¹å¾çš„ç»´åº¦ä¿¡æ¯ï¼ˆshapeï¼‰ï¼Œä¾‹å¦‚ `(112, 4)`ï¼Œè¡¨ç¤ºæœ‰112æ¡æ•°æ®ï¼Œæ¯æ¡æ•°æ®æœ‰4ä¸ªç‰¹å¾ã€‚

------

### 3ï¸âƒ£ åˆ†å‰²çº¿ï¼ˆç¾åŒ–è¾“å‡ºï¼‰ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print('-'*50)
```

**ä½œç”¨ï¼š**

- æ‰“å°ä¸€æ¡ç”± 50 ä¸ª `-` ç»„æˆçš„åˆ†å‰²çº¿ï¼Œæ–¹ä¾¿åŒºåˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„è¾“å‡ºã€‚

------

### 4ï¸âƒ£ æ‰“å°æµ‹è¯•é›†å†…å®¹ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print("æµ‹è¯•é›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_test, y_test)
print("æµ‹è¯•é›†ç‰¹å¾å€¼shape", x_test.shape)
```

**å«ä¹‰ï¼š**

- è¾“å‡ºåˆ’åˆ†å¾—åˆ°çš„æµ‹è¯•é›†ç‰¹å¾ï¼ˆ`x_test`ï¼‰å’Œç›®æ ‡å€¼ï¼ˆ`y_test`ï¼‰
- è¾“å‡ºæµ‹è¯•é›†ç‰¹å¾çš„ç»´åº¦ä¿¡æ¯ï¼ˆshapeï¼‰ï¼Œä¾‹å¦‚ `(38, 4)`ï¼Œè¡¨ç¤ºæœ‰38æ¡æµ‹è¯•æ•°æ®ã€‚

------

### ğŸ” æ€»ç»“ï¼š

è¿™æ®µä»£ç çš„æ€»ä½“ä½œç”¨æ˜¯ï¼š

> å°†ä¸€ä¸ªæ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶æ‰“å°å®ƒä»¬çš„å†…å®¹å’Œç»´åº¦ä¿¡æ¯ï¼Œç”¨äºåç»­çš„æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°ã€‚

å¦‚æœä½ æ˜¯åœ¨å¤„ç†æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œæ¯”å¦‚é¸¢å°¾èŠ±åˆ†ç±»ã€æ‰‹å†™æ•°å­—è¯†åˆ«ç­‰ï¼Œè¿™æ˜¯éå¸¸å¸¸è§çš„å‡†å¤‡æ­¥éª¤ä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

ä¸ºä»€ä¹ˆè®¾ç½®random_state=1



###### ChatGPT è¯´ï¼š

è®¾ç½® `random_state=1` çš„ç›®çš„æ˜¯ï¼š

> **è®© `train_test_split()` åœ¨æ¯æ¬¡è¿è¡Œæ—¶åˆ’åˆ†å‡ºçš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†å§‹ç»ˆä¸€è‡´ï¼ˆå¯å¤ç°ï¼‰**ã€‚

------

### ğŸ“Œ èƒŒæ™¯è§£é‡Šï¼š

`train_test_split()` é»˜è®¤æ˜¯**éšæœºåˆ’åˆ†æ•°æ®**çš„ã€‚å¦‚æœä½ ä¸è®¾ç½® `random_state`ï¼Œæ¯æ¬¡è¿è¡Œç¨‹åºæ—¶ï¼Œåˆ’åˆ†çš„ç»“æœéƒ½å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ï¼š

- è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸åŒï¼›
- æ¨¡å‹è®­ç»ƒç»“æœå¯èƒ½å˜åŒ–ï¼›
- ä¸æ–¹ä¾¿è°ƒè¯•å’Œå¯¹æ¯”ä¸åŒæ¨¡å‹ã€‚

------

### âœ… è®¾ç½® `random_state=1` å¸¦æ¥çš„å¥½å¤„ï¼š

| é¡¹ç›®             | å«ä¹‰                                          |
| ---------------- | --------------------------------------------- |
| `random_state=1` | æŒ‡å®šäº†éšæœºç§å­ä¸º 1                            |
| ç¨³å®šæ€§           | æ¯æ¬¡åˆ’åˆ†ç»“æœéƒ½ç›¸åŒ                            |
| å¯å¯¹æ¯”æ€§         | å¤šæ¬¡è®­ç»ƒç»“æœå¯æ¯”è¾ƒã€å¯å¤æŸ¥                    |
| å¯å¤ç°æ€§         | åˆ«äººè¿è¡Œä½ çš„ä»£ç æ—¶ä¹Ÿèƒ½å¾—åˆ°åŒæ ·çš„è®­ç»ƒ/æµ‹è¯•æ•°æ® |



ä½ å¯ä»¥ç†è§£ä¸ºï¼š

> `random_state` å°±åƒæ˜¯â€œæ´—ç‰Œçš„å¯†ç â€ï¼Œç›¸åŒçš„å¯†ç æ¯æ¬¡æ´—å‡ºçš„ç‰Œé¡ºåºéƒ½ä¸€æ ·ã€‚

------

### ğŸ’¡ è¡¥å……è¯´æ˜ï¼š

ä½ å¯ä»¥è®¾ç½®ä¸ºä»»æ„æ•´æ•°ï¼ˆå¦‚ 0ã€1ã€42 éƒ½å¯ä»¥ï¼‰ï¼Œåªè¦åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ç»Ÿä¸€å³å¯ã€‚ä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
random_state=42  # ä¹Ÿæ˜¯å¾ˆå¤šæ•™ç¨‹å’Œè®ºæ–‡å–œæ¬¢ç”¨çš„é»˜è®¤å€¼
```

------

### â— å¦‚æœä½ ä¸è®¾ç½® `random_state` ä¼šæ€æ ·ï¼Ÿ

```
python


å¤åˆ¶ç¼–è¾‘
train_test_split(..., test_size=0.25)
```

è¿™æ ·æ¯æ¬¡è¿è¡Œç¨‹åºï¼Œå¾—åˆ°çš„ `x_train`, `x_test` éƒ½å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ç»“æœä¸ç¨³å®šã€‚

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> è®¾ç½® `random_state=1` æ˜¯ä¸ºäº†ç¡®ä¿æ•°æ®åˆ’åˆ†å¯é‡å¤ã€ç»“æœå¯æ¯”è¾ƒï¼Œæ˜¯è‰¯å¥½çš„æœºå™¨å­¦ä¹ å®è·µä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

train_test_split(li.data, li.target, test_size=0.25, random_state=1)å‡½æ•°çš„è¿”å›å€¼é¡ºåº



###### ChatGPT è¯´ï¼š

å‡½æ•° `train_test_split(li.data, li.target, test_size=0.25, random_state=1)` çš„è¿”å›å€¼é¡ºåºæ˜¯ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¿”å›çš„æ˜¯**è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾å€¼ä¸ç›®æ ‡å€¼ï¼ŒæŒ‰ç…§ä»¥ä¸‹é¡ºåºæ’åˆ—**ï¼š

| è¿”å›å€¼    | å«ä¹‰                       |
| --------- | -------------------------- |
| `x_train` | è®­ç»ƒé›†çš„ç‰¹å¾æ•°æ®ï¼ˆç‰¹å¾å€¼ï¼‰ |
| `x_test`  | æµ‹è¯•é›†çš„ç‰¹å¾æ•°æ®           |
| `y_train` | è®­ç»ƒé›†çš„ç›®æ ‡æ•°æ®ï¼ˆæ ‡ç­¾ï¼‰   |
| `y_test`  | æµ‹è¯•é›†çš„ç›®æ ‡æ•°æ®           |



------

### âœ… ä¸¾ä¸ªä¾‹å­ï¼š

å‡è®¾ä½ å†™äº†å¦‚ä¸‹ä»£ç ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris

li = load_iris()
x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1)
```

åˆ™ï¼š

- `x_train.shape` æ˜¯ `(112, 4)`ï¼Œè®­ç»ƒé›†ä¸­æœ‰ 112 æ¡æ ·æœ¬ï¼Œæ¯æ¡æœ‰ 4 ä¸ªç‰¹å¾ï¼›
- `x_test.shape` æ˜¯ `(38, 4)`ï¼Œæµ‹è¯•é›†ä¸­æœ‰ 38 æ¡æ ·æœ¬ï¼›
- `y_train.shape` æ˜¯ `(112,)`ï¼Œç›®æ ‡æ ‡ç­¾æ˜¯ 1D æ•°ç»„ï¼›
- `y_test.shape` æ˜¯ `(38,)`ã€‚

------

### ğŸ“Œ æ³¨æ„ï¼š

`train_test_split()` æ”¯æŒä¼ å…¥å¤šä¸ªæ•°ç»„ï¼Œä¼š**æŒ‰ç›¸åŒçš„æ–¹å¼æ‹†åˆ†è¿™äº›æ•°ç»„**ï¼Œè¿”å›å€¼çš„é¡ºåºä¸ä¼ å…¥é¡ºåºä¸€è‡´ã€‚ä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x1_train, x1_test, x2_train, x2_test = train_test_split(x1, x2, test_size=0.25)
```

å°±æ˜¯åˆ†åˆ«å¯¹ `x1` å’Œ `x2` åšç›¸åŒåˆ’åˆ†ï¼Œè¿”å› `x1_train`, `x1_test`, `x2_train`, `x2_test`ã€‚

------

### âœ… æ€»ç»“ï¼š

> `train_test_split(data, target)` é»˜è®¤è¿”å›å€¼é¡ºåºæ˜¯ï¼š
>  `x_train`, `x_test`, `y_train`, `y_test`ï¼ˆ**è®­ç»ƒç‰¹å¾ã€æµ‹è¯•ç‰¹å¾ã€è®­ç»ƒæ ‡ç­¾ã€æµ‹è¯•æ ‡ç­¾**ï¼‰ã€‚
>  ä½ åº”è¯¥æŒ‰ç…§è¿™ä¸ªé¡ºåºè¿›è¡Œå˜é‡æ¥æ”¶ã€‚



##### æ‚¨è¯´ï¼š

\# ä¸‹é¢æ˜¯æ¯”è¾ƒå¤§çš„æ•°æ®ï¼Œéœ€è¦ä¸‹è½½ä¸€ä¼šï¼Œ20ç±»æ–°é—» #subsetä»£è¡¨ä¸‹è½½çš„æ•°æ®é›†ç±»å‹ï¼Œé»˜è®¤æ˜¯trainï¼Œåªæœ‰è®­ç»ƒé›† news = fetch_20newsgroups(subset='all', data_home='data') # print(news.feature_names)  #è¿™ä¸ªæ•°æ®é›†æ˜¯æ²¡æœ‰çš„ï¼Œå› ä¸ºæ²¡æœ‰ç‰¹å¾ï¼Œåªæœ‰æ–‡æœ¬æ•°æ® # print(news.DESCR) print('ç¬¬ä¸€ä¸ªæ ·æœ¬') print(news.data[0]) print('ç‰¹å¾ç±»å‹') print(type(news.data)) print('-' * 50) print(news.target[0:15]) from pprint import pprint pprint(list(news.target_names))ä¸Šé¢ä»£ç çš„ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **ä¸‹è½½å¹¶åŠ è½½ 20 ç±»æ–°é—»æ–‡æœ¬æ•°æ®é›†ï¼ˆ`20newsgroups`ï¼‰ï¼Œå¹¶æŸ¥çœ‹éƒ¨åˆ†å†…å®¹ã€ç±»å‹å’Œç›®æ ‡åˆ†ç±»ä¿¡æ¯**ã€‚

ä¸‹é¢æˆ‘æ¥é€è¡Œè§£é‡Šï¼š

------

### âœ… 1. ä¸‹è½½æ–°é—»æ•°æ®é›†

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.datasets import fetch_20newsgroups

news = fetch_20newsgroups(subset='all', data_home='data')
```

- `fetch_20newsgroups(...)` æ˜¯ sklearn æä¾›çš„å‡½æ•°ï¼Œç”¨äºä¸‹è½½**20ç±»æ–°é—»æ•°æ®é›†**ã€‚
- `subset='all'`ï¼šè¡¨ç¤ºä¸‹è½½ **å…¨éƒ¨æ•°æ®**ï¼ˆåŒ…æ‹¬è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼‰ã€‚
  - ä¹Ÿå¯ä»¥è®¾ä¸º `'train'` æˆ– `'test'`
- `data_home='data'`ï¼šæŒ‡å®šæŠŠæ•°æ®å­˜åˆ° `data/` ç›®å½•ä¸‹ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚

ğŸ“Œ **æ•°æ®ç»“æ„è¯´æ˜ï¼š**
 è¿”å›çš„æ˜¯ä¸€ä¸ª `sklearn.utils.Bunch` å¯¹è±¡ï¼Œç±»ä¼¼äºå­—å…¸ï¼Œæœ‰ä»¥ä¸‹å¸¸ç”¨å­—æ®µï¼š

| å­—æ®µå         | å«ä¹‰                           |
| -------------- | ------------------------------ |
| `data`         | æ‰€æœ‰æ–°é—»æ–‡æœ¬åˆ—è¡¨ï¼ˆå­—ç¬¦ä¸²ï¼‰     |
| `target`       | æ¯æ¡æ–°é—»å¯¹åº”çš„ç±»åˆ«ç¼–å·ï¼ˆ0~19ï¼‰ |
| `target_names` | ç±»åˆ«ç¼–å·å¯¹åº”çš„ç±»åï¼ˆå…± 20 ä¸ªï¼‰ |



------

### âœ… 2. æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ–°é—»æ ·æœ¬å†…å®¹

```
pythonå¤åˆ¶ç¼–è¾‘print('ç¬¬ä¸€ä¸ªæ ·æœ¬')
print(news.data[0])
```

- æ‰“å°å‡ºç¬¬ä¸€æ¡æ–°é—»çš„åŸå§‹æ–‡æœ¬å†…å®¹ï¼ˆçº¯æ–‡æœ¬ï¼‰ã€‚

------

### âœ… 3. æŸ¥çœ‹æ•°æ®ç±»å‹

```
pythonå¤åˆ¶ç¼–è¾‘print('ç‰¹å¾ç±»å‹')
print(type(news.data))
```

- è¾“å‡º `news.data` çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯ `list`ï¼Œå…¶ä¸­æ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå³ä¸€ç¯‡æ–‡ç« ï¼‰ã€‚

------

### âœ… 4. æ‰“å°ç›®æ ‡å€¼å‰ 15 ä¸ª

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(news.target[0:15])
```

- `news.target` æ˜¯ä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œå¯¹åº”æ¯ç¯‡æ–°é—»çš„**ç±»åˆ«ç¼–å·**ã€‚
- è¿™è¡Œä»£ç æ‰“å°å‰ 15 ç¯‡æ–‡ç« å¯¹åº”çš„ç±»åˆ«ç¼–å·ã€‚

------

### âœ… 5. æ‰“å°æ‰€æœ‰çš„ç±»åˆ«åç§°ï¼ˆå³æ–°é—»ä¸»é¢˜ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘from pprint import pprint
pprint(list(news.target_names))
```

- `news.target_names` æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰ 20 ä¸ªæ–°é—»ç±»åˆ«çš„åç§°ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚
- `pprint()` å¯ä»¥æ›´æ¸…æ™°åœ°æ‰“å°åˆ—è¡¨ï¼Œæ ¼å¼æ›´æ•´é½ã€‚

------

### ğŸ“š ç¤ºä¾‹è¾“å‡ºï¼ˆå¯èƒ½é•¿è¿™æ ·ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘ç¬¬ä¸€ä¸ªæ ·æœ¬
From: lerxst@wam.umd.edu (where's my thing)
Subject: WHAT car is this!?
...
ç‰¹å¾ç±»å‹
<class 'list'>
--------------------------------------------------
[7, 4, 4, 1, 14, 16, 3, 4, 4, 1, 4, 4, 2, 4, 5]
['alt.atheism',
 'comp.graphics',
 'comp.os.ms-windows.misc',
 'comp.sys.ibm.pc.hardware',
 ...
 'talk.religion.misc']
```

------

### âœ… æ€»ç»“ï¼š

è¿™æ®µä»£ç æ˜¯ä¸ºäº†ï¼š

1. **åŠ è½½å¹¶æŸ¥çœ‹ 20 ç±»æ–°é—»æ•°æ®é›†**ï¼›
2. **äº†è§£æ•°æ®ç»“æ„ï¼ˆæ–‡æœ¬å†…å®¹ + ç±»åˆ«ç¼–å·ï¼‰**ï¼›
3. **ä¸ºåç»­åšæ–‡æœ¬åˆ†ç±»æ‰“å¥½åŸºç¡€ï¼ˆå¦‚ TF-IDF ç‰¹å¾æå–ã€æ¨¡å‹è®­ç»ƒç­‰ï¼‰**ã€‚

è¯¥æ•°æ®é›†å¸¸ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰å®éªŒï¼Œå°¤å…¶é€‚åˆåšæ–‡æœ¬åˆ†ç±»ã€ä¸»é¢˜è¯†åˆ«ç­‰ä»»åŠ¡ã€‚



##### æ‚¨è¯´ï¼š

ä¸ºä»€ä¹ˆæ¯ç¯‡æ–°é—»è¦æœ‰ç±»åˆ«ç¼–å·



###### ChatGPT è¯´ï¼š

æ¯ç¯‡æ–°é—»éƒ½æœ‰**ç±»åˆ«ç¼–å·**ï¼Œæ˜¯å› ä¸ºï¼š

> ğŸ“Œ **æˆ‘ä»¬éœ€è¦â€œç›®æ ‡æ ‡ç­¾â€æ¥ç›‘ç£æ¨¡å‹è¿›è¡Œåˆ†ç±»å­¦ä¹ ã€‚**

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œç±»åˆ«ç¼–å·å°±æ˜¯æˆ‘ä»¬è¦è®©æ¨¡å‹å­¦ä¼šâ€œé¢„æµ‹â€çš„å¯¹è±¡ã€‚

------

### ğŸ” ç±»åˆ«ç¼–å·çš„ä½œç”¨ï¼šæ ‡ç­¾ï¼

æœºå™¨å­¦ä¹ ç‰¹åˆ«æ˜¯ç›‘ç£å­¦ä¹ ä¸­ï¼Œæ¯æ¡æ•°æ®å¿…é¡»åŒ…æ‹¬ï¼š

| æˆåˆ†      | å«ä¹‰                     | ä¸¾ä¾‹                                           |
| --------- | ------------------------ | ---------------------------------------------- |
| ç‰¹å¾ï¼ˆXï¼‰ | å¯ç”¨æ¥åˆ¤æ–­çš„ä¿¡æ¯ï¼ˆè¾“å…¥ï¼‰ | æ–°é—»å†…å®¹ï¼Œå¦‚â€œiPhone å‘å¸ƒæ–°æ¬¾â€¦â€                 |
| æ ‡ç­¾ï¼ˆyï¼‰ | æ­£ç¡®ç­”æ¡ˆï¼ˆè¾“å‡ºç›®æ ‡ï¼‰     | æ–°é—»ç±»åˆ«ç¼–å·ï¼Œä¾‹å¦‚ 3 = `comp.sys.mac.hardware` |



------

### âœ… ä¸ºä»€ä¹ˆè¦ç”¨ç¼–å·ï¼ˆæ•´æ•°ï¼‰è¡¨ç¤ºç±»åˆ«ï¼Ÿ

è™½ç„¶ç±»åˆ«æœ¬èº«æ˜¯å­—ç¬¦ä¸²ï¼ˆå¦‚ `sci.space`, `comp.graphics`ï¼‰ï¼Œä½†æˆ‘ä»¬ç”¨æ•°å­—æ¥è¡¨ç¤ºæœ‰å¾ˆå¤šä¼˜åŠ¿ï¼š

| å¥½å¤„             | è¯´æ˜                                                 |
| ---------------- | ---------------------------------------------------- |
| ğŸš€ å¿«é€Ÿå¤„ç†       | æ•°å­—æ›´é€‚åˆæ¨¡å‹å¤„ç†ï¼Œé¿å…å­—ç¬¦ä¸²å¸¦æ¥çš„é¢å¤–å¼€é”€         |
| ğŸ¤– æ¨¡å‹å…¼å®¹       | å¤§å¤šæ•°æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚ SVMã€é€»è¾‘å›å½’ï¼‰è¦æ±‚ç›®æ ‡æ˜¯æ•°å­— |
| âœ… æ˜“ç¼–ç          | æ–¹ä¾¿ç”¨ `y == 3` è¿™æ ·çš„æ–¹å¼ç­›é€‰æ•°æ®                   |
| ğŸ¯ å¯æ˜ å°„å›å­—ç¬¦ä¸² | å¯ä»¥é€šè¿‡ `target_names[y]` æŠŠç¼–å·è½¬å›ç±»åˆ«åç§°        |



------

### ğŸ§  ä¸¾ä¸ªä¾‹å­ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘æ–°é—»å†…å®¹: "NASA releases new satellite data..."
ç±»åˆ«ç¼–å·: 15
ç±»åˆ«åç§°: 'sci.space'
```

æ¨¡å‹ä¼šå­¦ä¹ ï¼šå‡¡æ˜¯å‡ºç°åƒ "NASA", "satellite", "space" è¿™æ ·çš„å…³é”®è¯ï¼Œå¤§æ¦‚ç‡ç±»åˆ«ç¼–å·å°±æ˜¯ 15ã€‚

------

### ğŸ” åˆ†ç±»ä»»åŠ¡å°±æ˜¯å­¦ä¼šï¼šæ–‡æœ¬ âœ ç±»åˆ«ç¼–å·

æ¨¡å‹è®­ç»ƒç›®æ ‡ï¼š

- è¾“å…¥ï¼šä¸€ç¯‡æ–°é—»æ–‡æœ¬ï¼ˆå­—ç¬¦ä¸²ï¼‰
- è¾“å‡ºï¼šä¸€ä¸ªæ•°å­—ï¼ˆç±»åˆ«ç¼–å·ï¼‰

æœ€ç»ˆæˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½**é¢„æµ‹å‡ºä»»æ„æ–°æ–‡ç« çš„æ­£ç¡®ç±»åˆ«ç¼–å·**ã€‚

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> ç±»åˆ«ç¼–å·æ˜¯æ¯ç¯‡æ–°é—»çš„â€œæ­£ç¡®æ ‡ç­¾â€ï¼Œæ˜¯æ–‡æœ¬åˆ†ç±»æ¨¡å‹å­¦ä¹ å’Œè¯„ä¼°çš„åŸºç¡€ã€‚
>  ç”¨æ•°å­—è€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¾¿äºæ¨¡å‹å¤„ç†ã€é«˜æ•ˆè®­ç»ƒï¼Œå¹¶å¯ä»¥è½»æ¾ä¸ç±»åˆ«åç§°ä¸€ä¸€å¯¹åº”ã€‚



##### æ‚¨è¯´ï¼š

print('-' * 50) print(len(news.data)) print('æ–°é—»æ‰€æœ‰çš„æ ‡ç­¾') print(news.target) print('-' * 50)ä»£ç ä½œç”¨  print(min(news.target), max(news.target))



###### ChatGPT è¯´ï¼š

ä¸‹é¢æˆ‘ä»¬æ¥é€è¡Œè§£é‡Šä½ è¿™æ®µä»£ç çš„ä½œç”¨ï¼Œå®ƒæ˜¯ç”¨æ¥**æŸ¥çœ‹20ç±»æ–°é—»æ•°æ®é›†ï¼ˆ`news`ï¼‰çš„åŸºæœ¬ä¿¡æ¯**çš„ï¼š

------

### ğŸ”¢ ä»£ç è§£æå¦‚ä¸‹ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- æ‰“å°ä¸€æ¡åˆ†éš”çº¿ï¼Œç”± 50 ä¸ª `-` ç»„æˆã€‚
- ä½œç”¨ï¼šè®©è¾“å‡ºç»“æœæ›´æ¸…æ™°ã€ç¾è§‚ï¼Œä¾¿äºé˜…è¯»ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(len(news.data))
```

- è¾“å‡ºï¼š**æ•°æ®é›†ä¸­æ–°é—»çš„æ€»æ•°**ã€‚
- `news.data` æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰æ–‡æœ¬æ–°é—»ã€‚
- `len(news.data)` è¡¨ç¤ºä¸€å…±æœ‰å¤šå°‘æ¡æ–°é—»æ ·æœ¬ã€‚

âœ… æ¯”å¦‚ï¼šè¾“å‡ºå¯èƒ½æ˜¯ `18846`ï¼Œè¡¨ç¤ºæ•°æ®é›†ä¸­æœ‰ **18846 æ¡æ–°é—»æ–‡ç« **ã€‚

------

```
pythonå¤åˆ¶ç¼–è¾‘print('æ–°é—»æ‰€æœ‰çš„æ ‡ç­¾')
print(news.target)
```

- `news.target` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ**æ¯ä¸€æ¡æ–°é—»å¯¹åº”ä¸€ä¸ªæ•°å­—æ ‡ç­¾ï¼ˆç±»åˆ«ç¼–å·ï¼‰**ã€‚
- æ‰“å°å‡ºæ¥çš„ç»“æœç±»ä¼¼è¿™æ ·ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
[10  3 17 ... 3  1  5]
```

è¿™è¯´æ˜ï¼š

- ç¬¬ 1 æ¡æ–°é—»æ˜¯ç¬¬ 10 ç±»
- ç¬¬ 2 æ¡æ˜¯ç¬¬ 3 ç±»
- ç¬¬ 3 æ¡æ˜¯ç¬¬ 17 ç±»ï¼Œâ€¦â€¦
- ä¸€å…±æœ‰ 20 ç±»ï¼Œç¼–å·ä» 0 åˆ° 19

------

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- åˆæ˜¯ä¸€æ¡åˆ†éš”çº¿ï¼Œç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(min(news.target), max(news.target))
```

- è¾“å‡ºï¼š`news.target` ä¸­çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ï¼š
  - æ‰€æœ‰ç±»åˆ«ç¼–å·ä¸­**æœ€å°çš„ç¼–å·**
  - æ‰€æœ‰ç±»åˆ«ç¼–å·ä¸­**æœ€å¤§çš„ç¼–å·**

âœ… åœ¨ 20 ç±»æ–°é—»ä¸­ï¼Œè¾“å‡ºé€šå¸¸æ˜¯ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
0 19
```

è¡¨ç¤ºï¼š

- ç±»åˆ«ç¼–å·ä» 0 å¼€å§‹
- åˆ° 19 ç»“æŸï¼Œä¸€å…± **20 ç±»æ–°é—»**

------

### ğŸ“¦ æ€»ç»“ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **æŸ¥çœ‹æ•°æ®é›†ä¸­æ–°é—»æ•°é‡ã€æ¯æ¡æ–°é—»çš„æ ‡ç­¾ã€ä»¥åŠæ ‡ç­¾ç¼–å·çš„èŒƒå›´ã€‚**

| ä»£ç                                  | ä½œç”¨è¯´æ˜                 |
| ------------------------------------ | ------------------------ |
| `len(news.data)`                     | è¾“å‡ºæ–°é—»æ¡æ•°             |
| `news.target`                        | æ‰€æœ‰æ–°é—»çš„æ ‡ç­¾ç¼–å·       |
| `min(news.target), max(news.target)` | æ ‡ç­¾ç¼–å·çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ |



è¿™äº›ä¿¡æ¯å¯¹äº†è§£æ•°æ®ç»“æ„éå¸¸é‡è¦ï¼Œæ˜¯**æ–‡æœ¬åˆ†ç±»ä»»åŠ¡çš„ç¬¬ä¸€æ­¥ï¼šæ•°æ®ç†è§£ä¸æ£€æŸ¥**ã€‚



##### æ‚¨è¯´ï¼š

house=fetch_california_housing(data_home='data') print("è·å–ç‰¹å¾å€¼") print(house.data[0])  #ç¬¬ä¸€ä¸ªæ ·æœ¬ç‰¹å¾å€¼ print('æ ·æœ¬çš„å½¢çŠ¶') print(house.data.shape)ä»£ç ä½œç”¨  print('-' * 50)



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç æ˜¯ç”¨æ¥**åŠ è½½åŠ å·æˆ¿ä»·æ•°æ®é›†ï¼ˆCalifornia Housingï¼‰å¹¶æŸ¥çœ‹éƒ¨åˆ†ç‰¹å¾ä¿¡æ¯**çš„ã€‚ä¸‹é¢é€è¡Œè§£é‡Šå…¶å…·ä½“ä½œç”¨ï¼š

------

### ğŸ” 1. åŠ è½½æ•°æ®é›†

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.datasets import fetch_california_housing

house = fetch_california_housing(data_home='data')
```

- `fetch_california_housing()`ï¼šä» sklearn ä¸‹è½½ **åŠ å·æˆ¿ä»·æ•°æ®é›†**ã€‚
- `data_home='data'`ï¼šæŠŠæ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„ `data/` ç›®å½•ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚
- è¿”å›å€¼ `house` æ˜¯ä¸€ä¸ª `Bunch` å¯¹è±¡ï¼Œç±»ä¼¼äºå­—å…¸ï¼ŒåŒ…å«å¦‚ä¸‹å†…å®¹ï¼š

| å­—æ®µ            | å«ä¹‰                                   |
| --------------- | -------------------------------------- |
| `data`          | æ ·æœ¬çš„ç‰¹å¾ï¼ˆäºŒç»´æ•°ç»„ï¼‰                 |
| `target`        | æ¯ä¸ªæ ·æœ¬çš„æˆ¿ä»·ï¼ˆç›®æ ‡å€¼ï¼Œå•ä½æ˜¯åƒç¾å…ƒï¼‰ |
| `feature_names` | æ¯ä¸ªç‰¹å¾çš„åç§°ï¼ˆå¦‚æ”¶å…¥ã€æˆ¿é—´æ•°ç­‰ï¼‰     |
| `DESCR`         | æ•°æ®é›†çš„æè¿°æ–‡æœ¬                       |



------

### ğŸ” 2. æ‰“å°ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼

```
pythonå¤åˆ¶ç¼–è¾‘print("è·å–ç‰¹å¾å€¼")
print(house.data[0])  # ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼
```

- è¾“å‡ºåŠ å·æˆ¿ä»·æ•°æ®é›†ä¸­ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ 8 ä¸ªç‰¹å¾å€¼ï¼Œä¾‹å¦‚ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
[8.3252e+00 4.1000e+01 6.9841e+00 1.0238e+00 3.2200e+02 2.5556e+00 3.7880e+01 9.4300e+00]
```

è¿™äº›ç‰¹å¾åŒ…æ‹¬ï¼š

1. äººå‡æ”¶å…¥
2. æˆ¿å±‹å¹´é¾„ä¸­ä½æ•°
3. å¹³å‡æˆ¿é—´æ•°
4. å¹³å‡å§å®¤æ•°
5. å±…æ°‘æ•°é‡
6. å¹³å‡å®¶åº­äººæ•°
7. ç»åº¦
8. çº¬åº¦

------

### ğŸ” 3. æ‰“å°æ•°æ®çš„å½¢çŠ¶

```
pythonå¤åˆ¶ç¼–è¾‘print('æ ·æœ¬çš„å½¢çŠ¶')
print(house.data.shape)
```

- æ‰“å°çš„æ˜¯ `data` çš„å½¢çŠ¶ï¼Œé€šå¸¸æ˜¯ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
(20640, 8)
```

æ„æ€æ˜¯ï¼šæ•°æ®é›†ä¸­ä¸€å…±æœ‰ **20640 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ 8 ä¸ªç‰¹å¾**ã€‚

------

### ğŸ” 4. åˆ†å‰²çº¿ï¼ˆç¾åŒ–è¾“å‡ºï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- æ‰“å°å‡ºä¸€æ¡ç”± 50 ä¸ª `-` ç»„æˆçš„åˆ†éš”çº¿ï¼Œç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ï¼Œæå‡å¯è¯»æ€§ã€‚

------

### âœ… æ€»ç»“

| ä»£ç                          | ä½œç”¨                                    |
| ---------------------------- | --------------------------------------- |
| `fetch_california_housing()` | ä¸‹è½½å¹¶åŠ è½½åŠ å·æˆ¿ä»·æ•°æ®                  |
| `house.data[0]`              | æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼                  |
| `house.data.shape`           | æŸ¥çœ‹æ‰€æœ‰æ•°æ®çš„è¡Œåˆ—æ•°ï¼ˆæ ·æœ¬æ•° Ã— ç‰¹å¾æ•°ï¼‰ |
| `print('-'*50)`              | è¾“å‡ºåˆ†éš”çº¿                              |



------

è¿™ä¸ªæ•°æ®é›†å¸¸ç”¨äº**å›å½’æ¨¡å‹è®­ç»ƒ**ï¼Œç›®æ ‡æ˜¯é¢„æµ‹æ¯ä¸ªåŒºåŸŸçš„å¹³å‡æˆ¿ä»·ã€‚



##### æ‚¨è¯´ï¼š

print("ç›®æ ‡å€¼") print(house.target) print('-' * 50) print(house.DESCR) print('-' * 50) print(house.feature_names) print('-' * 50)ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š**æŸ¥çœ‹ California Housingï¼ˆåŠ å·æˆ¿ä»·ï¼‰æ•°æ®é›†ä¸­çš„ç›®æ ‡å€¼ã€æ•°æ®æè¿°ã€ç‰¹å¾åç§°**ã€‚ä¸‹é¢æ˜¯é€è¡Œè®²è§£ï¼š

------

### 1ï¸âƒ£ æŸ¥çœ‹ç›®æ ‡å€¼ï¼ˆæˆ¿ä»·ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘print("ç›®æ ‡å€¼")
print(house.target)
```

- `house.target` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ¯æ¡æ ·æœ¬çš„**æˆ¿ä»·ä¸­ä½æ•°**ï¼ˆå•ä½æ˜¯ï¼šåƒç¾å…ƒï¼‰ã€‚

- ç¤ºä¾‹è¾“å‡ºï¼ˆå‰å‡ é¡¹ï¼‰ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  [4.526 3.585 3.521 ... 0.923 0.847 0.894]
  ```

- è¯´æ˜ï¼š

  - ç¬¬ 1 ä¸ªæ ·æœ¬çš„æˆ¿ä»·ä¸º $4.526 ä¸‡ç¾å…ƒ
  - ç¬¬ 2 ä¸ªæ ·æœ¬çš„æˆ¿ä»·ä¸º $3.585 ä¸‡ç¾å…ƒ
  - â€¦â€¦

âœ… è¿™æ˜¯è®­ç»ƒå›å½’æ¨¡å‹çš„ç›®æ ‡ï¼ˆy å€¼ï¼‰ã€‚

------

### 2ï¸âƒ£ æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- ç¾åŒ–è¾“å‡ºï¼Œè®©å†…å®¹ç»“æ„æ›´æ¸…æ™°ã€‚

------

### 3ï¸âƒ£ æŸ¥çœ‹æ•°æ®é›†çš„æ•´ä½“æè¿°

```
python


å¤åˆ¶ç¼–è¾‘
print(house.DESCR)
```

- `house.DESCR` æ˜¯å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ•´ä¸ªæ•°æ®é›†çš„è¯¦ç»†ä»‹ç»ï¼ŒåŒ…æ‹¬ï¼š
  - æ•°æ®æ¥æº
  - ç‰¹å¾è§£é‡Š
  - ç»Ÿè®¡ä¿¡æ¯
  - ä½¿ç”¨å»ºè®®

ğŸ“ ç¤ºä¾‹å†…å®¹ç‰‡æ®µï¼ˆå¯èƒ½å¾ˆé•¿ï¼‰ï¼š

```
mathematicaå¤åˆ¶ç¼–è¾‘.. _california_housing_dataset:

California Housing dataset
---------------------------

**Data Set Characteristics:**

    :Number of Instances: 20640
    :Number of Attributes: 8 numeric, predictive attributes and the target
    ...
```

âœ… è¿™ä¸ªå­—æ®µéå¸¸æœ‰ç”¨ï¼Œå¯ä»¥å¿«é€Ÿäº†è§£æ•°æ®èƒŒæ™¯å’Œç”¨é€”ã€‚

------

### 4ï¸âƒ£ å†æ¬¡æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

------

### 5ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰ç‰¹å¾åç§°

```
python


å¤åˆ¶ç¼–è¾‘
print(house.feature_names)
```

- è¾“å‡ºçš„æ˜¯åˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰ç‰¹å¾çš„åå­—ï¼ˆæ€»å…± 8 ä¸ªï¼‰ï¼Œä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
['MedInc', 'HouseAge', 'AveRooms', 'AveBedrms', 'Population', 'AveOccup', 'Latitude', 'Longitude']
```

ğŸ“Œ è§£é‡Šå¦‚ä¸‹ï¼š

| ç‰¹å¾å       | å«ä¹‰                     |
| ------------ | ------------------------ |
| `MedInc`     | åŒºåŸŸä½æˆ·çš„**æ”¶å…¥ä¸­ä½æ•°** |
| `HouseAge`   | æˆ¿å±‹çš„**å¹´é¾„ä¸­ä½æ•°**     |
| `AveRooms`   | æ¯æˆ·çš„**å¹³å‡æˆ¿é—´æ•°**     |
| `AveBedrms`  | æ¯æˆ·çš„**å¹³å‡å§å®¤æ•°**     |
| `Population` | åŒºåŸŸå†…**äººå£æ•°é‡**       |
| `AveOccup`   | å¹³å‡æ¯ä¸ªå®¶åº­çš„äººå£æ•°     |
| `Latitude`   | åŒºåŸŸçš„**çº¬åº¦**           |
| `Longitude`  | åŒºåŸŸçš„**ç»åº¦**           |



------

### âœ… æ€»ç»“åŠŸèƒ½è¡¨ï¼š

| ä»£ç                   | åŠŸèƒ½è¯´æ˜                   |
| --------------------- | -------------------------- |
| `house.target`        | æŸ¥çœ‹æ‰€æœ‰æ ·æœ¬å¯¹åº”çš„æˆ¿ä»·æ ‡ç­¾ |
| `house.DESCR`         | æŸ¥çœ‹æ•°æ®é›†è¯¦ç»†ä»‹ç»         |
| `house.feature_names` | æŸ¥çœ‹ 8 ä¸ªç‰¹å¾çš„åç§°åˆ—è¡¨    |
| `print('-'*50)`       | ç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ï¼Œä¾¿äºé˜…è¯» |



------

è¿™äº›ä»£ç å¸¸ç”¨äº **æ•°æ®åŠ è½½ä¸ç†è§£é˜¶æ®µ**ï¼Œå¸®åŠ©ä½ æŒæ¡æ¨¡å‹è®­ç»ƒæ‰€ä¾èµ–çš„æ•°æ®ç»“æ„å’Œå«ä¹‰ã€‚



##### æ‚¨è¯´ï¼š

\# Kè¿‘é‚» """ K-è¿‘é‚»é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½® :return:None """ # è¯»å–æ•°æ® data = pd.read_csv("./data/FBlocation/train.csv") print(data.head(10)) print(data.shape) print(data.info()) # å¤„ç†æ•°æ® # 1ã€ç¼©å°æ•°æ®,æŸ¥è¯¢æ•°æ®,ä¸ºäº†å‡å°‘è®¡ç®—æ—¶é—´ data = data.query("x > 1.0 &  x < 1.25 & y > 2.5 & y < 2.75")ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨ **Kè¿‘é‚»ç®—æ³•ï¼ˆKNNï¼‰é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½®**ï¼Œå¹¶åœ¨å¼€å§‹é˜¶æ®µå¯¹åŸå§‹æ•°æ®è¿›è¡Œè¯»å–å’Œç­›é€‰å¤„ç†ã€‚ä¸‹é¢æˆ‘é€è¡Œè§£é‡Šä»£ç çš„ä½œç”¨ï¼š

------

### ğŸ” ä¸€ã€Kè¿‘é‚»é¢„æµ‹ç­¾åˆ°ä½ç½®

```
pythonå¤åˆ¶ç¼–è¾‘"""
K-è¿‘é‚»é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½®
:return: None
"""
```

è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¯´æ˜æ•´ä¸ªä»£ç åŠŸèƒ½ï¼š

- åˆ©ç”¨ **K-è¿‘é‚»ç®—æ³•** å¯¹ **ç”¨æˆ·åœ¨æŸä¸ªä½ç½®ç­¾åˆ°çš„ä½ç½®ç‚¹** è¿›è¡Œé¢„æµ‹åˆ†ç±»ã€‚

------

### ğŸ“¥ äºŒã€è¯»å–åŸå§‹æ•°æ®

```
pythonå¤åˆ¶ç¼–è¾‘# è¯»å–æ•°æ®
data = pd.read_csv("./data/FBlocation/train.csv")
```

- ä½¿ç”¨ Pandas è¯»å–æœ¬åœ°è·¯å¾„ä¸‹çš„ `train.csv` æ•°æ®æ–‡ä»¶ï¼Œå­˜å…¥å˜é‡ `data`ã€‚
- æ•°æ®æ¥æºæ˜¯ Facebook Check-in çš„ä½ç½®ç­¾åˆ°æ•°æ®é›†ï¼ŒåŒ…å«ç”¨æˆ·åæ ‡å’Œç­¾åˆ°ä½ç½®ç­‰ä¿¡æ¯ã€‚

------

### ğŸ‘€ ä¸‰ã€æŸ¥çœ‹åŸºæœ¬ä¿¡æ¯

```
python


å¤åˆ¶ç¼–è¾‘
print(data.head(10))
```

- æ‰“å°å‰ 10 æ¡æ•°æ®ï¼ŒæŸ¥çœ‹åŸå§‹æ•°æ®æ ¼å¼ä¸å†…å®¹ã€‚

```
python


å¤åˆ¶ç¼–è¾‘
print(data.shape)
```

- è¾“å‡ºæ•°æ®çš„å½¢çŠ¶ï¼Œå¦‚ `(291180, 10)` è¡¨ç¤ºæœ‰ 291180 æ¡è®°å½•ï¼Œ10 ä¸ªå­—æ®µã€‚

```
python


å¤åˆ¶ç¼–è¾‘
print(data.info())
```

- æ‰“å°æ¯ä¸€åˆ—çš„ç±»å‹ã€æ˜¯å¦æœ‰ç¼ºå¤±å€¼ï¼Œç”¨äº**æ•°æ®åˆæ­¥äº†è§£å’Œæ¸…æ´—å‡†å¤‡**ã€‚

------

### ğŸ§¹ å››ã€æ•°æ®é¢„å¤„ç† - ç­›é€‰ä¸€ä¸ªå°åŒºåŸŸ

```
pythonå¤åˆ¶ç¼–è¾‘# 1ã€ç¼©å°æ•°æ®,æŸ¥è¯¢æ•°æ®,ä¸ºäº†å‡å°‘è®¡ç®—æ—¶é—´
data = data.query("x > 1.0 & x < 1.25 & y > 2.5 & y < 2.75")
```

- ä½¿ç”¨ Pandas çš„ `.query()` æ–¹æ³•ç­›é€‰å‡ºåœ°ç†ä½ç½®åœ¨æŒ‡å®šèŒƒå›´å†…çš„æ•°æ®ï¼š
  - `x` è¡¨ç¤ºæ¨ªåæ ‡ï¼ˆç»åº¦ç±»ä¼¼ï¼‰ï¼Œå–å€¼åœ¨ 1.0 åˆ° 1.25 ä¹‹é—´ï¼›
  - `y` è¡¨ç¤ºçºµåæ ‡ï¼ˆçº¬åº¦ç±»ä¼¼ï¼‰ï¼Œå–å€¼åœ¨ 2.5 åˆ° 2.75 ä¹‹é—´ã€‚
- åŸå› ï¼šè¯¥æ•°æ®é›†æœ¬èº«æ•°æ®é‡å¾ˆå¤§ï¼Œä¸ºäº†å‡å°‘åç»­è®­ç»ƒæ—¶é—´ï¼Œæˆ‘ä»¬**åªå–ä¸€ä¸ªå°èŒƒå›´çš„ç”¨æˆ·ä½ç½®åŒºåŸŸ**æ¥åšå®éªŒã€‚

ğŸ“Œ ç­›é€‰åçš„æ•°æ®å°±æ˜¯åªåŒ…å«é‚£ä¸€å°å—åŒºåŸŸä¸­çš„ç”¨æˆ·ç­¾åˆ°ç‚¹ï¼Œç”¨äºæœ¬åœ°èŒƒå›´å†…çš„åˆ†ç±»é¢„æµ‹ã€‚

------

### âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤       | ç›®çš„                             |
| ---------- | -------------------------------- |
| è¯»å–æ•°æ®é›† | åŠ è½½åŸå§‹ç­¾åˆ°æ•°æ®                 |
| æ‰“å°ä¿¡æ¯   | æŸ¥çœ‹æ•°æ®è§„æ¨¡ä¸ç»“æ„               |
| ç­›é€‰åæ ‡   | ä»…é€‰å–éƒ¨åˆ†åŒºåŸŸç”¨äºå®éªŒï¼Œæå‡æ•ˆç‡ |
| åç»­ç›®æ ‡   | ä½¿ç”¨ KNN æ¨¡å‹é¢„æµ‹ç­¾åˆ°ä½ç½®åˆ†ç±»    |



------

å¦‚æœä½ ç»§ç»­å¾€ä¸‹å†™ï¼Œä¼šä½¿ç”¨ `KNeighborsClassifier` å»ºæ¨¡ï¼Œç”¨ `x`, `y`, `accuracy`, `time` ç­‰ç‰¹å¾å»é¢„æµ‹ `place_id`ï¼ˆå³ç”¨æˆ·ç­¾åˆ°çš„çœŸå®ä½ç½®ï¼‰ã€‚éœ€è¦æ ‡å‡†åŒ–ã€åˆ’åˆ†è®­ç»ƒé›†ã€æ„å»ºæ¨¡å‹ç­‰åç»­æ­¥éª¤ã€‚éœ€è¦æˆ‘ç»§ç»­å¸®ä½ å†™åç»­ KNN æ¨¡å‹æµç¨‹å—ï¼Ÿ



##### æ‚¨è¯´ï¼š

è§£é‡Šä¸€ä¸‹ï¼š<class 'pandas.core.frame.DataFrame'> RangeIndex: 29118021 entries, 0 to 29118020 Data columns (total 6 columns): #   Column    Dtype   ---  ------    -----   0   row_id    int64   1   x         float64 2   y         float64 3   accuracy  int64   4   time      int64   5   place_id  int64   dtypes: float64(2), int64(4) memory usage: 1.3 GB None



###### ChatGPT è¯´ï¼š

ä½ æä¾›çš„æ˜¯ Pandas ä¸­ `DataFrame.info()` çš„è¾“å‡ºç»“æœï¼Œä¸‹é¢æ˜¯å¯¹å®ƒæ¯ä¸€éƒ¨åˆ†çš„è¯¦ç»†è§£é‡Šï¼š

------

### âœ… è¿™æ˜¯ DataFrame çš„åŸºæœ¬ä¿¡æ¯ï¼š

```
javascript


å¤åˆ¶ç¼–è¾‘
<class 'pandas.core.frame.DataFrame'>
```

ğŸ“Œ è¡¨ç¤ºï¼š`data` æ˜¯ä¸€ä¸ª Pandas çš„ **DataFrame** å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªäºŒç»´çš„è¡¨æ ¼ç»“æ„ï¼Œç±»ä¼¼ Excel è¡¨æ ¼æˆ– SQL è¡¨ã€‚

------

### âœ… è¡Œç´¢å¼•ä¿¡æ¯ï¼š

```
pgsql


å¤åˆ¶ç¼–è¾‘
RangeIndex: 29118021 entries, 0 to 29118020
```

- ä¸€å…±æœ‰ **29,118,021 æ¡æ•°æ®**ï¼ˆè¡Œï¼‰ï¼Œç¼–å·ä» 0 åˆ° 29118020ã€‚
- ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ `RangeIndex`ï¼Œå³æ•´æ•°é€’å¢çš„è¡Œç´¢å¼•ã€‚

------

### âœ… åˆ—ä¿¡æ¯ï¼ˆå­—æ®µ + æ•°æ®ç±»å‹ï¼‰ï¼š

```
goå¤åˆ¶ç¼–è¾‘Data columns (total 6 columns):
 #   Column    Dtype  
---  ------    -----  
 0   row_id    int64  
 1   x         float64
 2   y         float64
 3   accuracy  int64  
 4   time      int64  
 5   place_id  int64  
```

| åˆ—å· | åˆ—å       | ç±»å‹      | å«ä¹‰è¯´æ˜                               |
| ---- | ---------- | --------- | -------------------------------------- |
| 0    | `row_id`   | `int64`   | è¡Œç¼–å·æˆ–æ ·æœ¬ç¼–å·ï¼ˆå”¯ä¸€ IDï¼‰            |
| 1    | `x`        | `float64` | æ¨ªåæ ‡ï¼ˆåœ°ç†åæ ‡ä¸­çš„ xï¼Œå•ä½ç±»ä¼¼ç»åº¦ï¼‰ |
| 2    | `y`        | `float64` | çºµåæ ‡ï¼ˆåœ°ç†åæ ‡ä¸­çš„ yï¼Œå•ä½ç±»ä¼¼çº¬åº¦ï¼‰ |
| 3    | `accuracy` | `int64`   | GPS ç²¾åº¦ï¼ˆæ•°å€¼è¶Šå¤§ï¼Œå¯èƒ½è¶Šä¸ç²¾ç¡®ï¼‰     |
| 4    | `time`     | `int64`   | æ—¶é—´æˆ³ï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰                   |
| 5    | `place_id` | `int64`   | ç­¾åˆ°ä½ç½®ç¼–å·ï¼ˆé¢„æµ‹ç›®æ ‡æ ‡ç­¾ï¼‰           |



------

### âœ… æ¯ç§æ•°æ®ç±»å‹ç»Ÿè®¡ï¼š

```
css


å¤åˆ¶ç¼–è¾‘
dtypes: float64(2), int64(4)
```

- è¡¨ç¤ºä¸€å…± 6 åˆ—ä¸­ï¼š
  - æœ‰ **2 åˆ—** æ˜¯ `float64` ç±»å‹ï¼ˆå³å°æ•°ï¼Œç²¾åº¦é«˜ï¼‰ï¼›
  - æœ‰ **4 åˆ—** æ˜¯ `int64` ç±»å‹ï¼ˆæ•´æ•°ï¼‰ã€‚

------

### âœ… å†…å­˜ä½¿ç”¨æƒ…å†µï¼š

```
wasm


å¤åˆ¶ç¼–è¾‘
memory usage: 1.3 GB
```

- æ•´ä¸ª DataFrame å ç”¨äº†çº¦ **1.3GB å†…å­˜**ã€‚
- æ•°æ®é‡éå¸¸å¤§ï¼Œå»ºè®®åœ¨è®­ç»ƒå‰åšæ•°æ®ç­›é€‰æˆ–é™ç»´ï¼Œå¦åˆ™å®¹æ˜“å ç”¨å¤ªå¤šå†…å­˜ã€‚

------

### âœ… `None` æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™æ˜¯ `print(data.info())` çš„è¿”å›å€¼ï¼š

- `data.info()` æœ¬èº«æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼ˆè¿”å›çš„æ˜¯ `None`ï¼‰ï¼Œåªæ˜¯åœ¨è°ƒç”¨æ—¶è‡ªåŠ¨æ‰“å°ä¿¡æ¯ã€‚
- å¦‚æœä½ å†™ `print(data.info())`ï¼Œæœ€åå°±ä¼šæ˜¾ç¤º `None`ã€‚

------

### ğŸ“Œ æ€»ç»“ï¼š

è¿™æ®µè¾“å‡ºå‘Šè¯‰æˆ‘ä»¬ï¼š

| é¡¹ç›®                      | å†…å®¹è¯´æ˜                         |
| ------------------------- | -------------------------------- |
| æ•°æ®æ€»é‡                  | 29118021 è¡Œï¼Œ6 åˆ—                |
| åˆ—åä¸ç±»å‹                | åŒ…å«åæ ‡ã€æ—¶é—´ã€ç²¾åº¦ã€ä½ç½® ID ç­‰ |
| å†…å­˜å ç”¨                  | çº¦ 1.3GB                         |
| ç›®æ ‡å˜é‡                  | `place_id`ï¼Œè¡¨ç¤ºç”¨æˆ·ç­¾åˆ°çš„ä½ç½®   |
| `print(data.info())` è¿”å› | `None`ï¼Œä»…è´Ÿè´£æ‰“å°ç»“æ„ä¿¡æ¯       |



------

å¦‚ä½ ç»§ç»­åç»­åˆ†æï¼ˆå¦‚ç”¨ KNN åˆ†ç±» `place_id`ï¼‰ï¼Œå»ºè®®å¯¹ `x` å’Œ `y` åšåŒºåŸŸç­›é€‰ï¼Œæˆ–å¯¹ç‰¹å¾è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä»¥å‡å°‘è®¡ç®—å‹åŠ›ã€‚éœ€è¦æˆ‘å¸®ä½ å†™åç»­æ¨¡å‹æ­¥éª¤ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

data.shape data.describe()ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™ä¸¤è¡Œä»£ç ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data.shape
data.describe()
```

æ˜¯ç”¨äº **äº†è§£æ•°æ®è§„æ¨¡å’Œç»Ÿè®¡ç‰¹å¾** çš„ï¼Œä¸‹é¢é€ä¸€è§£é‡Šï¼š

------

### âœ… `data.shape`

ä½œç”¨ï¼šæŸ¥çœ‹ **æ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°ï¼ˆç»´åº¦ï¼‰**

ğŸ“Œ ç¤ºä¾‹è¾“å‡ºï¼š

```
python


å¤åˆ¶ç¼–è¾‘
(29118021, 6)
```

è¡¨ç¤ºï¼š

- æ•°æ®æœ‰ **29,118,021 è¡Œ**ï¼ˆå³ 2910 ä¸‡æ¡æ ·æœ¬ï¼‰
- æœ‰ **6 åˆ—**ï¼ˆç‰¹å¾å­—æ®µï¼‰

ğŸ’¡ ç­‰ä»·äºï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print("æ•°æ®ç»´åº¦ï¼š", data.shape)
```

------

### âœ… `data.describe()`

ä½œç”¨ï¼šæŸ¥çœ‹æ•°å€¼åˆ—çš„ **æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯**ï¼Œå¸®åŠ©ä½ å¿«é€Ÿäº†è§£æ¯ä¸ªå­—æ®µçš„å–å€¼åˆ†å¸ƒã€‚

ğŸ“Œ ç¤ºä¾‹è¾“å‡ºï¼ˆç®€ç•¥ï¼‰ï¼š

|       | row_id   | x        | y        | accuracy | time     | place_id |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- |
| count | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 |
| mean  | 1.46e+07 | 5.99     | 5.99     | 65.6     | 4.01e+06 | 8.77e+09 |
| std   | ...      | ...      | ...      | ...      | ...      | ...      |
| min   | 0        | 0.0      | 0.0      | 1        | 0        | 1        |
| 25%   | ...      | ...      | ...      | ...      | ...      | ...      |
| 50%   | ...      | ...      | ...      | ...      | ...      | ...      |
| 75%   | ...      | ...      | ...      | ...      | ...      | ...      |
| max   | 2.91e+07 | 10.0     | 10.0     | 1000+    | 7.86e+06 | 9.84e+09 |



è¿™äº›ç»Ÿè®¡é‡åˆ†åˆ«è¡¨ç¤ºï¼š

| æŒ‡æ ‡        | å«ä¹‰                           |
| ----------- | ------------------------------ |
| count       | éç©ºå€¼æ•°é‡ï¼ˆè¡Œæ•°ï¼‰             |
| mean        | å¹³å‡å€¼                         |
| std         | æ ‡å‡†å·®ï¼ˆè¡¡é‡æ³¢åŠ¨èŒƒå›´ï¼‰         |
| min/max     | æœ€å°å€¼ / æœ€å¤§å€¼                |
| 25%/50%/75% | åˆ†ä½æ•°ï¼ˆä¸­ä½æ•°ã€ä¸Šä¸‹å››åˆ†ä½ç‚¹ï¼‰ |



------

### âœ… æ€»ç»“å¯¹æ¯”ï¼š

| ä»£ç               | ä½œç”¨                         |
| ----------------- | ---------------------------- |
| `data.shape`      | æŸ¥çœ‹æ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°ï¼ˆç»´åº¦ï¼‰ |
| `data.describe()` | å¿«é€ŸæŸ¥çœ‹æ¯åˆ—æ•°å€¼çš„ç»Ÿè®¡åˆ†å¸ƒ   |



è¿™äº›æ˜¯æ•°æ®åˆ†æå’Œå»ºæ¨¡å‰çš„å¸¸è§„â€œæ•°æ®æ¢ç´¢â€æ­¥éª¤ï¼Œç”¨äºï¼š

- æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼‚å¸¸å€¼æˆ–æç«¯å€¼
- äº†è§£æ•°æ®å¤§è‡´åˆ†å¸ƒ
- ä¸ºæ¸…æ´—ã€å½’ä¸€åŒ–ç­‰é¢„å¤„ç†åšå¥½å‡†å¤‡

å¦‚æœä½ éœ€è¦æˆ‘å¸®ä½ åŸºäºè¿™äº›ä¿¡æ¯è¿›ä¸€æ­¥å»ºæ¨¡æˆ–å¯è§†åŒ–åˆ†æï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

ä»£ç ä½œç”¨# å¤„ç†æ—¶é—´çš„æ•°æ® time_value = pd.to_datetime(data['time'], unit='s') print(time_value.head(10))  #æœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

------

### åŠŸèƒ½è¯´æ˜ï¼š

**å°†æ•°æ®ä¸­çš„æ—¶é—´æˆ³ï¼ˆæ•´æ•°ï¼‰è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„æ—¥æœŸæ—¶é—´æ ¼å¼ï¼Œæ–¹ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚**

------

### é€è¡Œè§£é‡Šï¼š

```
python


å¤åˆ¶ç¼–è¾‘
time_value = pd.to_datetime(data['time'], unit='s')
```

- `data['time']` æ˜¯åŸå§‹æ•°æ®ä¸­è¡¨ç¤ºæ—¶é—´çš„åˆ—ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ•´æ•°æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯**ç§’**ï¼ˆä»æŸä¸ªèµ·å§‹æ—¶é—´ç®—èµ·ï¼‰ã€‚
- `pd.to_datetime(..., unit='s')`ï¼š
  - Pandas å‡½æ•°ï¼Œå°†æ•´æ•°æ—¶é—´æˆ³è½¬æ¢æˆ **æ—¶é—´æ—¥æœŸæ ¼å¼ï¼ˆdatetimeï¼‰**ã€‚
  - `unit='s'` è¡¨ç¤ºæ—¶é—´æˆ³å•ä½æ˜¯ç§’ï¼ˆä¹Ÿå¯ä»¥æ˜¯æ¯«ç§’`'ms'`ç­‰ï¼‰ã€‚
- ç»“æœ `time_value` æ˜¯ä¸€ä¸ª `DatetimeIndex` æˆ– `Series`ï¼Œæ¯æ¡è®°å½•å¯¹åº”ä¸€ä¸ªå…·ä½“çš„æ—¥æœŸå’Œæ—¶é—´ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(time_value.head(10))  # æœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·
```

- æ‰“å°å‰ 10 æ¡è½¬æ¢åçš„æ—¥æœŸæ—¶é—´ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ—¶é—´ä¿¡æ¯ã€‚
- æ³¨é‡Šä¸­æåˆ°â€œæœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·â€ï¼Œæ„å‘³ç€æ•°æ®æ—¶é—´èŒƒå›´çº¦åœ¨ 1 æœˆ 1 æ—¥åˆ° 1 æœˆ 10 æ—¥ä¹‹é—´ã€‚

------

### ä¸¾ä¾‹ï¼š

å‡è®¾ `data['time']` æ˜¯ç±»ä¼¼ `3600`ã€`7200` è¿™æ ·çš„æ•´æ•°ï¼ˆç§’æ•°ï¼‰ï¼Œè½¬æ¢åå°±æ˜¯ï¼š

```
python-replå¤åˆ¶ç¼–è¾‘2025-01-01 01:00:00
2025-01-01 02:00:00
...
```

------

### æ€»ç»“ï¼š

è¿™æ®µä»£ç æŠŠ**åŸå§‹çš„ç§’çº§æ—¶é—´æˆ³**è½¬æˆäº†**äººç±»å¯è¯»çš„æ—¥æœŸæ—¶é—´æ ¼å¼**ï¼Œæ–¹ä¾¿åšæ—¶é—´åºåˆ—åˆ†æã€æ—¶é—´ç‰¹å¾æå–ï¼ˆå¦‚æå–å°æ—¶ã€æ˜ŸæœŸå‡ ç­‰ï¼‰ã€‚



3/3





##### æ‚¨è¯´ï¼š

\# æŠŠæ—¥æœŸæ ¼å¼è½¬æ¢æˆ å­—å…¸æ ¼å¼ï¼ŒæŠŠå¹´ï¼Œæœˆï¼Œæ—¥ï¼Œæ—¶ï¼Œåˆ†ï¼Œç§’è½¬æ¢ä¸ºå­—å…¸æ ¼å¼ï¼Œ time_value = pd.DatetimeIndex(time_value) # print('-' * 50) print(time_value[0:10])ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **å°†æ—¶é—´åˆ—ï¼ˆæ—¶é—´æˆ³è½¬ä¸ºçš„ datetime æ ¼å¼ï¼‰è½¬æ¢ä¸ºä¸€ä¸ªç»“æ„åŒ–çš„ `DatetimeIndex` å¯¹è±¡ï¼Œä»¥ä¾¿ä»ä¸­æå–å¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’ç­‰å­—æ®µç”¨äºç‰¹å¾å·¥ç¨‹ã€‚**

------

### é€è¡Œè§£é‡Šå¦‚ä¸‹ï¼š

------

```
python


å¤åˆ¶ç¼–è¾‘
time_value = pd.DatetimeIndex(time_value)
```

- `pd.DatetimeIndex(...)` æ˜¯ Pandas ä¸­ç”¨äºå°†ä¸€ç»„ datetime æ•°æ®å°è£…ä¸ºä¸€ä¸ª **ç´¢å¼•å¯¹è±¡**ï¼Œå®ƒå…·å¤‡å¾ˆå¤šç»“æ„åŒ–çš„æ—¶é—´å±æ€§ã€‚
- åŸå§‹ `time_value` æ˜¯ä¸€ä¸ª `Series`ï¼ˆä¸€åˆ— datetime æ ¼å¼çš„æ—¶é—´ï¼‰ï¼›
- è½¬æ¢æˆ `DatetimeIndex` åï¼Œå¯ä»¥ç›´æ¥è®¿é—®å¦‚ä¸‹å­—æ®µï¼š
  - `time_value.year` å¹´
  - `time_value.month` æœˆ
  - `time_value.day` æ—¥
  - `time_value.hour` å°æ—¶
  - `time_value.minute` åˆ†é’Ÿ
  - `time_value.second` ç§’
  - `time_value.weekday` æ˜ŸæœŸå‡ ï¼ˆ0=å‘¨ä¸€ï¼Œ6=å‘¨æ—¥ï¼‰
  - `time_value.dayofyear` ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©

ğŸ“Œ âœ… è¿™ä¸ªè½¬æ¢çš„ä¸»è¦ç›®çš„ï¼š**ä¾¿äºæå–æ—¶é—´ç›¸å…³ç‰¹å¾**ï¼Œä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹æä¾›æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

------

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(time_value[0:10])
```

- æ‰“å° 50 ä¸ª `-` ä½œä¸ºåˆ†éš”çº¿ï¼Œç¾åŒ–è¾“å‡ºï¼›
- æ‰“å°è½¬æ¢åçš„å‰ 10 ä¸ª `DatetimeIndex` æ—¶é—´å€¼ï¼Œç¤ºä¾‹è¾“å‡ºå¦‚ä¸‹ï¼š

```
python-replå¤åˆ¶ç¼–è¾‘2025-01-01 00:00:00
2025-01-01 00:01:00
...
```

------

### ğŸ” ç¤ºä¾‹ï¼šä» `DatetimeIndex` ä¸­æå–å­—æ®µ

ä½ æ¥ä¸‹æ¥å¯ä»¥å†™ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday
```

ç”¨äºæ„é€ æ–°ç‰¹å¾ï¼Œæ¯”å¦‚ï¼š

- ç”¨æˆ·ç­¾åˆ°çš„æ—¶é—´æ˜¯ç™½å¤©è¿˜æ˜¯å¤œæ™šï¼Ÿ
- æ˜¯å·¥ä½œæ—¥è¿˜æ˜¯å‘¨æœ«ï¼Ÿ
- æ˜¯å“ªä¸ªå°æ—¶ç”¨æˆ·æœ€æ´»è·ƒï¼Ÿ

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> è¿™æ®µä»£ç æŠŠæ—¶é—´åˆ—å˜æˆç»“æ„åŒ–æ—¶é—´ç´¢å¼•ï¼ˆ`DatetimeIndex`ï¼‰ï¼Œä¸ºåç»­**æå–å¹´/æœˆ/æ—¥/å°æ—¶ç­‰æ—¶é—´ç‰¹å¾**åšå¥½å‡†å¤‡ï¼Œæ˜¯å…¸å‹çš„æ—¶é—´ç‰¹å¾å·¥ç¨‹æ­¥éª¤ä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

ä»£ç ä½œç”¨ï¼šprint('-' * 50) # æ„é€ ä¸€äº›ç‰¹å¾ï¼Œæ‰§è¡Œçš„è­¦å‘Šæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ“ä½œæ˜¯å¤åˆ¶ï¼Œlocæ˜¯ç›´æ¥æ”¾å…¥ print(type(data)) # data['day'] = time_value.day # data['hour'] = time_value.hour # data['weekday'] = time_value.weekday #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤© data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„ data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  # # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ data = data.drop(['time'], axis=1) print('-' * 50) data.head()



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å¯¹åŸå§‹ç­¾åˆ°æ•°æ®è¿›è¡Œ**æ—¶é—´ç‰¹å¾å·¥ç¨‹å¤„ç†**ï¼Œæå–å¯¹ç”¨æˆ·ç­¾åˆ°è¡Œä¸ºæœ‰æ˜¾è‘—å½±å“çš„æ—¶é—´ç»´åº¦ï¼ˆå¦‚ï¼š**æ—¥ã€å°æ—¶ã€æ˜ŸæœŸå‡ **ï¼‰ï¼Œå¹¶åˆ é™¤åŸå§‹çš„æ—¶é—´æˆ³å­—æ®µï¼Œæ•´ç†ä¸ºé€‚åˆç”¨äºå»ºæ¨¡çš„æ•°æ®æ ¼å¼ã€‚

ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š

------

### ğŸ”¹ æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- ç”¨äºç¾åŒ–è¾“å‡ºï¼Œåˆ†éš”å†…å®¹ã€‚

------

### ğŸ” æ‰“å° DataFrame ç±»å‹

```
python


å¤åˆ¶ç¼–è¾‘
print(type(data))
```

- è¾“å‡º `data` çš„æ•°æ®ç±»å‹ï¼Œåº”è¯¥æ˜¯ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  <class 'pandas.core.frame.DataFrame'>
  ```

- è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Pandas è¡¨æ ¼ç»“æ„å¯¹è±¡ã€‚

------

### ğŸ”§ æ’å…¥æ–°ç‰¹å¾åˆ—ï¼ˆä»æ—¶é—´ä¸­æå–ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'day', time_value.day)
```

- `data.shape[1]` è¡¨ç¤ºå½“å‰åˆ—çš„æ€»æ•°ï¼ˆåœ¨æœ€åä¸€åˆ—åæ’å…¥ï¼‰ï¼›
- `'day'` è¡¨ç¤ºç­¾åˆ°çš„â€œå‡ å·â€ï¼ˆ1å·ã€2å·â€¦â€¦ï¼‰ï¼›
- `time_value.day` æ˜¯ä» `DatetimeIndex` ä¸­æå–çš„â€œå¤©â€å­—æ®µã€‚

ğŸ“Œ æ’å…¥ä½ç½®å¯ä»¥æ˜¯ä»»æ„åˆ—ç´¢å¼•ï¼Œè¿™é‡Œç”¨ `data.shape[1]` ä»£è¡¨ **æ’å…¥åˆ°æœ€åä¸€åˆ—**ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'hour', time_value.hour)
```

- æ’å…¥ç­¾åˆ°çš„â€œå°æ—¶â€å­—æ®µï¼ˆ0~23ï¼‰ï¼Œè¡¨ç¤ºç”¨æˆ·åœ¨å“ªä¸ªæ—¶æ®µç­¾åˆ°ã€‚
- è¿™ä¸ªå¯¹ç”¨æˆ·è¡Œä¸ºéå¸¸å…³é”®ï¼š
  - æ¯”å¦‚æ—©ä¸Šå¸¸ç­¾åˆ°åœ°é“ç«™ã€ä¸­åˆç­¾åˆ°é¤å…ã€æ™šä¸Šç­¾åˆ°å½±é™¢ç­‰ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'weekday', time_value.weekday)
```

- æ’å…¥ç­¾åˆ°çš„â€œæ˜ŸæœŸå‡ â€å­—æ®µï¼ˆ0=å‘¨ä¸€ï¼Œ6=å‘¨æ—¥ï¼‰ã€‚
- è¿™ç”¨äºåŒºåˆ†å·¥ä½œæ—¥å’Œå‘¨æœ«ç”¨æˆ·çš„è¡Œä¸ºå·®å¼‚ã€‚
  - ä¾‹å¦‚å·¥ä½œæ—¥é€šå‹¤ç­¾åˆ° vs å‘¨æœ«å¨±ä¹åœºæ‰€ç­¾åˆ°ã€‚

------

### ğŸ—‘ï¸ åˆ é™¤åŸå§‹æ—¶é—´æˆ³å­—æ®µ

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1)
```

- åˆ é™¤åŸå§‹ `time` åˆ—ï¼ŒåŸå› æ˜¯ï¼š
  - å®ƒæ˜¯åŸå§‹çš„â€œç§’â€çº§æ•´æ•°ï¼Œä¸å¯è¯»ï¼›
  - æˆ‘ä»¬å·²ç»ä»å®ƒä¸­æå–å‡º `day`, `hour`, `weekday` è¿™äº›æ›´æœ‰ç”¨çš„ç‰¹å¾ï¼›
- `axis=1` è¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ã€‚

------

### ğŸ”š æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

------

### ğŸ‘€ æŸ¥çœ‹æ•°æ®å‰å‡ è¡Œ

```
python


å¤åˆ¶ç¼–è¾‘
data.head()
```

- æŸ¥çœ‹æ›´æ–°åçš„ DataFrame å‰ 5 è¡Œï¼Œç”¨äºç¡®è®¤ï¼š
  - æ–°å¢çš„æ—¶é—´ç‰¹å¾æ˜¯å¦æ’å…¥æˆåŠŸï¼›
  - åŸæ¥çš„ `time` å­—æ®µæ˜¯å¦åˆ é™¤ã€‚

------

### âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤         | è¯´æ˜                                        |
| ------------ | ------------------------------------------- |
| æå–æ—¶é—´å­—æ®µ | ä»åŸå§‹æ—¶é—´æˆ³ä¸­æå– `day`, `hour`, `weekday` |
| æ’å…¥æ–°åˆ—     | æŠŠè¿™äº›æ–°æ—¶é—´ç‰¹å¾æ·»åŠ åˆ°æ•°æ®çš„æœ«å°¾            |
| åˆ é™¤åŸæ—¶é—´æˆ³ | ç§»é™¤ä¸å†éœ€è¦çš„ `time` å­—æ®µ                  |
| å‡†å¤‡å»ºæ¨¡     | å¾—åˆ°æ›´æœ‰è§£é‡ŠåŠ›çš„æ—¶é—´ç‰¹å¾ï¼Œå¢å¼ºæ¨¡å‹æ€§èƒ½      |



------

è¿™äº›æ—¶é—´ç‰¹å¾åœ¨**ç”¨æˆ·è¡Œä¸ºé¢„æµ‹ã€ä½ç½®æ‰“å¡å»ºæ¨¡ã€KNNåˆ†ç±»ç­‰ä»»åŠ¡ä¸­éå¸¸å…³é”®**ï¼Œå› ä¸ºæ—¶é—´ä¸äººçš„æ´»åŠ¨é«˜åº¦ç›¸å…³ã€‚ä½ ç°åœ¨çš„åšæ³•æ˜¯æ ‡å‡†ã€åˆç†çš„â€œç‰¹å¾å·¥ç¨‹â€æ­¥éª¤ã€‚éœ€è¦çš„è¯ï¼Œæˆ‘è¿˜å¯ä»¥å¸®ä½ ç»§ç»­åšæ•°æ®æ ‡å‡†åŒ–ã€è®­ç»ƒæµ‹è¯•é›†åˆ’åˆ†å’Œ KNN å»ºæ¨¡ã€‚



##### æ‚¨è¯´ï¼š

print('-' * 50) # æ„é€ ä¸€äº›ç‰¹å¾ï¼Œæ‰§è¡Œçš„è­¦å‘Šæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ“ä½œæ˜¯å¤åˆ¶ï¼Œlocæ˜¯ç›´æ¥æ”¾å…¥ print(type(data)) data['day'] = time_value.day data['hour'] = time_value.hour data['weekday'] = time_value.weekday #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤© data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„ data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  # # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ data = data.drop(['time'], axis=1) print('-' * 50) data.head()æœ‰å¦‚ä¸‹é—®é¢˜ï¼šValueError                                Traceback (most recent call last) Cell In[23], line 8      6 data['weekday'] = time_value.weekday      7 #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† ----> 8 data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤©      9 data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„     10 data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py:5165, in DataFrame.insert(self, loc, column, value, allow_duplicates)   5159     raise ValueError(   5160         "Cannot specify 'allow_duplicates=True' when "   5161         "'self.flags.allows_duplicate_labels' is False."   5162     )   5163 if not allow_duplicates and column in self.columns:   5164     # Should this be a different kind of error?? -> 5165     raise ValueError(f"cannot insert {column}, already exists")   5166 if not is_integer(loc):   5167     raise TypeError("loc must be int") ValueError: cannot insert day, already exists



###### ChatGPT è¯´ï¼š

ä½ é‡åˆ°çš„æŠ¥é”™æ˜¯ï¼š

```
sql


å¤åˆ¶ç¼–è¾‘
ValueError: cannot insert day, already exists
```

### ğŸ§¨ æŠ¥é”™åŸå› ï¼š

ä½ å·²ç»åœ¨å‰é¢ç”¨ä»¥ä¸‹ä»£ç ç»™ `data` æ·»åŠ äº† `'day'`ã€`'hour'` å’Œ `'weekday'` ä¸‰åˆ—ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday
```

ç„¶åä½ åˆé‡å¤ç”¨ `data.insert(...)` æƒ³å†æ’å…¥ä¸€éè¿™ä¸‰åˆ—ï¼Œä½†è¿™æ—¶å®ƒä»¬ **å·²ç»å­˜åœ¨äº†**ï¼Œæ‰€ä»¥ Pandas æŠ¥é”™è¯´ï¼š

> ä¸èƒ½æ’å…¥åˆ— `'day'`ï¼Œå› ä¸ºå®ƒå·²ç»å­˜åœ¨äº DataFrame ä¸­ã€‚

------

### âœ… æ­£ç¡®åšæ³•ï¼š**åªé€‰æ‹©ä¸€ç§æ–¹å¼æ·»åŠ åˆ—ï¼Œä¸è¦é‡å¤æ·»åŠ ï¼**

#### âœ… âœ… æ¨èæ–¹å¼ï¼ˆç®€å•ç›´è§‚ï¼‰â€”â€”ç›´æ¥èµ‹å€¼æ³•ï¼ˆä¸å†ç”¨ `insert()`ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(type(data))

# ç›´æ¥é€šè¿‡èµ‹å€¼æ·»åŠ æ–°åˆ—ï¼ˆæ¨èï¼‰
data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday

# åˆ é™¤åŸå§‹çš„æ—¶é—´æˆ³åˆ—
data = data.drop(['time'], axis=1)

print('-' * 50)
data.head()
```

------

### ğŸ“ å¯¹æ¯”ä¸¤ç§æ–¹å¼ï¼š

| æ–¹æ³•         | å†™æ³•                           | æ˜¯å¦å…è®¸è¦†ç›–åŒååˆ—       |
| ------------ | ------------------------------ | ------------------------ |
| âœ… ç›´æ¥èµ‹å€¼æ³• | `data['day'] = ...`            | å…è®¸ï¼Œæ¨èä½¿ç”¨           |
| âŒ `insert()` | `data.insert(..., 'day', ...)` | ä¸å…è®¸ï¼Œè‹¥åˆ—å·²å­˜åœ¨ä¼šæŠ¥é”™ |



------

### ğŸ› ï¸ å¦‚æœä½ åšæŒä½¿ç”¨ `insert()`ï¼Œå¯ä»¥å…ˆåˆ¤æ–­åˆ—æ˜¯å¦å­˜åœ¨ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘if 'day' not in data.columns:
    data.insert(data.shape[1], 'day', time_value.day)
```

ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œ**æ¨èç”¨ç®€å•èµ‹å€¼æ³•**ï¼Œæ›´çµæ´»æ›´å®‰å…¨ã€‚

------

### âœ… æ€»ç»“ï¼š

ä½ æŠ¥é”™çš„åŸå› æ˜¯é‡å¤æ’å…¥å·²å­˜åœ¨çš„åˆ—ï¼ˆ`'day'`ã€`'hour'`ã€`'weekday'`ï¼‰ã€‚
 è¯·åˆ æ‰ `insert(...)` çš„éƒ¨åˆ†ï¼Œä¿ç•™å‰é¢çš„èµ‹å€¼è¯­å¥å³å¯ï¼Œç¨‹åºå°±ä¸ä¼šæŠ¥é”™äº† âœ…ã€‚éœ€è¦æˆ‘å¸®ä½ æ•´ç†æˆå®Œæ•´æ— è¯¯çš„ä»£ç ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

KeyError                                  Traceback (most recent call last) Cell In[24], line 14      6 data['weekday'] = time_value.weekday      7 #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç†      8 # data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤©      9 # data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„   (...)     12 #     13 # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ ---> 14 data = data.drop(['time'], axis=1)     15 print('-' * 50)     16 data.head() File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py:5588, in DataFrame.drop(self, labels, axis, index, columns, level, inplace, errors)   5440 def drop(   5441     self,   5442     labels: IndexLabel | None = None,   (...)   5449     errors: IgnoreRaise = "raise",   5450 ) -> DataFrame | None:   5451     """   5452     Drop specified labels from rows or columns.   5453    (...)   5586             weight  1.0     0.8   5587     """ -> 5588     return super().drop(   5589         labels=labels,   5590         axis=axis,   5591         index=index,   5592         columns=columns,   5593         level=level,   5594         inplace=inplace,   5595         errors=errors,   5596     ) File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py:4807, in NDFrame.drop(self, labels, axis, index, columns, level, inplace, errors)   4805 for axis, labels in axes.items():   4806     if labels is not None: -> 4807         obj = obj._drop_axis(labels, axis, level=level, errors=errors)   4809 if inplace:   4810     self._update_inplace(obj) File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py:4849, in NDFrame._drop_axis(self, labels, axis, level, errors, only_slice)   4847         new_axis = axis.drop(labels, level=level, errors=errors)   4848     else: -> 4849         new_axis = axis.drop(labels, errors=errors)   4850     indexer = axis.get_indexer(new_axis)   4852 # Case for non-unique axis   4853 else: File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\i



###### ChatGPT è¯´ï¼š

ä½ ç°åœ¨é‡åˆ°çš„é”™è¯¯æ˜¯ï¼š

```
vbnet


å¤åˆ¶ç¼–è¾‘
KeyError: "['time'] not found in axis"
```

------

### â— é”™è¯¯åŸå› ï¼š

ä½ å†™äº†è¿™è¡Œä»£ç ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1)
```

æ„æ€æ˜¯ä»åˆ—ä¸­åˆ é™¤ `'time'` å­—æ®µã€‚

ä½†æŠ¥é”™è¯´æ˜ï¼š

> `DataFrame` ä¸­ **å·²ç»æ²¡æœ‰åä¸º `'time'` çš„åˆ—äº†**ï¼Œæ‰€ä»¥ Pandas æŠ¥é”™è¯´æ‰¾ä¸åˆ°è¯¥åˆ—ã€‚

------

### âœ… è§£å†³æ–¹æ³•ï¼š

åœ¨è°ƒç”¨ `.drop()` åˆ é™¤åˆ—ä¹‹å‰ï¼Œ**å…ˆç¡®è®¤è¿™ä¸ªåˆ—æ˜¯å¦å­˜åœ¨**ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨æ–¹å¼ï¼š

------

#### âœ… æ–¹æ³• 1ï¼šä½¿ç”¨ `errors='ignore'`ï¼Œå³ä½¿åˆ—ä¸å­˜åœ¨ä¹Ÿä¸æŠ¥é”™ï¼ˆæœ€æ¨èï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1, errors='ignore')
```

è¿™æ ·å³ä½¿ `'time'` ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä»£ç æ›´å¥å£®ã€‚

------

#### âœ… æ–¹æ³• 2ï¼šå…ˆåˆ¤æ–­åˆ—åæ˜¯å¦åœ¨ DataFrame ä¸­å†åˆ 

```
pythonå¤åˆ¶ç¼–è¾‘if 'time' in data.columns:
    data = data.drop(['time'], axis=1)
```

------

### ğŸ“Œ é™„å¸¦è¯´æ˜ï¼šä½ å‰é¢å¯èƒ½å·²ç»æ‰§è¡Œè¿‡ä¸€æ¬¡ `.drop(['time'])`ï¼Œæˆ–è€…å·²ç»åœ¨å…¶ä»–å•å…ƒæ ¼ä¸­åˆ è¿‡è¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥å†æ¬¡åˆ å°±æŠ¥é”™äº†ã€‚

------

### âœ… æœ€ç»ˆæ¨èä»£ç ï¼ˆç®€æ´å®‰å…¨ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘# åˆ é™¤æ—¶é—´åˆ—ï¼Œå¦‚æœå·²ä¸å­˜åœ¨ä¹Ÿä¸æŠ¥é”™
data = data.drop(['time'], axis=1, errors='ignore')
```

------

éœ€è¦æˆ‘å¸®ä½ æ•´ç†æˆå®Œæ•´ä¸æŠ¥é”™çš„æ¸…æ´—ä¸ç‰¹å¾æå–ä»£ç å—ï¼Ÿå¯ä»¥ä¸€é”®è¿è¡Œä¸å‡ºé”™çš„ç‰ˆæœ¬ ğŸ‘ã€‚







##### æ‚¨è¯´ï¼š

x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1) print("è®­ç»ƒé›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_train, y_train) print("è®­ç»ƒé›†ç‰¹å¾å€¼shape", x_train.shape) print('-'*50)è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä»€ä¹ˆ  print("æµ‹è¯•é›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_test, y_test) print("æµ‹è¯•é›†ç‰¹å¾å€¼shape", x_test.shape)



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªæ•°æ®é›†ï¼ˆ`li.data` ä¸ºç‰¹å¾å€¼ï¼Œ`li.target` ä¸ºç›®æ ‡å€¼ï¼‰**æŒ‰æ¯”ä¾‹åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†**ï¼Œå¹¶æ‰“å°åˆ’åˆ†åçš„æ•°æ®å†…å®¹åŠå…¶å½¢çŠ¶ã€‚ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š

------

### 1ï¸âƒ£ æ•°æ®åˆ’åˆ†ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1)
```

**å«ä¹‰ï¼š**

- `train_test_split` æ˜¯ sklearn ä¸­çš„å‡½æ•°ï¼Œç”¨æ¥**å°†åŸå§‹æ•°æ®é›†éšæœºåˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†**ã€‚
- `li.data`ï¼šæ ·æœ¬çš„ç‰¹å¾ï¼ˆäºŒç»´æ•°ç»„ï¼‰
- `li.target`ï¼šå¯¹åº”çš„æ ‡ç­¾ï¼ˆç›®æ ‡å€¼ï¼‰
- `test_size=0.25`ï¼šè¡¨ç¤º 25% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œ75% ä½œä¸ºè®­ç»ƒé›†
- `random_state=1`ï¼šè®¾ç½®éšæœºç§å­ï¼Œä¿è¯æ¯æ¬¡åˆ’åˆ†çš„ç»“æœä¸€è‡´ï¼ˆå¯å¤ç°ï¼‰

------

### 2ï¸âƒ£ æ‰“å°è®­ç»ƒé›†å†…å®¹ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print("è®­ç»ƒé›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_train, y_train)
print("è®­ç»ƒé›†ç‰¹å¾å€¼shape", x_train.shape)
```

**å«ä¹‰ï¼š**

- è¾“å‡ºåˆ’åˆ†å¾—åˆ°çš„è®­ç»ƒé›†ç‰¹å¾ï¼ˆ`x_train`ï¼‰å’Œç›®æ ‡å€¼ï¼ˆ`y_train`ï¼‰
- è¾“å‡ºè®­ç»ƒé›†ç‰¹å¾çš„ç»´åº¦ä¿¡æ¯ï¼ˆshapeï¼‰ï¼Œä¾‹å¦‚ `(112, 4)`ï¼Œè¡¨ç¤ºæœ‰112æ¡æ•°æ®ï¼Œæ¯æ¡æ•°æ®æœ‰4ä¸ªç‰¹å¾ã€‚

------

### 3ï¸âƒ£ åˆ†å‰²çº¿ï¼ˆç¾åŒ–è¾“å‡ºï¼‰ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print('-'*50)
```

**ä½œç”¨ï¼š**

- æ‰“å°ä¸€æ¡ç”± 50 ä¸ª `-` ç»„æˆçš„åˆ†å‰²çº¿ï¼Œæ–¹ä¾¿åŒºåˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„è¾“å‡ºã€‚

------

### 4ï¸âƒ£ æ‰“å°æµ‹è¯•é›†å†…å®¹ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print("æµ‹è¯•é›†ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ï¼š", x_test, y_test)
print("æµ‹è¯•é›†ç‰¹å¾å€¼shape", x_test.shape)
```

**å«ä¹‰ï¼š**

- è¾“å‡ºåˆ’åˆ†å¾—åˆ°çš„æµ‹è¯•é›†ç‰¹å¾ï¼ˆ`x_test`ï¼‰å’Œç›®æ ‡å€¼ï¼ˆ`y_test`ï¼‰
- è¾“å‡ºæµ‹è¯•é›†ç‰¹å¾çš„ç»´åº¦ä¿¡æ¯ï¼ˆshapeï¼‰ï¼Œä¾‹å¦‚ `(38, 4)`ï¼Œè¡¨ç¤ºæœ‰38æ¡æµ‹è¯•æ•°æ®ã€‚

------

### ğŸ” æ€»ç»“ï¼š

è¿™æ®µä»£ç çš„æ€»ä½“ä½œç”¨æ˜¯ï¼š

> å°†ä¸€ä¸ªæ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶æ‰“å°å®ƒä»¬çš„å†…å®¹å’Œç»´åº¦ä¿¡æ¯ï¼Œç”¨äºåç»­çš„æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°ã€‚

å¦‚æœä½ æ˜¯åœ¨å¤„ç†æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œæ¯”å¦‚é¸¢å°¾èŠ±åˆ†ç±»ã€æ‰‹å†™æ•°å­—è¯†åˆ«ç­‰ï¼Œè¿™æ˜¯éå¸¸å¸¸è§çš„å‡†å¤‡æ­¥éª¤ä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

ä¸ºä»€ä¹ˆè®¾ç½®random_state=1



###### ChatGPT è¯´ï¼š

è®¾ç½® `random_state=1` çš„ç›®çš„æ˜¯ï¼š

> **è®© `train_test_split()` åœ¨æ¯æ¬¡è¿è¡Œæ—¶åˆ’åˆ†å‡ºçš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†å§‹ç»ˆä¸€è‡´ï¼ˆå¯å¤ç°ï¼‰**ã€‚

------

### ğŸ“Œ èƒŒæ™¯è§£é‡Šï¼š

`train_test_split()` é»˜è®¤æ˜¯**éšæœºåˆ’åˆ†æ•°æ®**çš„ã€‚å¦‚æœä½ ä¸è®¾ç½® `random_state`ï¼Œæ¯æ¬¡è¿è¡Œç¨‹åºæ—¶ï¼Œåˆ’åˆ†çš„ç»“æœéƒ½å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ï¼š

- è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸åŒï¼›
- æ¨¡å‹è®­ç»ƒç»“æœå¯èƒ½å˜åŒ–ï¼›
- ä¸æ–¹ä¾¿è°ƒè¯•å’Œå¯¹æ¯”ä¸åŒæ¨¡å‹ã€‚

------

### âœ… è®¾ç½® `random_state=1` å¸¦æ¥çš„å¥½å¤„ï¼š

| é¡¹ç›®             | å«ä¹‰                                          |
| ---------------- | --------------------------------------------- |
| `random_state=1` | æŒ‡å®šäº†éšæœºç§å­ä¸º 1                            |
| ç¨³å®šæ€§           | æ¯æ¬¡åˆ’åˆ†ç»“æœéƒ½ç›¸åŒ                            |
| å¯å¯¹æ¯”æ€§         | å¤šæ¬¡è®­ç»ƒç»“æœå¯æ¯”è¾ƒã€å¯å¤æŸ¥                    |
| å¯å¤ç°æ€§         | åˆ«äººè¿è¡Œä½ çš„ä»£ç æ—¶ä¹Ÿèƒ½å¾—åˆ°åŒæ ·çš„è®­ç»ƒ/æµ‹è¯•æ•°æ® |



ä½ å¯ä»¥ç†è§£ä¸ºï¼š

> `random_state` å°±åƒæ˜¯â€œæ´—ç‰Œçš„å¯†ç â€ï¼Œç›¸åŒçš„å¯†ç æ¯æ¬¡æ´—å‡ºçš„ç‰Œé¡ºåºéƒ½ä¸€æ ·ã€‚

------

### ğŸ’¡ è¡¥å……è¯´æ˜ï¼š

ä½ å¯ä»¥è®¾ç½®ä¸ºä»»æ„æ•´æ•°ï¼ˆå¦‚ 0ã€1ã€42 éƒ½å¯ä»¥ï¼‰ï¼Œåªè¦åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ç»Ÿä¸€å³å¯ã€‚ä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
random_state=42  # ä¹Ÿæ˜¯å¾ˆå¤šæ•™ç¨‹å’Œè®ºæ–‡å–œæ¬¢ç”¨çš„é»˜è®¤å€¼
```

------

### â— å¦‚æœä½ ä¸è®¾ç½® `random_state` ä¼šæ€æ ·ï¼Ÿ

```
python


å¤åˆ¶ç¼–è¾‘
train_test_split(..., test_size=0.25)
```

è¿™æ ·æ¯æ¬¡è¿è¡Œç¨‹åºï¼Œå¾—åˆ°çš„ `x_train`, `x_test` éƒ½å¯èƒ½ä¸åŒï¼Œå¯¼è‡´ç»“æœä¸ç¨³å®šã€‚

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> è®¾ç½® `random_state=1` æ˜¯ä¸ºäº†ç¡®ä¿æ•°æ®åˆ’åˆ†å¯é‡å¤ã€ç»“æœå¯æ¯”è¾ƒï¼Œæ˜¯è‰¯å¥½çš„æœºå™¨å­¦ä¹ å®è·µä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

train_test_split(li.data, li.target, test_size=0.25, random_state=1)å‡½æ•°çš„è¿”å›å€¼é¡ºåº



###### ChatGPT è¯´ï¼š

å‡½æ•° `train_test_split(li.data, li.target, test_size=0.25, random_state=1)` çš„è¿”å›å€¼é¡ºåºæ˜¯ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¿”å›çš„æ˜¯**è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾å€¼ä¸ç›®æ ‡å€¼ï¼ŒæŒ‰ç…§ä»¥ä¸‹é¡ºåºæ’åˆ—**ï¼š

| è¿”å›å€¼    | å«ä¹‰                       |
| --------- | -------------------------- |
| `x_train` | è®­ç»ƒé›†çš„ç‰¹å¾æ•°æ®ï¼ˆç‰¹å¾å€¼ï¼‰ |
| `x_test`  | æµ‹è¯•é›†çš„ç‰¹å¾æ•°æ®           |
| `y_train` | è®­ç»ƒé›†çš„ç›®æ ‡æ•°æ®ï¼ˆæ ‡ç­¾ï¼‰   |
| `y_test`  | æµ‹è¯•é›†çš„ç›®æ ‡æ•°æ®           |



------

### âœ… ä¸¾ä¸ªä¾‹å­ï¼š

å‡è®¾ä½ å†™äº†å¦‚ä¸‹ä»£ç ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris

li = load_iris()
x_train, x_test, y_train, y_test = train_test_split(li.data, li.target, test_size=0.25, random_state=1)
```

åˆ™ï¼š

- `x_train.shape` æ˜¯ `(112, 4)`ï¼Œè®­ç»ƒé›†ä¸­æœ‰ 112 æ¡æ ·æœ¬ï¼Œæ¯æ¡æœ‰ 4 ä¸ªç‰¹å¾ï¼›
- `x_test.shape` æ˜¯ `(38, 4)`ï¼Œæµ‹è¯•é›†ä¸­æœ‰ 38 æ¡æ ·æœ¬ï¼›
- `y_train.shape` æ˜¯ `(112,)`ï¼Œç›®æ ‡æ ‡ç­¾æ˜¯ 1D æ•°ç»„ï¼›
- `y_test.shape` æ˜¯ `(38,)`ã€‚

------

### ğŸ“Œ æ³¨æ„ï¼š

`train_test_split()` æ”¯æŒä¼ å…¥å¤šä¸ªæ•°ç»„ï¼Œä¼š**æŒ‰ç›¸åŒçš„æ–¹å¼æ‹†åˆ†è¿™äº›æ•°ç»„**ï¼Œè¿”å›å€¼çš„é¡ºåºä¸ä¼ å…¥é¡ºåºä¸€è‡´ã€‚ä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
x1_train, x1_test, x2_train, x2_test = train_test_split(x1, x2, test_size=0.25)
```

å°±æ˜¯åˆ†åˆ«å¯¹ `x1` å’Œ `x2` åšç›¸åŒåˆ’åˆ†ï¼Œè¿”å› `x1_train`, `x1_test`, `x2_train`, `x2_test`ã€‚

------

### âœ… æ€»ç»“ï¼š

> `train_test_split(data, target)` é»˜è®¤è¿”å›å€¼é¡ºåºæ˜¯ï¼š
>  `x_train`, `x_test`, `y_train`, `y_test`ï¼ˆ**è®­ç»ƒç‰¹å¾ã€æµ‹è¯•ç‰¹å¾ã€è®­ç»ƒæ ‡ç­¾ã€æµ‹è¯•æ ‡ç­¾**ï¼‰ã€‚
>  ä½ åº”è¯¥æŒ‰ç…§è¿™ä¸ªé¡ºåºè¿›è¡Œå˜é‡æ¥æ”¶ã€‚



##### æ‚¨è¯´ï¼š

\# ä¸‹é¢æ˜¯æ¯”è¾ƒå¤§çš„æ•°æ®ï¼Œéœ€è¦ä¸‹è½½ä¸€ä¼šï¼Œ20ç±»æ–°é—» #subsetä»£è¡¨ä¸‹è½½çš„æ•°æ®é›†ç±»å‹ï¼Œé»˜è®¤æ˜¯trainï¼Œåªæœ‰è®­ç»ƒé›† news = fetch_20newsgroups(subset='all', data_home='data') # print(news.feature_names)  #è¿™ä¸ªæ•°æ®é›†æ˜¯æ²¡æœ‰çš„ï¼Œå› ä¸ºæ²¡æœ‰ç‰¹å¾ï¼Œåªæœ‰æ–‡æœ¬æ•°æ® # print(news.DESCR) print('ç¬¬ä¸€ä¸ªæ ·æœ¬') print(news.data[0]) print('ç‰¹å¾ç±»å‹') print(type(news.data)) print('-' * 50) print(news.target[0:15]) from pprint import pprint pprint(list(news.target_names))ä¸Šé¢ä»£ç çš„ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **ä¸‹è½½å¹¶åŠ è½½ 20 ç±»æ–°é—»æ–‡æœ¬æ•°æ®é›†ï¼ˆ`20newsgroups`ï¼‰ï¼Œå¹¶æŸ¥çœ‹éƒ¨åˆ†å†…å®¹ã€ç±»å‹å’Œç›®æ ‡åˆ†ç±»ä¿¡æ¯**ã€‚

ä¸‹é¢æˆ‘æ¥é€è¡Œè§£é‡Šï¼š

------

### âœ… 1. ä¸‹è½½æ–°é—»æ•°æ®é›†

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.datasets import fetch_20newsgroups

news = fetch_20newsgroups(subset='all', data_home='data')
```

- `fetch_20newsgroups(...)` æ˜¯ sklearn æä¾›çš„å‡½æ•°ï¼Œç”¨äºä¸‹è½½**20ç±»æ–°é—»æ•°æ®é›†**ã€‚
- `subset='all'`ï¼šè¡¨ç¤ºä¸‹è½½ **å…¨éƒ¨æ•°æ®**ï¼ˆåŒ…æ‹¬è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼‰ã€‚
  - ä¹Ÿå¯ä»¥è®¾ä¸º `'train'` æˆ– `'test'`
- `data_home='data'`ï¼šæŒ‡å®šæŠŠæ•°æ®å­˜åˆ° `data/` ç›®å½•ä¸‹ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚

ğŸ“Œ **æ•°æ®ç»“æ„è¯´æ˜ï¼š**
 è¿”å›çš„æ˜¯ä¸€ä¸ª `sklearn.utils.Bunch` å¯¹è±¡ï¼Œç±»ä¼¼äºå­—å…¸ï¼Œæœ‰ä»¥ä¸‹å¸¸ç”¨å­—æ®µï¼š

| å­—æ®µå         | å«ä¹‰                           |
| -------------- | ------------------------------ |
| `data`         | æ‰€æœ‰æ–°é—»æ–‡æœ¬åˆ—è¡¨ï¼ˆå­—ç¬¦ä¸²ï¼‰     |
| `target`       | æ¯æ¡æ–°é—»å¯¹åº”çš„ç±»åˆ«ç¼–å·ï¼ˆ0~19ï¼‰ |
| `target_names` | ç±»åˆ«ç¼–å·å¯¹åº”çš„ç±»åï¼ˆå…± 20 ä¸ªï¼‰ |



------

### âœ… 2. æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ–°é—»æ ·æœ¬å†…å®¹

```
pythonå¤åˆ¶ç¼–è¾‘print('ç¬¬ä¸€ä¸ªæ ·æœ¬')
print(news.data[0])
```

- æ‰“å°å‡ºç¬¬ä¸€æ¡æ–°é—»çš„åŸå§‹æ–‡æœ¬å†…å®¹ï¼ˆçº¯æ–‡æœ¬ï¼‰ã€‚

------

### âœ… 3. æŸ¥çœ‹æ•°æ®ç±»å‹

```
pythonå¤åˆ¶ç¼–è¾‘print('ç‰¹å¾ç±»å‹')
print(type(news.data))
```

- è¾“å‡º `news.data` çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯ `list`ï¼Œå…¶ä¸­æ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå³ä¸€ç¯‡æ–‡ç« ï¼‰ã€‚

------

### âœ… 4. æ‰“å°ç›®æ ‡å€¼å‰ 15 ä¸ª

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(news.target[0:15])
```

- `news.target` æ˜¯ä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œå¯¹åº”æ¯ç¯‡æ–°é—»çš„**ç±»åˆ«ç¼–å·**ã€‚
- è¿™è¡Œä»£ç æ‰“å°å‰ 15 ç¯‡æ–‡ç« å¯¹åº”çš„ç±»åˆ«ç¼–å·ã€‚

------

### âœ… 5. æ‰“å°æ‰€æœ‰çš„ç±»åˆ«åç§°ï¼ˆå³æ–°é—»ä¸»é¢˜ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘from pprint import pprint
pprint(list(news.target_names))
```

- `news.target_names` æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰ 20 ä¸ªæ–°é—»ç±»åˆ«çš„åç§°ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚
- `pprint()` å¯ä»¥æ›´æ¸…æ™°åœ°æ‰“å°åˆ—è¡¨ï¼Œæ ¼å¼æ›´æ•´é½ã€‚

------

### ğŸ“š ç¤ºä¾‹è¾“å‡ºï¼ˆå¯èƒ½é•¿è¿™æ ·ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘ç¬¬ä¸€ä¸ªæ ·æœ¬
From: lerxst@wam.umd.edu (where's my thing)
Subject: WHAT car is this!?
...
ç‰¹å¾ç±»å‹
<class 'list'>
--------------------------------------------------
[7, 4, 4, 1, 14, 16, 3, 4, 4, 1, 4, 4, 2, 4, 5]
['alt.atheism',
 'comp.graphics',
 'comp.os.ms-windows.misc',
 'comp.sys.ibm.pc.hardware',
 ...
 'talk.religion.misc']
```

------

### âœ… æ€»ç»“ï¼š

è¿™æ®µä»£ç æ˜¯ä¸ºäº†ï¼š

1. **åŠ è½½å¹¶æŸ¥çœ‹ 20 ç±»æ–°é—»æ•°æ®é›†**ï¼›
2. **äº†è§£æ•°æ®ç»“æ„ï¼ˆæ–‡æœ¬å†…å®¹ + ç±»åˆ«ç¼–å·ï¼‰**ï¼›
3. **ä¸ºåç»­åšæ–‡æœ¬åˆ†ç±»æ‰“å¥½åŸºç¡€ï¼ˆå¦‚ TF-IDF ç‰¹å¾æå–ã€æ¨¡å‹è®­ç»ƒç­‰ï¼‰**ã€‚

è¯¥æ•°æ®é›†å¸¸ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰å®éªŒï¼Œå°¤å…¶é€‚åˆåšæ–‡æœ¬åˆ†ç±»ã€ä¸»é¢˜è¯†åˆ«ç­‰ä»»åŠ¡ã€‚



##### æ‚¨è¯´ï¼š

ä¸ºä»€ä¹ˆæ¯ç¯‡æ–°é—»è¦æœ‰ç±»åˆ«ç¼–å·



###### ChatGPT è¯´ï¼š

æ¯ç¯‡æ–°é—»éƒ½æœ‰**ç±»åˆ«ç¼–å·**ï¼Œæ˜¯å› ä¸ºï¼š

> ğŸ“Œ **æˆ‘ä»¬éœ€è¦â€œç›®æ ‡æ ‡ç­¾â€æ¥ç›‘ç£æ¨¡å‹è¿›è¡Œåˆ†ç±»å­¦ä¹ ã€‚**

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œç±»åˆ«ç¼–å·å°±æ˜¯æˆ‘ä»¬è¦è®©æ¨¡å‹å­¦ä¼šâ€œé¢„æµ‹â€çš„å¯¹è±¡ã€‚

------

### ğŸ” ç±»åˆ«ç¼–å·çš„ä½œç”¨ï¼šæ ‡ç­¾ï¼

æœºå™¨å­¦ä¹ ç‰¹åˆ«æ˜¯ç›‘ç£å­¦ä¹ ä¸­ï¼Œæ¯æ¡æ•°æ®å¿…é¡»åŒ…æ‹¬ï¼š

| æˆåˆ†      | å«ä¹‰                     | ä¸¾ä¾‹                                           |
| --------- | ------------------------ | ---------------------------------------------- |
| ç‰¹å¾ï¼ˆXï¼‰ | å¯ç”¨æ¥åˆ¤æ–­çš„ä¿¡æ¯ï¼ˆè¾“å…¥ï¼‰ | æ–°é—»å†…å®¹ï¼Œå¦‚â€œiPhone å‘å¸ƒæ–°æ¬¾â€¦â€                 |
| æ ‡ç­¾ï¼ˆyï¼‰ | æ­£ç¡®ç­”æ¡ˆï¼ˆè¾“å‡ºç›®æ ‡ï¼‰     | æ–°é—»ç±»åˆ«ç¼–å·ï¼Œä¾‹å¦‚ 3 = `comp.sys.mac.hardware` |



------

### âœ… ä¸ºä»€ä¹ˆè¦ç”¨ç¼–å·ï¼ˆæ•´æ•°ï¼‰è¡¨ç¤ºç±»åˆ«ï¼Ÿ

è™½ç„¶ç±»åˆ«æœ¬èº«æ˜¯å­—ç¬¦ä¸²ï¼ˆå¦‚ `sci.space`, `comp.graphics`ï¼‰ï¼Œä½†æˆ‘ä»¬ç”¨æ•°å­—æ¥è¡¨ç¤ºæœ‰å¾ˆå¤šä¼˜åŠ¿ï¼š

| å¥½å¤„             | è¯´æ˜                                                 |
| ---------------- | ---------------------------------------------------- |
| ğŸš€ å¿«é€Ÿå¤„ç†       | æ•°å­—æ›´é€‚åˆæ¨¡å‹å¤„ç†ï¼Œé¿å…å­—ç¬¦ä¸²å¸¦æ¥çš„é¢å¤–å¼€é”€         |
| ğŸ¤– æ¨¡å‹å…¼å®¹       | å¤§å¤šæ•°æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚ SVMã€é€»è¾‘å›å½’ï¼‰è¦æ±‚ç›®æ ‡æ˜¯æ•°å­— |
| âœ… æ˜“ç¼–ç          | æ–¹ä¾¿ç”¨ `y == 3` è¿™æ ·çš„æ–¹å¼ç­›é€‰æ•°æ®                   |
| ğŸ¯ å¯æ˜ å°„å›å­—ç¬¦ä¸² | å¯ä»¥é€šè¿‡ `target_names[y]` æŠŠç¼–å·è½¬å›ç±»åˆ«åç§°        |



------

### ğŸ§  ä¸¾ä¸ªä¾‹å­ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘æ–°é—»å†…å®¹: "NASA releases new satellite data..."
ç±»åˆ«ç¼–å·: 15
ç±»åˆ«åç§°: 'sci.space'
```

æ¨¡å‹ä¼šå­¦ä¹ ï¼šå‡¡æ˜¯å‡ºç°åƒ "NASA", "satellite", "space" è¿™æ ·çš„å…³é”®è¯ï¼Œå¤§æ¦‚ç‡ç±»åˆ«ç¼–å·å°±æ˜¯ 15ã€‚

------

### ğŸ” åˆ†ç±»ä»»åŠ¡å°±æ˜¯å­¦ä¼šï¼šæ–‡æœ¬ âœ ç±»åˆ«ç¼–å·

æ¨¡å‹è®­ç»ƒç›®æ ‡ï¼š

- è¾“å…¥ï¼šä¸€ç¯‡æ–°é—»æ–‡æœ¬ï¼ˆå­—ç¬¦ä¸²ï¼‰
- è¾“å‡ºï¼šä¸€ä¸ªæ•°å­—ï¼ˆç±»åˆ«ç¼–å·ï¼‰

æœ€ç»ˆæˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½**é¢„æµ‹å‡ºä»»æ„æ–°æ–‡ç« çš„æ­£ç¡®ç±»åˆ«ç¼–å·**ã€‚

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> ç±»åˆ«ç¼–å·æ˜¯æ¯ç¯‡æ–°é—»çš„â€œæ­£ç¡®æ ‡ç­¾â€ï¼Œæ˜¯æ–‡æœ¬åˆ†ç±»æ¨¡å‹å­¦ä¹ å’Œè¯„ä¼°çš„åŸºç¡€ã€‚
>  ç”¨æ•°å­—è€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¾¿äºæ¨¡å‹å¤„ç†ã€é«˜æ•ˆè®­ç»ƒï¼Œå¹¶å¯ä»¥è½»æ¾ä¸ç±»åˆ«åç§°ä¸€ä¸€å¯¹åº”ã€‚



##### æ‚¨è¯´ï¼š

print('-' * 50) print(len(news.data)) print('æ–°é—»æ‰€æœ‰çš„æ ‡ç­¾') print(news.target) print('-' * 50)ä»£ç ä½œç”¨  print(min(news.target), max(news.target))



###### ChatGPT è¯´ï¼š

ä¸‹é¢æˆ‘ä»¬æ¥é€è¡Œè§£é‡Šä½ è¿™æ®µä»£ç çš„ä½œç”¨ï¼Œå®ƒæ˜¯ç”¨æ¥**æŸ¥çœ‹20ç±»æ–°é—»æ•°æ®é›†ï¼ˆ`news`ï¼‰çš„åŸºæœ¬ä¿¡æ¯**çš„ï¼š

------

### ğŸ”¢ ä»£ç è§£æå¦‚ä¸‹ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- æ‰“å°ä¸€æ¡åˆ†éš”çº¿ï¼Œç”± 50 ä¸ª `-` ç»„æˆã€‚
- ä½œç”¨ï¼šè®©è¾“å‡ºç»“æœæ›´æ¸…æ™°ã€ç¾è§‚ï¼Œä¾¿äºé˜…è¯»ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(len(news.data))
```

- è¾“å‡ºï¼š**æ•°æ®é›†ä¸­æ–°é—»çš„æ€»æ•°**ã€‚
- `news.data` æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰æ–‡æœ¬æ–°é—»ã€‚
- `len(news.data)` è¡¨ç¤ºä¸€å…±æœ‰å¤šå°‘æ¡æ–°é—»æ ·æœ¬ã€‚

âœ… æ¯”å¦‚ï¼šè¾“å‡ºå¯èƒ½æ˜¯ `18846`ï¼Œè¡¨ç¤ºæ•°æ®é›†ä¸­æœ‰ **18846 æ¡æ–°é—»æ–‡ç« **ã€‚

------

```
pythonå¤åˆ¶ç¼–è¾‘print('æ–°é—»æ‰€æœ‰çš„æ ‡ç­¾')
print(news.target)
```

- `news.target` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ**æ¯ä¸€æ¡æ–°é—»å¯¹åº”ä¸€ä¸ªæ•°å­—æ ‡ç­¾ï¼ˆç±»åˆ«ç¼–å·ï¼‰**ã€‚
- æ‰“å°å‡ºæ¥çš„ç»“æœç±»ä¼¼è¿™æ ·ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
[10  3 17 ... 3  1  5]
```

è¿™è¯´æ˜ï¼š

- ç¬¬ 1 æ¡æ–°é—»æ˜¯ç¬¬ 10 ç±»
- ç¬¬ 2 æ¡æ˜¯ç¬¬ 3 ç±»
- ç¬¬ 3 æ¡æ˜¯ç¬¬ 17 ç±»ï¼Œâ€¦â€¦
- ä¸€å…±æœ‰ 20 ç±»ï¼Œç¼–å·ä» 0 åˆ° 19

------

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- åˆæ˜¯ä¸€æ¡åˆ†éš”çº¿ï¼Œç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(min(news.target), max(news.target))
```

- è¾“å‡ºï¼š`news.target` ä¸­çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ï¼š
  - æ‰€æœ‰ç±»åˆ«ç¼–å·ä¸­**æœ€å°çš„ç¼–å·**
  - æ‰€æœ‰ç±»åˆ«ç¼–å·ä¸­**æœ€å¤§çš„ç¼–å·**

âœ… åœ¨ 20 ç±»æ–°é—»ä¸­ï¼Œè¾“å‡ºé€šå¸¸æ˜¯ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
0 19
```

è¡¨ç¤ºï¼š

- ç±»åˆ«ç¼–å·ä» 0 å¼€å§‹
- åˆ° 19 ç»“æŸï¼Œä¸€å…± **20 ç±»æ–°é—»**

------

### ğŸ“¦ æ€»ç»“ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **æŸ¥çœ‹æ•°æ®é›†ä¸­æ–°é—»æ•°é‡ã€æ¯æ¡æ–°é—»çš„æ ‡ç­¾ã€ä»¥åŠæ ‡ç­¾ç¼–å·çš„èŒƒå›´ã€‚**

| ä»£ç                                  | ä½œç”¨è¯´æ˜                 |
| ------------------------------------ | ------------------------ |
| `len(news.data)`                     | è¾“å‡ºæ–°é—»æ¡æ•°             |
| `news.target`                        | æ‰€æœ‰æ–°é—»çš„æ ‡ç­¾ç¼–å·       |
| `min(news.target), max(news.target)` | æ ‡ç­¾ç¼–å·çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ |



è¿™äº›ä¿¡æ¯å¯¹äº†è§£æ•°æ®ç»“æ„éå¸¸é‡è¦ï¼Œæ˜¯**æ–‡æœ¬åˆ†ç±»ä»»åŠ¡çš„ç¬¬ä¸€æ­¥ï¼šæ•°æ®ç†è§£ä¸æ£€æŸ¥**ã€‚



##### æ‚¨è¯´ï¼š

house=fetch_california_housing(data_home='data') print("è·å–ç‰¹å¾å€¼") print(house.data[0])  #ç¬¬ä¸€ä¸ªæ ·æœ¬ç‰¹å¾å€¼ print('æ ·æœ¬çš„å½¢çŠ¶') print(house.data.shape)ä»£ç ä½œç”¨  print('-' * 50)



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç æ˜¯ç”¨æ¥**åŠ è½½åŠ å·æˆ¿ä»·æ•°æ®é›†ï¼ˆCalifornia Housingï¼‰å¹¶æŸ¥çœ‹éƒ¨åˆ†ç‰¹å¾ä¿¡æ¯**çš„ã€‚ä¸‹é¢é€è¡Œè§£é‡Šå…¶å…·ä½“ä½œç”¨ï¼š

------

### ğŸ” 1. åŠ è½½æ•°æ®é›†

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.datasets import fetch_california_housing

house = fetch_california_housing(data_home='data')
```

- `fetch_california_housing()`ï¼šä» sklearn ä¸‹è½½ **åŠ å·æˆ¿ä»·æ•°æ®é›†**ã€‚
- `data_home='data'`ï¼šæŠŠæ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„ `data/` ç›®å½•ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚
- è¿”å›å€¼ `house` æ˜¯ä¸€ä¸ª `Bunch` å¯¹è±¡ï¼Œç±»ä¼¼äºå­—å…¸ï¼ŒåŒ…å«å¦‚ä¸‹å†…å®¹ï¼š

| å­—æ®µ            | å«ä¹‰                                   |
| --------------- | -------------------------------------- |
| `data`          | æ ·æœ¬çš„ç‰¹å¾ï¼ˆäºŒç»´æ•°ç»„ï¼‰                 |
| `target`        | æ¯ä¸ªæ ·æœ¬çš„æˆ¿ä»·ï¼ˆç›®æ ‡å€¼ï¼Œå•ä½æ˜¯åƒç¾å…ƒï¼‰ |
| `feature_names` | æ¯ä¸ªç‰¹å¾çš„åç§°ï¼ˆå¦‚æ”¶å…¥ã€æˆ¿é—´æ•°ç­‰ï¼‰     |
| `DESCR`         | æ•°æ®é›†çš„æè¿°æ–‡æœ¬                       |



------

### ğŸ” 2. æ‰“å°ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼

```
pythonå¤åˆ¶ç¼–è¾‘print("è·å–ç‰¹å¾å€¼")
print(house.data[0])  # ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼
```

- è¾“å‡ºåŠ å·æˆ¿ä»·æ•°æ®é›†ä¸­ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ 8 ä¸ªç‰¹å¾å€¼ï¼Œä¾‹å¦‚ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
[8.3252e+00 4.1000e+01 6.9841e+00 1.0238e+00 3.2200e+02 2.5556e+00 3.7880e+01 9.4300e+00]
```

è¿™äº›ç‰¹å¾åŒ…æ‹¬ï¼š

1. äººå‡æ”¶å…¥
2. æˆ¿å±‹å¹´é¾„ä¸­ä½æ•°
3. å¹³å‡æˆ¿é—´æ•°
4. å¹³å‡å§å®¤æ•°
5. å±…æ°‘æ•°é‡
6. å¹³å‡å®¶åº­äººæ•°
7. ç»åº¦
8. çº¬åº¦

------

### ğŸ” 3. æ‰“å°æ•°æ®çš„å½¢çŠ¶

```
pythonå¤åˆ¶ç¼–è¾‘print('æ ·æœ¬çš„å½¢çŠ¶')
print(house.data.shape)
```

- æ‰“å°çš„æ˜¯ `data` çš„å½¢çŠ¶ï¼Œé€šå¸¸æ˜¯ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
(20640, 8)
```

æ„æ€æ˜¯ï¼šæ•°æ®é›†ä¸­ä¸€å…±æœ‰ **20640 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ 8 ä¸ªç‰¹å¾**ã€‚

------

### ğŸ” 4. åˆ†å‰²çº¿ï¼ˆç¾åŒ–è¾“å‡ºï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- æ‰“å°å‡ºä¸€æ¡ç”± 50 ä¸ª `-` ç»„æˆçš„åˆ†éš”çº¿ï¼Œç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ï¼Œæå‡å¯è¯»æ€§ã€‚

------

### âœ… æ€»ç»“

| ä»£ç                          | ä½œç”¨                                    |
| ---------------------------- | --------------------------------------- |
| `fetch_california_housing()` | ä¸‹è½½å¹¶åŠ è½½åŠ å·æˆ¿ä»·æ•°æ®                  |
| `house.data[0]`              | æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼                  |
| `house.data.shape`           | æŸ¥çœ‹æ‰€æœ‰æ•°æ®çš„è¡Œåˆ—æ•°ï¼ˆæ ·æœ¬æ•° Ã— ç‰¹å¾æ•°ï¼‰ |
| `print('-'*50)`              | è¾“å‡ºåˆ†éš”çº¿                              |



------

è¿™ä¸ªæ•°æ®é›†å¸¸ç”¨äº**å›å½’æ¨¡å‹è®­ç»ƒ**ï¼Œç›®æ ‡æ˜¯é¢„æµ‹æ¯ä¸ªåŒºåŸŸçš„å¹³å‡æˆ¿ä»·ã€‚



##### æ‚¨è¯´ï¼š

print("ç›®æ ‡å€¼") print(house.target) print('-' * 50) print(house.DESCR) print('-' * 50) print(house.feature_names) print('-' * 50)ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š**æŸ¥çœ‹ California Housingï¼ˆåŠ å·æˆ¿ä»·ï¼‰æ•°æ®é›†ä¸­çš„ç›®æ ‡å€¼ã€æ•°æ®æè¿°ã€ç‰¹å¾åç§°**ã€‚ä¸‹é¢æ˜¯é€è¡Œè®²è§£ï¼š

------

### 1ï¸âƒ£ æŸ¥çœ‹ç›®æ ‡å€¼ï¼ˆæˆ¿ä»·ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘print("ç›®æ ‡å€¼")
print(house.target)
```

- `house.target` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ¯æ¡æ ·æœ¬çš„**æˆ¿ä»·ä¸­ä½æ•°**ï¼ˆå•ä½æ˜¯ï¼šåƒç¾å…ƒï¼‰ã€‚

- ç¤ºä¾‹è¾“å‡ºï¼ˆå‰å‡ é¡¹ï¼‰ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  [4.526 3.585 3.521 ... 0.923 0.847 0.894]
  ```

- è¯´æ˜ï¼š

  - ç¬¬ 1 ä¸ªæ ·æœ¬çš„æˆ¿ä»·ä¸º $4.526 ä¸‡ç¾å…ƒ
  - ç¬¬ 2 ä¸ªæ ·æœ¬çš„æˆ¿ä»·ä¸º $3.585 ä¸‡ç¾å…ƒ
  - â€¦â€¦

âœ… è¿™æ˜¯è®­ç»ƒå›å½’æ¨¡å‹çš„ç›®æ ‡ï¼ˆy å€¼ï¼‰ã€‚

------

### 2ï¸âƒ£ æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- ç¾åŒ–è¾“å‡ºï¼Œè®©å†…å®¹ç»“æ„æ›´æ¸…æ™°ã€‚

------

### 3ï¸âƒ£ æŸ¥çœ‹æ•°æ®é›†çš„æ•´ä½“æè¿°

```
python


å¤åˆ¶ç¼–è¾‘
print(house.DESCR)
```

- `house.DESCR` æ˜¯å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ•´ä¸ªæ•°æ®é›†çš„è¯¦ç»†ä»‹ç»ï¼ŒåŒ…æ‹¬ï¼š
  - æ•°æ®æ¥æº
  - ç‰¹å¾è§£é‡Š
  - ç»Ÿè®¡ä¿¡æ¯
  - ä½¿ç”¨å»ºè®®

ğŸ“ ç¤ºä¾‹å†…å®¹ç‰‡æ®µï¼ˆå¯èƒ½å¾ˆé•¿ï¼‰ï¼š

```
mathematicaå¤åˆ¶ç¼–è¾‘.. _california_housing_dataset:

California Housing dataset
---------------------------

**Data Set Characteristics:**

    :Number of Instances: 20640
    :Number of Attributes: 8 numeric, predictive attributes and the target
    ...
```

âœ… è¿™ä¸ªå­—æ®µéå¸¸æœ‰ç”¨ï¼Œå¯ä»¥å¿«é€Ÿäº†è§£æ•°æ®èƒŒæ™¯å’Œç”¨é€”ã€‚

------

### 4ï¸âƒ£ å†æ¬¡æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

------

### 5ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰ç‰¹å¾åç§°

```
python


å¤åˆ¶ç¼–è¾‘
print(house.feature_names)
```

- è¾“å‡ºçš„æ˜¯åˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰ç‰¹å¾çš„åå­—ï¼ˆæ€»å…± 8 ä¸ªï¼‰ï¼Œä¾‹å¦‚ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
['MedInc', 'HouseAge', 'AveRooms', 'AveBedrms', 'Population', 'AveOccup', 'Latitude', 'Longitude']
```

ğŸ“Œ è§£é‡Šå¦‚ä¸‹ï¼š

| ç‰¹å¾å       | å«ä¹‰                     |
| ------------ | ------------------------ |
| `MedInc`     | åŒºåŸŸä½æˆ·çš„**æ”¶å…¥ä¸­ä½æ•°** |
| `HouseAge`   | æˆ¿å±‹çš„**å¹´é¾„ä¸­ä½æ•°**     |
| `AveRooms`   | æ¯æˆ·çš„**å¹³å‡æˆ¿é—´æ•°**     |
| `AveBedrms`  | æ¯æˆ·çš„**å¹³å‡å§å®¤æ•°**     |
| `Population` | åŒºåŸŸå†…**äººå£æ•°é‡**       |
| `AveOccup`   | å¹³å‡æ¯ä¸ªå®¶åº­çš„äººå£æ•°     |
| `Latitude`   | åŒºåŸŸçš„**çº¬åº¦**           |
| `Longitude`  | åŒºåŸŸçš„**ç»åº¦**           |



------

### âœ… æ€»ç»“åŠŸèƒ½è¡¨ï¼š

| ä»£ç                   | åŠŸèƒ½è¯´æ˜                   |
| --------------------- | -------------------------- |
| `house.target`        | æŸ¥çœ‹æ‰€æœ‰æ ·æœ¬å¯¹åº”çš„æˆ¿ä»·æ ‡ç­¾ |
| `house.DESCR`         | æŸ¥çœ‹æ•°æ®é›†è¯¦ç»†ä»‹ç»         |
| `house.feature_names` | æŸ¥çœ‹ 8 ä¸ªç‰¹å¾çš„åç§°åˆ—è¡¨    |
| `print('-'*50)`       | ç”¨äºåˆ†éš”è¾“å‡ºå†…å®¹ï¼Œä¾¿äºé˜…è¯» |



------

è¿™äº›ä»£ç å¸¸ç”¨äº **æ•°æ®åŠ è½½ä¸ç†è§£é˜¶æ®µ**ï¼Œå¸®åŠ©ä½ æŒæ¡æ¨¡å‹è®­ç»ƒæ‰€ä¾èµ–çš„æ•°æ®ç»“æ„å’Œå«ä¹‰ã€‚



##### æ‚¨è¯´ï¼š

\# Kè¿‘é‚» """ K-è¿‘é‚»é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½® :return:None """ # è¯»å–æ•°æ® data = pd.read_csv("./data/FBlocation/train.csv") print(data.head(10)) print(data.shape) print(data.info()) # å¤„ç†æ•°æ® # 1ã€ç¼©å°æ•°æ®,æŸ¥è¯¢æ•°æ®,ä¸ºäº†å‡å°‘è®¡ç®—æ—¶é—´ data = data.query("x > 1.0 &  x < 1.25 & y > 2.5 & y < 2.75")ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨ **Kè¿‘é‚»ç®—æ³•ï¼ˆKNNï¼‰é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½®**ï¼Œå¹¶åœ¨å¼€å§‹é˜¶æ®µå¯¹åŸå§‹æ•°æ®è¿›è¡Œè¯»å–å’Œç­›é€‰å¤„ç†ã€‚ä¸‹é¢æˆ‘é€è¡Œè§£é‡Šä»£ç çš„ä½œç”¨ï¼š

------

### ğŸ” ä¸€ã€Kè¿‘é‚»é¢„æµ‹ç­¾åˆ°ä½ç½®

```
pythonå¤åˆ¶ç¼–è¾‘"""
K-è¿‘é‚»é¢„æµ‹ç”¨æˆ·ç­¾åˆ°ä½ç½®
:return: None
"""
```

è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¯´æ˜æ•´ä¸ªä»£ç åŠŸèƒ½ï¼š

- åˆ©ç”¨ **K-è¿‘é‚»ç®—æ³•** å¯¹ **ç”¨æˆ·åœ¨æŸä¸ªä½ç½®ç­¾åˆ°çš„ä½ç½®ç‚¹** è¿›è¡Œé¢„æµ‹åˆ†ç±»ã€‚

------

### ğŸ“¥ äºŒã€è¯»å–åŸå§‹æ•°æ®

```
pythonå¤åˆ¶ç¼–è¾‘# è¯»å–æ•°æ®
data = pd.read_csv("./data/FBlocation/train.csv")
```

- ä½¿ç”¨ Pandas è¯»å–æœ¬åœ°è·¯å¾„ä¸‹çš„ `train.csv` æ•°æ®æ–‡ä»¶ï¼Œå­˜å…¥å˜é‡ `data`ã€‚
- æ•°æ®æ¥æºæ˜¯ Facebook Check-in çš„ä½ç½®ç­¾åˆ°æ•°æ®é›†ï¼ŒåŒ…å«ç”¨æˆ·åæ ‡å’Œç­¾åˆ°ä½ç½®ç­‰ä¿¡æ¯ã€‚

------

### ğŸ‘€ ä¸‰ã€æŸ¥çœ‹åŸºæœ¬ä¿¡æ¯

```
python


å¤åˆ¶ç¼–è¾‘
print(data.head(10))
```

- æ‰“å°å‰ 10 æ¡æ•°æ®ï¼ŒæŸ¥çœ‹åŸå§‹æ•°æ®æ ¼å¼ä¸å†…å®¹ã€‚

```
python


å¤åˆ¶ç¼–è¾‘
print(data.shape)
```

- è¾“å‡ºæ•°æ®çš„å½¢çŠ¶ï¼Œå¦‚ `(291180, 10)` è¡¨ç¤ºæœ‰ 291180 æ¡è®°å½•ï¼Œ10 ä¸ªå­—æ®µã€‚

```
python


å¤åˆ¶ç¼–è¾‘
print(data.info())
```

- æ‰“å°æ¯ä¸€åˆ—çš„ç±»å‹ã€æ˜¯å¦æœ‰ç¼ºå¤±å€¼ï¼Œç”¨äº**æ•°æ®åˆæ­¥äº†è§£å’Œæ¸…æ´—å‡†å¤‡**ã€‚

------

### ğŸ§¹ å››ã€æ•°æ®é¢„å¤„ç† - ç­›é€‰ä¸€ä¸ªå°åŒºåŸŸ

```
pythonå¤åˆ¶ç¼–è¾‘# 1ã€ç¼©å°æ•°æ®,æŸ¥è¯¢æ•°æ®,ä¸ºäº†å‡å°‘è®¡ç®—æ—¶é—´
data = data.query("x > 1.0 & x < 1.25 & y > 2.5 & y < 2.75")
```

- ä½¿ç”¨ Pandas çš„ `.query()` æ–¹æ³•ç­›é€‰å‡ºåœ°ç†ä½ç½®åœ¨æŒ‡å®šèŒƒå›´å†…çš„æ•°æ®ï¼š
  - `x` è¡¨ç¤ºæ¨ªåæ ‡ï¼ˆç»åº¦ç±»ä¼¼ï¼‰ï¼Œå–å€¼åœ¨ 1.0 åˆ° 1.25 ä¹‹é—´ï¼›
  - `y` è¡¨ç¤ºçºµåæ ‡ï¼ˆçº¬åº¦ç±»ä¼¼ï¼‰ï¼Œå–å€¼åœ¨ 2.5 åˆ° 2.75 ä¹‹é—´ã€‚
- åŸå› ï¼šè¯¥æ•°æ®é›†æœ¬èº«æ•°æ®é‡å¾ˆå¤§ï¼Œä¸ºäº†å‡å°‘åç»­è®­ç»ƒæ—¶é—´ï¼Œæˆ‘ä»¬**åªå–ä¸€ä¸ªå°èŒƒå›´çš„ç”¨æˆ·ä½ç½®åŒºåŸŸ**æ¥åšå®éªŒã€‚

ğŸ“Œ ç­›é€‰åçš„æ•°æ®å°±æ˜¯åªåŒ…å«é‚£ä¸€å°å—åŒºåŸŸä¸­çš„ç”¨æˆ·ç­¾åˆ°ç‚¹ï¼Œç”¨äºæœ¬åœ°èŒƒå›´å†…çš„åˆ†ç±»é¢„æµ‹ã€‚

------

### âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤       | ç›®çš„                             |
| ---------- | -------------------------------- |
| è¯»å–æ•°æ®é›† | åŠ è½½åŸå§‹ç­¾åˆ°æ•°æ®                 |
| æ‰“å°ä¿¡æ¯   | æŸ¥çœ‹æ•°æ®è§„æ¨¡ä¸ç»“æ„               |
| ç­›é€‰åæ ‡   | ä»…é€‰å–éƒ¨åˆ†åŒºåŸŸç”¨äºå®éªŒï¼Œæå‡æ•ˆç‡ |
| åç»­ç›®æ ‡   | ä½¿ç”¨ KNN æ¨¡å‹é¢„æµ‹ç­¾åˆ°ä½ç½®åˆ†ç±»    |



------

å¦‚æœä½ ç»§ç»­å¾€ä¸‹å†™ï¼Œä¼šä½¿ç”¨ `KNeighborsClassifier` å»ºæ¨¡ï¼Œç”¨ `x`, `y`, `accuracy`, `time` ç­‰ç‰¹å¾å»é¢„æµ‹ `place_id`ï¼ˆå³ç”¨æˆ·ç­¾åˆ°çš„çœŸå®ä½ç½®ï¼‰ã€‚éœ€è¦æ ‡å‡†åŒ–ã€åˆ’åˆ†è®­ç»ƒé›†ã€æ„å»ºæ¨¡å‹ç­‰åç»­æ­¥éª¤ã€‚éœ€è¦æˆ‘ç»§ç»­å¸®ä½ å†™åç»­ KNN æ¨¡å‹æµç¨‹å—ï¼Ÿ



##### æ‚¨è¯´ï¼š

è§£é‡Šä¸€ä¸‹ï¼š<class 'pandas.core.frame.DataFrame'> RangeIndex: 29118021 entries, 0 to 29118020 Data columns (total 6 columns): #   Column    Dtype   ---  ------    -----   0   row_id    int64   1   x         float64 2   y         float64 3   accuracy  int64   4   time      int64   5   place_id  int64   dtypes: float64(2), int64(4) memory usage: 1.3 GB None



###### ChatGPT è¯´ï¼š

ä½ æä¾›çš„æ˜¯ Pandas ä¸­ `DataFrame.info()` çš„è¾“å‡ºç»“æœï¼Œä¸‹é¢æ˜¯å¯¹å®ƒæ¯ä¸€éƒ¨åˆ†çš„è¯¦ç»†è§£é‡Šï¼š

------

### âœ… è¿™æ˜¯ DataFrame çš„åŸºæœ¬ä¿¡æ¯ï¼š

```
javascript


å¤åˆ¶ç¼–è¾‘
<class 'pandas.core.frame.DataFrame'>
```

ğŸ“Œ è¡¨ç¤ºï¼š`data` æ˜¯ä¸€ä¸ª Pandas çš„ **DataFrame** å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªäºŒç»´çš„è¡¨æ ¼ç»“æ„ï¼Œç±»ä¼¼ Excel è¡¨æ ¼æˆ– SQL è¡¨ã€‚

------

### âœ… è¡Œç´¢å¼•ä¿¡æ¯ï¼š

```
pgsql


å¤åˆ¶ç¼–è¾‘
RangeIndex: 29118021 entries, 0 to 29118020
```

- ä¸€å…±æœ‰ **29,118,021 æ¡æ•°æ®**ï¼ˆè¡Œï¼‰ï¼Œç¼–å·ä» 0 åˆ° 29118020ã€‚
- ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ `RangeIndex`ï¼Œå³æ•´æ•°é€’å¢çš„è¡Œç´¢å¼•ã€‚

------

### âœ… åˆ—ä¿¡æ¯ï¼ˆå­—æ®µ + æ•°æ®ç±»å‹ï¼‰ï¼š

```
goå¤åˆ¶ç¼–è¾‘Data columns (total 6 columns):
 #   Column    Dtype  
---  ------    -----  
 0   row_id    int64  
 1   x         float64
 2   y         float64
 3   accuracy  int64  
 4   time      int64  
 5   place_id  int64  
```

| åˆ—å· | åˆ—å       | ç±»å‹      | å«ä¹‰è¯´æ˜                               |
| ---- | ---------- | --------- | -------------------------------------- |
| 0    | `row_id`   | `int64`   | è¡Œç¼–å·æˆ–æ ·æœ¬ç¼–å·ï¼ˆå”¯ä¸€ IDï¼‰            |
| 1    | `x`        | `float64` | æ¨ªåæ ‡ï¼ˆåœ°ç†åæ ‡ä¸­çš„ xï¼Œå•ä½ç±»ä¼¼ç»åº¦ï¼‰ |
| 2    | `y`        | `float64` | çºµåæ ‡ï¼ˆåœ°ç†åæ ‡ä¸­çš„ yï¼Œå•ä½ç±»ä¼¼çº¬åº¦ï¼‰ |
| 3    | `accuracy` | `int64`   | GPS ç²¾åº¦ï¼ˆæ•°å€¼è¶Šå¤§ï¼Œå¯èƒ½è¶Šä¸ç²¾ç¡®ï¼‰     |
| 4    | `time`     | `int64`   | æ—¶é—´æˆ³ï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰                   |
| 5    | `place_id` | `int64`   | ç­¾åˆ°ä½ç½®ç¼–å·ï¼ˆé¢„æµ‹ç›®æ ‡æ ‡ç­¾ï¼‰           |



------

### âœ… æ¯ç§æ•°æ®ç±»å‹ç»Ÿè®¡ï¼š

```
css


å¤åˆ¶ç¼–è¾‘
dtypes: float64(2), int64(4)
```

- è¡¨ç¤ºä¸€å…± 6 åˆ—ä¸­ï¼š
  - æœ‰ **2 åˆ—** æ˜¯ `float64` ç±»å‹ï¼ˆå³å°æ•°ï¼Œç²¾åº¦é«˜ï¼‰ï¼›
  - æœ‰ **4 åˆ—** æ˜¯ `int64` ç±»å‹ï¼ˆæ•´æ•°ï¼‰ã€‚

------

### âœ… å†…å­˜ä½¿ç”¨æƒ…å†µï¼š

```
wasm


å¤åˆ¶ç¼–è¾‘
memory usage: 1.3 GB
```

- æ•´ä¸ª DataFrame å ç”¨äº†çº¦ **1.3GB å†…å­˜**ã€‚
- æ•°æ®é‡éå¸¸å¤§ï¼Œå»ºè®®åœ¨è®­ç»ƒå‰åšæ•°æ®ç­›é€‰æˆ–é™ç»´ï¼Œå¦åˆ™å®¹æ˜“å ç”¨å¤ªå¤šå†…å­˜ã€‚

------

### âœ… `None` æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™æ˜¯ `print(data.info())` çš„è¿”å›å€¼ï¼š

- `data.info()` æœ¬èº«æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼ˆè¿”å›çš„æ˜¯ `None`ï¼‰ï¼Œåªæ˜¯åœ¨è°ƒç”¨æ—¶è‡ªåŠ¨æ‰“å°ä¿¡æ¯ã€‚
- å¦‚æœä½ å†™ `print(data.info())`ï¼Œæœ€åå°±ä¼šæ˜¾ç¤º `None`ã€‚

------

### ğŸ“Œ æ€»ç»“ï¼š

è¿™æ®µè¾“å‡ºå‘Šè¯‰æˆ‘ä»¬ï¼š

| é¡¹ç›®                      | å†…å®¹è¯´æ˜                         |
| ------------------------- | -------------------------------- |
| æ•°æ®æ€»é‡                  | 29118021 è¡Œï¼Œ6 åˆ—                |
| åˆ—åä¸ç±»å‹                | åŒ…å«åæ ‡ã€æ—¶é—´ã€ç²¾åº¦ã€ä½ç½® ID ç­‰ |
| å†…å­˜å ç”¨                  | çº¦ 1.3GB                         |
| ç›®æ ‡å˜é‡                  | `place_id`ï¼Œè¡¨ç¤ºç”¨æˆ·ç­¾åˆ°çš„ä½ç½®   |
| `print(data.info())` è¿”å› | `None`ï¼Œä»…è´Ÿè´£æ‰“å°ç»“æ„ä¿¡æ¯       |



------

å¦‚ä½ ç»§ç»­åç»­åˆ†æï¼ˆå¦‚ç”¨ KNN åˆ†ç±» `place_id`ï¼‰ï¼Œå»ºè®®å¯¹ `x` å’Œ `y` åšåŒºåŸŸç­›é€‰ï¼Œæˆ–å¯¹ç‰¹å¾è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä»¥å‡å°‘è®¡ç®—å‹åŠ›ã€‚éœ€è¦æˆ‘å¸®ä½ å†™åç»­æ¨¡å‹æ­¥éª¤ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

data.shape data.describe()ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™ä¸¤è¡Œä»£ç ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data.shape
data.describe()
```

æ˜¯ç”¨äº **äº†è§£æ•°æ®è§„æ¨¡å’Œç»Ÿè®¡ç‰¹å¾** çš„ï¼Œä¸‹é¢é€ä¸€è§£é‡Šï¼š

------

### âœ… `data.shape`

ä½œç”¨ï¼šæŸ¥çœ‹ **æ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°ï¼ˆç»´åº¦ï¼‰**

ğŸ“Œ ç¤ºä¾‹è¾“å‡ºï¼š

```
python


å¤åˆ¶ç¼–è¾‘
(29118021, 6)
```

è¡¨ç¤ºï¼š

- æ•°æ®æœ‰ **29,118,021 è¡Œ**ï¼ˆå³ 2910 ä¸‡æ¡æ ·æœ¬ï¼‰
- æœ‰ **6 åˆ—**ï¼ˆç‰¹å¾å­—æ®µï¼‰

ğŸ’¡ ç­‰ä»·äºï¼š

```
python


å¤åˆ¶ç¼–è¾‘
print("æ•°æ®ç»´åº¦ï¼š", data.shape)
```

------

### âœ… `data.describe()`

ä½œç”¨ï¼šæŸ¥çœ‹æ•°å€¼åˆ—çš„ **æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯**ï¼Œå¸®åŠ©ä½ å¿«é€Ÿäº†è§£æ¯ä¸ªå­—æ®µçš„å–å€¼åˆ†å¸ƒã€‚

ğŸ“Œ ç¤ºä¾‹è¾“å‡ºï¼ˆç®€ç•¥ï¼‰ï¼š

|       | row_id   | x        | y        | accuracy | time     | place_id |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- |
| count | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 | 2.91e+07 |
| mean  | 1.46e+07 | 5.99     | 5.99     | 65.6     | 4.01e+06 | 8.77e+09 |
| std   | ...      | ...      | ...      | ...      | ...      | ...      |
| min   | 0        | 0.0      | 0.0      | 1        | 0        | 1        |
| 25%   | ...      | ...      | ...      | ...      | ...      | ...      |
| 50%   | ...      | ...      | ...      | ...      | ...      | ...      |
| 75%   | ...      | ...      | ...      | ...      | ...      | ...      |
| max   | 2.91e+07 | 10.0     | 10.0     | 1000+    | 7.86e+06 | 9.84e+09 |



è¿™äº›ç»Ÿè®¡é‡åˆ†åˆ«è¡¨ç¤ºï¼š

| æŒ‡æ ‡        | å«ä¹‰                           |
| ----------- | ------------------------------ |
| count       | éç©ºå€¼æ•°é‡ï¼ˆè¡Œæ•°ï¼‰             |
| mean        | å¹³å‡å€¼                         |
| std         | æ ‡å‡†å·®ï¼ˆè¡¡é‡æ³¢åŠ¨èŒƒå›´ï¼‰         |
| min/max     | æœ€å°å€¼ / æœ€å¤§å€¼                |
| 25%/50%/75% | åˆ†ä½æ•°ï¼ˆä¸­ä½æ•°ã€ä¸Šä¸‹å››åˆ†ä½ç‚¹ï¼‰ |



------

### âœ… æ€»ç»“å¯¹æ¯”ï¼š

| ä»£ç               | ä½œç”¨                         |
| ----------------- | ---------------------------- |
| `data.shape`      | æŸ¥çœ‹æ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°ï¼ˆç»´åº¦ï¼‰ |
| `data.describe()` | å¿«é€ŸæŸ¥çœ‹æ¯åˆ—æ•°å€¼çš„ç»Ÿè®¡åˆ†å¸ƒ   |



è¿™äº›æ˜¯æ•°æ®åˆ†æå’Œå»ºæ¨¡å‰çš„å¸¸è§„â€œæ•°æ®æ¢ç´¢â€æ­¥éª¤ï¼Œç”¨äºï¼š

- æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼‚å¸¸å€¼æˆ–æç«¯å€¼
- äº†è§£æ•°æ®å¤§è‡´åˆ†å¸ƒ
- ä¸ºæ¸…æ´—ã€å½’ä¸€åŒ–ç­‰é¢„å¤„ç†åšå¥½å‡†å¤‡

å¦‚æœä½ éœ€è¦æˆ‘å¸®ä½ åŸºäºè¿™äº›ä¿¡æ¯è¿›ä¸€æ­¥å»ºæ¨¡æˆ–å¯è§†åŒ–åˆ†æï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

ä»£ç ä½œç”¨# å¤„ç†æ—¶é—´çš„æ•°æ® time_value = pd.to_datetime(data['time'], unit='s') print(time_value.head(10))  #æœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

------

### åŠŸèƒ½è¯´æ˜ï¼š

**å°†æ•°æ®ä¸­çš„æ—¶é—´æˆ³ï¼ˆæ•´æ•°ï¼‰è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„æ—¥æœŸæ—¶é—´æ ¼å¼ï¼Œæ–¹ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚**

------

### é€è¡Œè§£é‡Šï¼š

```
python


å¤åˆ¶ç¼–è¾‘
time_value = pd.to_datetime(data['time'], unit='s')
```

- `data['time']` æ˜¯åŸå§‹æ•°æ®ä¸­è¡¨ç¤ºæ—¶é—´çš„åˆ—ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ•´æ•°æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯**ç§’**ï¼ˆä»æŸä¸ªèµ·å§‹æ—¶é—´ç®—èµ·ï¼‰ã€‚
- `pd.to_datetime(..., unit='s')`ï¼š
  - Pandas å‡½æ•°ï¼Œå°†æ•´æ•°æ—¶é—´æˆ³è½¬æ¢æˆ **æ—¶é—´æ—¥æœŸæ ¼å¼ï¼ˆdatetimeï¼‰**ã€‚
  - `unit='s'` è¡¨ç¤ºæ—¶é—´æˆ³å•ä½æ˜¯ç§’ï¼ˆä¹Ÿå¯ä»¥æ˜¯æ¯«ç§’`'ms'`ç­‰ï¼‰ã€‚
- ç»“æœ `time_value` æ˜¯ä¸€ä¸ª `DatetimeIndex` æˆ– `Series`ï¼Œæ¯æ¡è®°å½•å¯¹åº”ä¸€ä¸ªå…·ä½“çš„æ—¥æœŸå’Œæ—¶é—´ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
print(time_value.head(10))  # æœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·
```

- æ‰“å°å‰ 10 æ¡è½¬æ¢åçš„æ—¥æœŸæ—¶é—´ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ—¶é—´ä¿¡æ¯ã€‚
- æ³¨é‡Šä¸­æåˆ°â€œæœ€å¤§æ—¶é—´æ˜¯1æœˆ10å·â€ï¼Œæ„å‘³ç€æ•°æ®æ—¶é—´èŒƒå›´çº¦åœ¨ 1 æœˆ 1 æ—¥åˆ° 1 æœˆ 10 æ—¥ä¹‹é—´ã€‚

------

### ä¸¾ä¾‹ï¼š

å‡è®¾ `data['time']` æ˜¯ç±»ä¼¼ `3600`ã€`7200` è¿™æ ·çš„æ•´æ•°ï¼ˆç§’æ•°ï¼‰ï¼Œè½¬æ¢åå°±æ˜¯ï¼š

```
python-replå¤åˆ¶ç¼–è¾‘2025-01-01 01:00:00
2025-01-01 02:00:00
...
```

------

### æ€»ç»“ï¼š

è¿™æ®µä»£ç æŠŠ**åŸå§‹çš„ç§’çº§æ—¶é—´æˆ³**è½¬æˆäº†**äººç±»å¯è¯»çš„æ—¥æœŸæ—¶é—´æ ¼å¼**ï¼Œæ–¹ä¾¿åšæ—¶é—´åºåˆ—åˆ†æã€æ—¶é—´ç‰¹å¾æå–ï¼ˆå¦‚æå–å°æ—¶ã€æ˜ŸæœŸå‡ ç­‰ï¼‰ã€‚



3/3





##### æ‚¨è¯´ï¼š

\# æŠŠæ—¥æœŸæ ¼å¼è½¬æ¢æˆ å­—å…¸æ ¼å¼ï¼ŒæŠŠå¹´ï¼Œæœˆï¼Œæ—¥ï¼Œæ—¶ï¼Œåˆ†ï¼Œç§’è½¬æ¢ä¸ºå­—å…¸æ ¼å¼ï¼Œ time_value = pd.DatetimeIndex(time_value) # print('-' * 50) print(time_value[0:10])ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **å°†æ—¶é—´åˆ—ï¼ˆæ—¶é—´æˆ³è½¬ä¸ºçš„ datetime æ ¼å¼ï¼‰è½¬æ¢ä¸ºä¸€ä¸ªç»“æ„åŒ–çš„ `DatetimeIndex` å¯¹è±¡ï¼Œä»¥ä¾¿ä»ä¸­æå–å¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†ã€ç§’ç­‰å­—æ®µç”¨äºç‰¹å¾å·¥ç¨‹ã€‚**

------

### é€è¡Œè§£é‡Šå¦‚ä¸‹ï¼š

------

```
python


å¤åˆ¶ç¼–è¾‘
time_value = pd.DatetimeIndex(time_value)
```

- `pd.DatetimeIndex(...)` æ˜¯ Pandas ä¸­ç”¨äºå°†ä¸€ç»„ datetime æ•°æ®å°è£…ä¸ºä¸€ä¸ª **ç´¢å¼•å¯¹è±¡**ï¼Œå®ƒå…·å¤‡å¾ˆå¤šç»“æ„åŒ–çš„æ—¶é—´å±æ€§ã€‚
- åŸå§‹ `time_value` æ˜¯ä¸€ä¸ª `Series`ï¼ˆä¸€åˆ— datetime æ ¼å¼çš„æ—¶é—´ï¼‰ï¼›
- è½¬æ¢æˆ `DatetimeIndex` åï¼Œå¯ä»¥ç›´æ¥è®¿é—®å¦‚ä¸‹å­—æ®µï¼š
  - `time_value.year` å¹´
  - `time_value.month` æœˆ
  - `time_value.day` æ—¥
  - `time_value.hour` å°æ—¶
  - `time_value.minute` åˆ†é’Ÿ
  - `time_value.second` ç§’
  - `time_value.weekday` æ˜ŸæœŸå‡ ï¼ˆ0=å‘¨ä¸€ï¼Œ6=å‘¨æ—¥ï¼‰
  - `time_value.dayofyear` ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©

ğŸ“Œ âœ… è¿™ä¸ªè½¬æ¢çš„ä¸»è¦ç›®çš„ï¼š**ä¾¿äºæå–æ—¶é—´ç›¸å…³ç‰¹å¾**ï¼Œä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹æä¾›æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

------

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(time_value[0:10])
```

- æ‰“å° 50 ä¸ª `-` ä½œä¸ºåˆ†éš”çº¿ï¼Œç¾åŒ–è¾“å‡ºï¼›
- æ‰“å°è½¬æ¢åçš„å‰ 10 ä¸ª `DatetimeIndex` æ—¶é—´å€¼ï¼Œç¤ºä¾‹è¾“å‡ºå¦‚ä¸‹ï¼š

```
python-replå¤åˆ¶ç¼–è¾‘2025-01-01 00:00:00
2025-01-01 00:01:00
...
```

------

### ğŸ” ç¤ºä¾‹ï¼šä» `DatetimeIndex` ä¸­æå–å­—æ®µ

ä½ æ¥ä¸‹æ¥å¯ä»¥å†™ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday
```

ç”¨äºæ„é€ æ–°ç‰¹å¾ï¼Œæ¯”å¦‚ï¼š

- ç”¨æˆ·ç­¾åˆ°çš„æ—¶é—´æ˜¯ç™½å¤©è¿˜æ˜¯å¤œæ™šï¼Ÿ
- æ˜¯å·¥ä½œæ—¥è¿˜æ˜¯å‘¨æœ«ï¼Ÿ
- æ˜¯å“ªä¸ªå°æ—¶ç”¨æˆ·æœ€æ´»è·ƒï¼Ÿ

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> è¿™æ®µä»£ç æŠŠæ—¶é—´åˆ—å˜æˆç»“æ„åŒ–æ—¶é—´ç´¢å¼•ï¼ˆ`DatetimeIndex`ï¼‰ï¼Œä¸ºåç»­**æå–å¹´/æœˆ/æ—¥/å°æ—¶ç­‰æ—¶é—´ç‰¹å¾**åšå¥½å‡†å¤‡ï¼Œæ˜¯å…¸å‹çš„æ—¶é—´ç‰¹å¾å·¥ç¨‹æ­¥éª¤ä¹‹ä¸€ã€‚



##### æ‚¨è¯´ï¼š

ä»£ç ä½œç”¨ï¼šprint('-' * 50) # æ„é€ ä¸€äº›ç‰¹å¾ï¼Œæ‰§è¡Œçš„è­¦å‘Šæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ“ä½œæ˜¯å¤åˆ¶ï¼Œlocæ˜¯ç›´æ¥æ”¾å…¥ print(type(data)) # data['day'] = time_value.day # data['hour'] = time_value.hour # data['weekday'] = time_value.weekday #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤© data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„ data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  # # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ data = data.drop(['time'], axis=1) print('-' * 50) data.head()



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å¯¹åŸå§‹ç­¾åˆ°æ•°æ®è¿›è¡Œ**æ—¶é—´ç‰¹å¾å·¥ç¨‹å¤„ç†**ï¼Œæå–å¯¹ç”¨æˆ·ç­¾åˆ°è¡Œä¸ºæœ‰æ˜¾è‘—å½±å“çš„æ—¶é—´ç»´åº¦ï¼ˆå¦‚ï¼š**æ—¥ã€å°æ—¶ã€æ˜ŸæœŸå‡ **ï¼‰ï¼Œå¹¶åˆ é™¤åŸå§‹çš„æ—¶é—´æˆ³å­—æ®µï¼Œæ•´ç†ä¸ºé€‚åˆç”¨äºå»ºæ¨¡çš„æ•°æ®æ ¼å¼ã€‚

ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š

------

### ğŸ”¹ æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

- ç”¨äºç¾åŒ–è¾“å‡ºï¼Œåˆ†éš”å†…å®¹ã€‚

------

### ğŸ” æ‰“å° DataFrame ç±»å‹

```
python


å¤åˆ¶ç¼–è¾‘
print(type(data))
```

- è¾“å‡º `data` çš„æ•°æ®ç±»å‹ï¼Œåº”è¯¥æ˜¯ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  <class 'pandas.core.frame.DataFrame'>
  ```

- è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Pandas è¡¨æ ¼ç»“æ„å¯¹è±¡ã€‚

------

### ğŸ”§ æ’å…¥æ–°ç‰¹å¾åˆ—ï¼ˆä»æ—¶é—´ä¸­æå–ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'day', time_value.day)
```

- `data.shape[1]` è¡¨ç¤ºå½“å‰åˆ—çš„æ€»æ•°ï¼ˆåœ¨æœ€åä¸€åˆ—åæ’å…¥ï¼‰ï¼›
- `'day'` è¡¨ç¤ºç­¾åˆ°çš„â€œå‡ å·â€ï¼ˆ1å·ã€2å·â€¦â€¦ï¼‰ï¼›
- `time_value.day` æ˜¯ä» `DatetimeIndex` ä¸­æå–çš„â€œå¤©â€å­—æ®µã€‚

ğŸ“Œ æ’å…¥ä½ç½®å¯ä»¥æ˜¯ä»»æ„åˆ—ç´¢å¼•ï¼Œè¿™é‡Œç”¨ `data.shape[1]` ä»£è¡¨ **æ’å…¥åˆ°æœ€åä¸€åˆ—**ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'hour', time_value.hour)
```

- æ’å…¥ç­¾åˆ°çš„â€œå°æ—¶â€å­—æ®µï¼ˆ0~23ï¼‰ï¼Œè¡¨ç¤ºç”¨æˆ·åœ¨å“ªä¸ªæ—¶æ®µç­¾åˆ°ã€‚
- è¿™ä¸ªå¯¹ç”¨æˆ·è¡Œä¸ºéå¸¸å…³é”®ï¼š
  - æ¯”å¦‚æ—©ä¸Šå¸¸ç­¾åˆ°åœ°é“ç«™ã€ä¸­åˆç­¾åˆ°é¤å…ã€æ™šä¸Šç­¾åˆ°å½±é™¢ç­‰ã€‚

------

```
python


å¤åˆ¶ç¼–è¾‘
data.insert(data.shape[1], 'weekday', time_value.weekday)
```

- æ’å…¥ç­¾åˆ°çš„â€œæ˜ŸæœŸå‡ â€å­—æ®µï¼ˆ0=å‘¨ä¸€ï¼Œ6=å‘¨æ—¥ï¼‰ã€‚
- è¿™ç”¨äºåŒºåˆ†å·¥ä½œæ—¥å’Œå‘¨æœ«ç”¨æˆ·çš„è¡Œä¸ºå·®å¼‚ã€‚
  - ä¾‹å¦‚å·¥ä½œæ—¥é€šå‹¤ç­¾åˆ° vs å‘¨æœ«å¨±ä¹åœºæ‰€ç­¾åˆ°ã€‚

------

### ğŸ—‘ï¸ åˆ é™¤åŸå§‹æ—¶é—´æˆ³å­—æ®µ

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1)
```

- åˆ é™¤åŸå§‹ `time` åˆ—ï¼ŒåŸå› æ˜¯ï¼š
  - å®ƒæ˜¯åŸå§‹çš„â€œç§’â€çº§æ•´æ•°ï¼Œä¸å¯è¯»ï¼›
  - æˆ‘ä»¬å·²ç»ä»å®ƒä¸­æå–å‡º `day`, `hour`, `weekday` è¿™äº›æ›´æœ‰ç”¨çš„ç‰¹å¾ï¼›
- `axis=1` è¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ã€‚

------

### ğŸ”š æ‰“å°åˆ†éš”çº¿

```
python


å¤åˆ¶ç¼–è¾‘
print('-' * 50)
```

------

### ğŸ‘€ æŸ¥çœ‹æ•°æ®å‰å‡ è¡Œ

```
python


å¤åˆ¶ç¼–è¾‘
data.head()
```

- æŸ¥çœ‹æ›´æ–°åçš„ DataFrame å‰ 5 è¡Œï¼Œç”¨äºç¡®è®¤ï¼š
  - æ–°å¢çš„æ—¶é—´ç‰¹å¾æ˜¯å¦æ’å…¥æˆåŠŸï¼›
  - åŸæ¥çš„ `time` å­—æ®µæ˜¯å¦åˆ é™¤ã€‚

------

### âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤         | è¯´æ˜                                        |
| ------------ | ------------------------------------------- |
| æå–æ—¶é—´å­—æ®µ | ä»åŸå§‹æ—¶é—´æˆ³ä¸­æå– `day`, `hour`, `weekday` |
| æ’å…¥æ–°åˆ—     | æŠŠè¿™äº›æ–°æ—¶é—´ç‰¹å¾æ·»åŠ åˆ°æ•°æ®çš„æœ«å°¾            |
| åˆ é™¤åŸæ—¶é—´æˆ³ | ç§»é™¤ä¸å†éœ€è¦çš„ `time` å­—æ®µ                  |
| å‡†å¤‡å»ºæ¨¡     | å¾—åˆ°æ›´æœ‰è§£é‡ŠåŠ›çš„æ—¶é—´ç‰¹å¾ï¼Œå¢å¼ºæ¨¡å‹æ€§èƒ½      |



------

è¿™äº›æ—¶é—´ç‰¹å¾åœ¨**ç”¨æˆ·è¡Œä¸ºé¢„æµ‹ã€ä½ç½®æ‰“å¡å»ºæ¨¡ã€KNNåˆ†ç±»ç­‰ä»»åŠ¡ä¸­éå¸¸å…³é”®**ï¼Œå› ä¸ºæ—¶é—´ä¸äººçš„æ´»åŠ¨é«˜åº¦ç›¸å…³ã€‚ä½ ç°åœ¨çš„åšæ³•æ˜¯æ ‡å‡†ã€åˆç†çš„â€œç‰¹å¾å·¥ç¨‹â€æ­¥éª¤ã€‚éœ€è¦çš„è¯ï¼Œæˆ‘è¿˜å¯ä»¥å¸®ä½ ç»§ç»­åšæ•°æ®æ ‡å‡†åŒ–ã€è®­ç»ƒæµ‹è¯•é›†åˆ’åˆ†å’Œ KNN å»ºæ¨¡ã€‚



##### æ‚¨è¯´ï¼š

print('-' * 50) # æ„é€ ä¸€äº›ç‰¹å¾ï¼Œæ‰§è¡Œçš„è­¦å‘Šæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ“ä½œæ˜¯å¤åˆ¶ï¼Œlocæ˜¯ç›´æ¥æ”¾å…¥ print(type(data)) data['day'] = time_value.day data['hour'] = time_value.hour data['weekday'] = time_value.weekday #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤© data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„ data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  # # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ data = data.drop(['time'], axis=1) print('-' * 50) data.head()æœ‰å¦‚ä¸‹é—®é¢˜ï¼šValueError                                Traceback (most recent call last) Cell In[23], line 8      6 data['weekday'] = time_value.weekday      7 #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç† ----> 8 data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤©      9 data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„     10 data.insert(data.shape[1], 'weekday', time_value.weekday) #0ä»£è¡¨å‘¨ä¸€ï¼Œ6ä»£è¡¨å‘¨æ—¥ï¼Œæ˜ŸæœŸå‡  File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py:5165, in DataFrame.insert(self, loc, column, value, allow_duplicates)   5159     raise ValueError(   5160         "Cannot specify 'allow_duplicates=True' when "   5161         "'self.flags.allows_duplicate_labels' is False."   5162     )   5163 if not allow_duplicates and column in self.columns:   5164     # Should this be a different kind of error?? -> 5165     raise ValueError(f"cannot insert {column}, already exists")   5166 if not is_integer(loc):   5167     raise TypeError("loc must be int") ValueError: cannot insert day, already exists



###### ChatGPT è¯´ï¼š

ä½ é‡åˆ°çš„æŠ¥é”™æ˜¯ï¼š

```
sql


å¤åˆ¶ç¼–è¾‘
ValueError: cannot insert day, already exists
```

### ğŸ§¨ æŠ¥é”™åŸå› ï¼š

ä½ å·²ç»åœ¨å‰é¢ç”¨ä»¥ä¸‹ä»£ç ç»™ `data` æ·»åŠ äº† `'day'`ã€`'hour'` å’Œ `'weekday'` ä¸‰åˆ—ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday
```

ç„¶åä½ åˆé‡å¤ç”¨ `data.insert(...)` æƒ³å†æ’å…¥ä¸€éè¿™ä¸‰åˆ—ï¼Œä½†è¿™æ—¶å®ƒä»¬ **å·²ç»å­˜åœ¨äº†**ï¼Œæ‰€ä»¥ Pandas æŠ¥é”™è¯´ï¼š

> ä¸èƒ½æ’å…¥åˆ— `'day'`ï¼Œå› ä¸ºå®ƒå·²ç»å­˜åœ¨äº DataFrame ä¸­ã€‚

------

### âœ… æ­£ç¡®åšæ³•ï¼š**åªé€‰æ‹©ä¸€ç§æ–¹å¼æ·»åŠ åˆ—ï¼Œä¸è¦é‡å¤æ·»åŠ ï¼**

#### âœ… âœ… æ¨èæ–¹å¼ï¼ˆç®€å•ç›´è§‚ï¼‰â€”â€”ç›´æ¥èµ‹å€¼æ³•ï¼ˆä¸å†ç”¨ `insert()`ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(type(data))

# ç›´æ¥é€šè¿‡èµ‹å€¼æ·»åŠ æ–°åˆ—ï¼ˆæ¨èï¼‰
data['day'] = time_value.day
data['hour'] = time_value.hour
data['weekday'] = time_value.weekday

# åˆ é™¤åŸå§‹çš„æ—¶é—´æˆ³åˆ—
data = data.drop(['time'], axis=1)

print('-' * 50)
data.head()
```

------

### ğŸ“ å¯¹æ¯”ä¸¤ç§æ–¹å¼ï¼š

| æ–¹æ³•         | å†™æ³•                           | æ˜¯å¦å…è®¸è¦†ç›–åŒååˆ—       |
| ------------ | ------------------------------ | ------------------------ |
| âœ… ç›´æ¥èµ‹å€¼æ³• | `data['day'] = ...`            | å…è®¸ï¼Œæ¨èä½¿ç”¨           |
| âŒ `insert()` | `data.insert(..., 'day', ...)` | ä¸å…è®¸ï¼Œè‹¥åˆ—å·²å­˜åœ¨ä¼šæŠ¥é”™ |



------

### ğŸ› ï¸ å¦‚æœä½ åšæŒä½¿ç”¨ `insert()`ï¼Œå¯ä»¥å…ˆåˆ¤æ–­åˆ—æ˜¯å¦å­˜åœ¨ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘if 'day' not in data.columns:
    data.insert(data.shape[1], 'day', time_value.day)
```

ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œ**æ¨èç”¨ç®€å•èµ‹å€¼æ³•**ï¼Œæ›´çµæ´»æ›´å®‰å…¨ã€‚

------

### âœ… æ€»ç»“ï¼š

ä½ æŠ¥é”™çš„åŸå› æ˜¯é‡å¤æ’å…¥å·²å­˜åœ¨çš„åˆ—ï¼ˆ`'day'`ã€`'hour'`ã€`'weekday'`ï¼‰ã€‚
 è¯·åˆ æ‰ `insert(...)` çš„éƒ¨åˆ†ï¼Œä¿ç•™å‰é¢çš„èµ‹å€¼è¯­å¥å³å¯ï¼Œç¨‹åºå°±ä¸ä¼šæŠ¥é”™äº† âœ…ã€‚éœ€è¦æˆ‘å¸®ä½ æ•´ç†æˆå®Œæ•´æ— è¯¯çš„ä»£ç ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

KeyError                                  Traceback (most recent call last) Cell In[24], line 14      6 data['weekday'] = time_value.weekday      7 #æ—¥æœŸï¼Œæ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå°æ—¶å¯¹äºä¸ªäººè¡Œä¸ºçš„å½±å“æ˜¯è¾ƒå¤§çš„(ä¾‹å¦‚åƒé¥­æ—¶é—´å»é¥­åº—ï¼Œçœ‹ç”µå½±æ—¶é—´å»ç”µå½±é™¢ç­‰),æ‰€ä»¥æ‰åšä¸‹é¢çš„å¤„ç†      8 # data.insert(data.shape[1], 'day', time_value.day) #data.shape[1]æ˜¯ä»£è¡¨æ’å…¥åˆ°æœ€åçš„æ„æ€,ä¸€ä¸ªæœˆçš„å“ªä¸€å¤©      9 # data.insert(data.shape[1], 'hour', time_value.hour)#æ˜¯å¦å»ä¸€ä¸ªåœ°æ–¹æ‰“å¡ï¼Œæ—©ä¸Šï¼Œä¸­åˆï¼Œæ™šä¸Šæ˜¯æœ‰å½±å“çš„   (...)     12 #     13 # æŠŠæ—¶é—´æˆ³ç‰¹å¾åˆ é™¤ ---> 14 data = data.drop(['time'], axis=1)     15 print('-' * 50)     16 data.head() File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py:5588, in DataFrame.drop(self, labels, axis, index, columns, level, inplace, errors)   5440 def drop(   5441     self,   5442     labels: IndexLabel | None = None,   (...)   5449     errors: IgnoreRaise = "raise",   5450 ) -> DataFrame | None:   5451     """   5452     Drop specified labels from rows or columns.   5453    (...)   5586             weight  1.0     0.8   5587     """ -> 5588     return super().drop(   5589         labels=labels,   5590         axis=axis,   5591         index=index,   5592         columns=columns,   5593         level=level,   5594         inplace=inplace,   5595         errors=errors,   5596     ) File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py:4807, in NDFrame.drop(self, labels, axis, index, columns, level, inplace, errors)   4805 for axis, labels in axes.items():   4806     if labels is not None: -> 4807         obj = obj._drop_axis(labels, axis, level=level, errors=errors)   4809 if inplace:   4810     self._update_inplace(obj) File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py:4849, in NDFrame._drop_axis(self, labels, axis, level, errors, only_slice)   4847         new_axis = axis.drop(labels, level=level, errors=errors)   4848     else: -> 4849         new_axis = axis.drop(labels, errors=errors)   4850     indexer = axis.get_indexer(new_axis)   4852 # Case for non-unique axis   4853 else: File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\i



###### ChatGPT è¯´ï¼š

ä½ ç°åœ¨é‡åˆ°çš„é”™è¯¯æ˜¯ï¼š

```
vbnet


å¤åˆ¶ç¼–è¾‘
KeyError: "['time'] not found in axis"
```

------

### â— é”™è¯¯åŸå› ï¼š

ä½ å†™äº†è¿™è¡Œä»£ç ï¼š

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1)
```

æ„æ€æ˜¯ä»åˆ—ä¸­åˆ é™¤ `'time'` å­—æ®µã€‚

ä½†æŠ¥é”™è¯´æ˜ï¼š

> `DataFrame` ä¸­ **å·²ç»æ²¡æœ‰åä¸º `'time'` çš„åˆ—äº†**ï¼Œæ‰€ä»¥ Pandas æŠ¥é”™è¯´æ‰¾ä¸åˆ°è¯¥åˆ—ã€‚

------

### âœ… è§£å†³æ–¹æ³•ï¼š

åœ¨è°ƒç”¨ `.drop()` åˆ é™¤åˆ—ä¹‹å‰ï¼Œ**å…ˆç¡®è®¤è¿™ä¸ªåˆ—æ˜¯å¦å­˜åœ¨**ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨æ–¹å¼ï¼š

------

#### âœ… æ–¹æ³• 1ï¼šä½¿ç”¨ `errors='ignore'`ï¼Œå³ä½¿åˆ—ä¸å­˜åœ¨ä¹Ÿä¸æŠ¥é”™ï¼ˆæœ€æ¨èï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
data = data.drop(['time'], axis=1, errors='ignore')
```

è¿™æ ·å³ä½¿ `'time'` ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä»£ç æ›´å¥å£®ã€‚

------

#### âœ… æ–¹æ³• 2ï¼šå…ˆåˆ¤æ–­åˆ—åæ˜¯å¦åœ¨ DataFrame ä¸­å†åˆ 

```
pythonå¤åˆ¶ç¼–è¾‘if 'time' in data.columns:
    data = data.drop(['time'], axis=1)
```

------

### ğŸ“Œ é™„å¸¦è¯´æ˜ï¼šä½ å‰é¢å¯èƒ½å·²ç»æ‰§è¡Œè¿‡ä¸€æ¬¡ `.drop(['time'])`ï¼Œæˆ–è€…å·²ç»åœ¨å…¶ä»–å•å…ƒæ ¼ä¸­åˆ è¿‡è¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥å†æ¬¡åˆ å°±æŠ¥é”™äº†ã€‚

------

### âœ… æœ€ç»ˆæ¨èä»£ç ï¼ˆç®€æ´å®‰å…¨ï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘# åˆ é™¤æ—¶é—´åˆ—ï¼Œå¦‚æœå·²ä¸å­˜åœ¨ä¹Ÿä¸æŠ¥é”™
data = data.drop(['time'], axis=1, errors='ignore')
```

------

éœ€è¦æˆ‘å¸®ä½ æ•´ç†æˆå®Œæ•´ä¸æŠ¥é”™çš„æ¸…æ´—ä¸ç‰¹å¾æå–ä»£ç å—ï¼Ÿå¯ä»¥ä¸€é”®è¿è¡Œä¸å‡ºé”™çš„ç‰ˆæœ¬ ğŸ‘ã€‚







data = data[data['place_id'].isin(tf.place_id)] data.shapeä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™ä¸¤è¡Œä»£ç çš„ä½œç”¨æ˜¯ï¼š**æŒ‰ç…§æŒ‡å®šçš„ place_id åˆ—è¡¨ï¼Œå¯¹åŸå§‹æ•°æ® `data` è¿›è¡Œè¿‡æ»¤ï¼Œåªä¿ç•™æ„Ÿå…´è¶£çš„ç­¾åˆ°ä½ç½®æ ·æœ¬**ã€‚è¿™æ˜¯å¸¸è§çš„åˆ†ç±»å»ºæ¨¡å‰çš„â€œç±»åˆ«ç­›é€‰â€æ­¥éª¤ã€‚

------

### ğŸ” é€è¡Œè§£é‡Šå¦‚ä¸‹ï¼š

------

### âœ… ç¬¬ 1 è¡Œï¼š

```
python


å¤åˆ¶ç¼–è¾‘
data = data[data['place_id'].isin(tf.place_id)]
```

#### ä½œç”¨ï¼š

- `data['place_id']`ï¼šè¡¨ç¤ºåŸå§‹æ•°æ®ä¸­æ¯æ¡è®°å½•çš„ç­¾åˆ°ä½ç½®ç¼–å·ï¼ˆåˆ†ç±»ç›®æ ‡æ ‡ç­¾ï¼‰ã€‚
- `tf.place_id`ï¼šæ˜¯ä¸€ä¸ªåˆ—è¡¨æˆ– Seriesï¼Œè¡¨ç¤ºä½ å¸Œæœ›ä¿ç•™çš„éƒ¨åˆ† **â€œçƒ­é—¨ä½ç½®â€** æˆ– **â€œæŒ‡å®šåœ°ç‚¹â€**ï¼Œå¯èƒ½æ˜¯å‰é¢ç»Ÿè®¡å‡ºçš„å‡ºç°é¢‘ç‡è¾ƒé«˜çš„åœ°ç‚¹ IDã€‚
- `.isin(...)`ï¼šæ£€æŸ¥ `data['place_id']` ä¸­çš„å€¼æ˜¯å¦å­˜åœ¨äº `tf.place_id` ä¹‹ä¸­ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”åºåˆ—ã€‚
- å¤–å±‚ `data[...]`ï¼šæ ¹æ®å¸ƒå°”æ¡ä»¶è¿›è¡Œè¡Œç­›é€‰ã€‚

ğŸ“Œ æœ€ç»ˆç»“æœï¼šä¿ç•™çš„æ˜¯é‚£äº› place_id **åœ¨ tf.place_id åˆ—è¡¨ä¸­çš„æ ·æœ¬**ã€‚

#### ç¤ºä¾‹ç”¨é€”ï¼š

æ¯”å¦‚ä½ å‰é¢é€šè¿‡å¦‚ä¸‹ä»£ç æ‰¾å‡ºäº†çƒ­é—¨ç­¾åˆ°ç‚¹ï¼ˆå‡ºç°æ¬¡æ•° > Nï¼‰ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘place_counts = data['place_id'].value_counts()
tf = place_counts[place_counts > 3].to_frame().reset_index()
tf.columns = ['place_id', 'count']
```

é‚£ `tf.place_id` å°±æ˜¯ä¸€ç»„é«˜é¢‘åœ°ç‚¹çš„ IDã€‚

------

### âœ… ç¬¬ 2 è¡Œï¼š

```
python


å¤åˆ¶ç¼–è¾‘
data.shape
```

#### ä½œç”¨ï¼š

- æŸ¥çœ‹ç­›é€‰åçš„ `data` çš„**è¡Œåˆ—æ•°**ï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  (è¡Œæ•°, åˆ—æ•°)
  ```

ç¤ºä¾‹è¾“å‡ºï¼š

```
python


å¤åˆ¶ç¼–è¾‘
(12000, 8)
```

è¡¨ç¤ºï¼š

- ç­›é€‰åå‰©ä¸‹ **12000 æ¡æ ·æœ¬**
- æ¯æ¡æ ·æœ¬æœ‰ **8 ä¸ªå­—æ®µ**ï¼ˆå¦‚ xã€yã€accuracyã€hourã€weekday ç­‰ï¼‰

------

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

| ä»£ç                                               | ä½œç”¨                                        |
| ------------------------------------------------- | ------------------------------------------- |
| `data = data[data['place_id'].isin(tf.place_id)]` | åªä¿ç•™å‡ºç°åœ¨ `tf.place_id` åˆ—è¡¨ä¸­çš„ç­¾åˆ°è®°å½• |
| `data.shape`                                      | æŸ¥çœ‹ç­›é€‰åçš„æ•°æ®é›†å¤§å°ï¼ˆæ ·æœ¬æ•°å’Œç‰¹å¾æ•°ï¼‰    |



è¿™æ˜¯å¸¸ç”¨äºåˆ†ç±»é—®é¢˜ä¸­â€œåªä¿ç•™å‡ºç°æ¬¡æ•°è¾ƒå¤šç±»åˆ«â€çš„æ ‡å‡†åšæ³•ï¼Œæœ‰åŠ©äºï¼š

- å‡å°‘ç¨€æœ‰ç±»åˆ«å½±å“
- é™ä½è®¡ç®—å¤æ‚åº¦
- æé«˜æ¨¡å‹è®­ç»ƒæ•ˆæœ

å¦‚éœ€æˆ‘å¸®ä½ è¡¥å…¨è¿™éƒ¨åˆ†çš„å‰ç½®ä»£ç ï¼ˆå¦‚å¦‚ä½•æ„é€  `tf.place_id`ï¼‰ï¼Œä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

\# # å–å‡ºæ•°æ®å½“ä¸­çš„ç‰¹å¾å€¼å’Œç›®æ ‡å€¼ y = data['place_id'] # åˆ é™¤ç›®æ ‡å€¼ï¼Œä¿ç•™ç‰¹å¾å€¼ï¼Œ x = data.drop(['place_id'], axis=1) # åˆ é™¤æ— ç”¨çš„ç‰¹å¾å€¼ï¼Œrow_idæ˜¯ç´¢å¼•,è¿™å°±æ˜¯å™ªéŸ³ x = x.drop(['row_id'], axis=1) print(x.shape) print(x.columns)ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **ä»æ¸…æ´—å¥½çš„ç­¾åˆ°æ•°æ®ä¸­åˆ†ç¦»å‡ºç‰¹å¾å€¼ï¼ˆ`x`ï¼‰å’Œç›®æ ‡å€¼ï¼ˆ`y`ï¼‰ç”¨äºæ¨¡å‹è®­ç»ƒï¼Œå¹¶åˆ é™¤æ— ç”¨å­—æ®µã€‚**

ä¸‹é¢é€è¡Œè§£é‡Šï¼š

------

### ğŸ”¹ ç¬¬ 1 è¡Œï¼šæå–ç›®æ ‡å€¼ï¼ˆåˆ†ç±»æ ‡ç­¾ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
y = data['place_id']
```

- `place_id` æ˜¯ç­¾åˆ°çš„ä½ç½®ç¼–å·ï¼ˆä¹Ÿå°±æ˜¯åˆ†ç±»ä»»åŠ¡çš„æ ‡ç­¾ yï¼‰ã€‚
- ä½ è¦è®­ç»ƒæ¨¡å‹é¢„æµ‹ç”¨æˆ·ç­¾åˆ°çš„æ˜¯å“ªä¸ª `place_id`ï¼Œæ‰€ä»¥è¿™æ˜¯ä½ çš„ **ç›®æ ‡å€¼ï¼ˆlabelï¼‰**ã€‚

------

### ğŸ”¹ ç¬¬ 2 è¡Œï¼šæå–åˆæ­¥ç‰¹å¾å€¼ï¼ˆé™¤å» place_idï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
x = data.drop(['place_id'], axis=1)
```

- ä» `data` ä¸­åˆ é™¤ `place_id` åˆ—ï¼Œä¿ç•™å…¶ä½™åˆ—ä½œä¸ºè¾“å…¥ç‰¹å¾ `x`ã€‚
- `axis=1` è¡¨ç¤ºæŒ‰åˆ—æ“ä½œã€‚
- ç°åœ¨ `x` åŒ…å«çš„æ˜¯æ¨¡å‹è®­ç»ƒç”¨çš„ç‰¹å¾å€¼ã€‚

------

### ğŸ”¹ ç¬¬ 3 è¡Œï¼šåˆ é™¤å™ªå£°ç‰¹å¾ï¼ˆrow_idï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
x = x.drop(['row_id'], axis=1)
```

- `row_id` æ˜¯åŸå§‹æ•°æ®çš„æ ·æœ¬ç¼–å·ï¼Œå¯¹æ¨¡å‹æ²¡æœ‰é¢„æµ‹æ„ä¹‰ï¼Œè¢«è§†ä¸º**æ— ç”¨æˆ–å™ªéŸ³ç‰¹å¾**ã€‚
- åˆ é™¤åå¯ä»¥é¿å…æ¨¡å‹è¯¯å­¦åˆ°æ ·æœ¬é¡ºåºç­‰æ— å…³ä¿¡æ¯ã€‚

------

### ğŸ”¹ ç¬¬ 4 è¡Œï¼šæŸ¥çœ‹ç‰¹å¾çŸ©é˜µç»´åº¦

```
python


å¤åˆ¶ç¼–è¾‘
print(x.shape)
```

- è¾“å‡ºç‰¹å¾å€¼çš„ç»´åº¦ `(æ ·æœ¬æ•°, ç‰¹å¾æ•°)`ã€‚
- ç¡®è®¤æ˜¯å¦æˆåŠŸåˆ é™¤äº† `place_id` å’Œ `row_id`ï¼Œå‰©ä¸‹çš„å°±æ˜¯çº¯ç²¹çš„ç‰¹å¾äº†ã€‚

------

### ğŸ”¹ ç¬¬ 5 è¡Œï¼šæŸ¥çœ‹å‰©ä¸‹çš„ç‰¹å¾åˆ—å

```
python


å¤åˆ¶ç¼–è¾‘
print(x.columns)
```

- æ‰“å°ç‰¹å¾åˆ—åï¼Œå¸¸è§çš„åŒ…æ‹¬ï¼š

  ```
  pgsql
  
  
  å¤åˆ¶ç¼–è¾‘
  Index(['x', 'y', 'accuracy', 'day', 'hour', 'weekday'], dtype='object')
  ```

- è¿™äº›å°±æ˜¯ä½ æå–å‡ºçš„è¾“å…¥ç‰¹å¾ï¼Œç”¨äºè®­ç»ƒæ¨¡å‹ï¼ˆæ¯”å¦‚ KNNã€éšæœºæ£®æ—ç­‰ï¼‰ã€‚

------

### âœ… æ€»ç»“è¡¨æ ¼ï¼š

| ä»£ç                                   | ä½œç”¨                        |
| ------------------------------------- | --------------------------- |
| `y = data['place_id']`                | æå–ç›®æ ‡å€¼ yï¼ˆç­¾åˆ°ä½ç½® IDï¼‰ |
| `x = data.drop(['place_id'], axis=1)` | åˆ é™¤ y åˆ—ï¼Œå¾—åˆ°åˆæ­¥ç‰¹å¾å€¼   |
| `x = x.drop(['row_id'], axis=1)`      | åˆ é™¤æ— ç”¨åˆ— `row_id`         |
| `print(x.shape)`                      | æŸ¥çœ‹æœ€ç»ˆç‰¹å¾æ•°æ®çš„ç»´åº¦      |
| `print(x.columns)`                    | æŸ¥çœ‹ä¿ç•™ä¸‹æ¥çš„ç‰¹å¾åˆ—å      |



------

ä½ ç°åœ¨å·²ç»å®Œæˆäº†æ•°æ®å‡†å¤‡é˜¶æ®µï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œï¼š

- æ•°æ®æ ‡å‡†åŒ–
- åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
- è®­ç»ƒæ¨¡å‹ï¼ˆKNNã€SVM ç­‰ï¼‰

éœ€è¦æˆ‘ç»§ç»­å¸®ä½ å†™ä¸‹ä¸€æ­¥çš„å»ºæ¨¡ä»£ç å—ï¼Ÿ



##### æ‚¨è¯´ï¼š

\# è¿›è¡Œæ•°æ®çš„åˆ†å‰²è®­ç»ƒé›†åˆæµ‹è¯•é›† x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=1) # ç‰¹å¾å·¥ç¨‹ï¼ˆæ ‡å‡†åŒ–ï¼‰,ä¸‹é¢3è¡Œæ³¨é‡Šï¼Œä¸€å¼€å§‹æˆ‘ä»¬ä¸è¿›è¡Œæ ‡å‡†åŒ–ï¼Œçœ‹ä¸‹æ•ˆæœï¼Œç›®æ ‡å€¼è¦ä¸è¦æ ‡å‡†åŒ–ï¼Ÿ std = StandardScaler() # # # # # å¯¹æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„ç‰¹å¾å€¼è¿›è¡Œæ ‡å‡†åŒ–,æœåŠ¡äºknn fit x_train = std.fit_transform(x_train) # # transformè¿”å›çš„æ˜¯copyï¼Œä¸åœ¨åŸæœ‰çš„è¾“å…¥å¯¹è±¡ä¸­å»ä¿®æ”¹ # print(id(x_test)) print(std.mean_) print(std.var_) x_test = std.transform(x_test)  #transfromä¸å†è¿›è¡Œå‡å€¼å’Œæ–¹å·®çš„è®¡ç®—ï¼Œæ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå»æ ‡å‡†åŒ– print('-' * 50) # print(id(x_test)) print(std.mean_) print(std.var_)ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **å¯¹ç­¾åˆ°æ•°æ®è¿›è¡Œè®­ç»ƒé›†/æµ‹è¯•é›†åˆ’åˆ†ï¼Œç„¶åå¯¹ç‰¹å¾è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä¸ºåç»­ä½¿ç”¨ KNN ç­‰è·ç¦»æ•æ„Ÿå‹ç®—æ³•å»ºæ¨¡åšå¥½å‡†å¤‡ã€‚**

ä¸‹é¢æŒ‰é¡ºåºè¯¦ç»†è§£é‡Šæ¯è¡Œä»£ç çš„ä½œç”¨ã€‚

------

## ğŸ”¹1. æ•°æ®é›†åˆ’åˆ†

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=1)
```

- ä½¿ç”¨ `train_test_split` ä» `sklearn.model_selection` ä¸­ï¼Œå°†æ•°æ®åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š

  - `test_size=0.25`ï¼šè¡¨ç¤ºå°† 25% çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™ 75% ä¸ºè®­ç»ƒé›†ã€‚
  - `random_state=1`ï¼šè®¾ç½®éšæœºç§å­ï¼Œä½¿åˆ’åˆ†ç»“æœå¯å¤ç°ã€‚

- è¿”å›ç»“æœé¡ºåºä¸ºï¼š

  ```
  å¤åˆ¶ç¼–è¾‘
  x_trainï¼ˆè®­ç»ƒç‰¹å¾ï¼‰ï¼Œx_testï¼ˆæµ‹è¯•ç‰¹å¾ï¼‰ï¼Œy_trainï¼ˆè®­ç»ƒæ ‡ç­¾ï¼‰ï¼Œy_testï¼ˆæµ‹è¯•æ ‡ç­¾ï¼‰
  ```

------

## ğŸ”¹2. åˆ›å»ºæ ‡å‡†åŒ–å¯¹è±¡

```
python


å¤åˆ¶ç¼–è¾‘
std = StandardScaler()
```

- å®ä¾‹åŒ–ä¸€ä¸ªæ ‡å‡†åŒ–å·¥å…·ï¼ˆ`StandardScaler`ï¼‰ï¼Œæ¥è‡ª `sklearn.preprocessing`ã€‚

- è¿™ä¸ªå·¥å…·ä¼šå°†æ¯ä¸ªç‰¹å¾çš„å€¼å˜ä¸ºï¼š

  z=xâˆ’Î¼Ïƒz = \frac{x - \mu}{\sigma}z=Ïƒxâˆ’Î¼

  å³å‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1ã€‚

> æ³¨æ„ï¼š**ç›®æ ‡å€¼ y ä¸éœ€è¦æ ‡å‡†åŒ–ï¼** å› ä¸ºå®ƒæ˜¯ç±»åˆ« IDï¼Œä¸æ˜¯è¿ç»­æ•°å€¼ã€‚

------

## ğŸ”¹3. å¯¹è®­ç»ƒé›†è¿›è¡Œæ ‡å‡†åŒ–æ‹Ÿåˆ + å˜æ¢

```
python


å¤åˆ¶ç¼–è¾‘
x_train = std.fit_transform(x_train)
```

- `fit_transform()` ä¼šå…ˆ **è®¡ç®—è®­ç»ƒé›†çš„å‡å€¼å’Œæ–¹å·®**ï¼ˆfitï¼‰ï¼Œç„¶åå†ç”¨è¿™äº›ç»Ÿè®¡é‡ **å¯¹è®­ç»ƒé›†åšæ ‡å‡†åŒ–å¤„ç†**ï¼ˆtransformï¼‰ã€‚
- è¿”å›ä¸€ä¸ªæ–°çš„æ ‡å‡†åŒ–åçš„æ•°ç»„ï¼ˆæ˜¯åŸå§‹æ•°æ®çš„ copyï¼Œä¸åœ¨åŸåœ°ä¿®æ”¹ï¼‰ã€‚

------

## ğŸ”¹4. æŸ¥çœ‹å‡å€¼å’Œæ–¹å·®

```
pythonå¤åˆ¶ç¼–è¾‘print(std.mean_)
print(std.var_)
```

- `std.mean_`ï¼šæ˜¯å¯¹æ¯ä¸ªç‰¹å¾åœ¨è®­ç»ƒé›†ä¸­çš„å‡å€¼ï¼ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªç‰¹å¾ä¸€ä¸ªï¼‰ã€‚
- `std.var_`ï¼šæ˜¯å¯¹æ¯ä¸ªç‰¹å¾åœ¨è®­ç»ƒé›†ä¸­çš„æ–¹å·®ã€‚

------

## ğŸ”¹5. å¯¹æµ‹è¯•é›†åšæ ‡å‡†åŒ–ï¼ˆä½¿ç”¨è®­ç»ƒé›†çš„å‡å€¼å’Œæ–¹å·®ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
x_test = std.transform(x_test)
```

- ä¸é‡æ–° `fit()`ï¼Œè€Œæ˜¯ä½¿ç”¨ **è®­ç»ƒé›†çš„å‡å€¼å’Œæ–¹å·®** æ¥å¯¹æµ‹è¯•é›†è¿›è¡Œæ ‡å‡†åŒ–ã€‚
- è¿™æ˜¯æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°çš„ä¸€èˆ¬æµç¨‹ï¼šè®­ç»ƒæ—¶å¯ä»¥çœ‹åˆ°æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä½†æµ‹è¯•æ—¶å¿…é¡»ä¸¥æ ¼å¤ç”¨è®­ç»ƒçš„å˜æ¢è§„åˆ™ï¼Œ**é¿å…æ•°æ®æ³„éœ²ï¼ˆdata leakageï¼‰**ã€‚

------

## ğŸ”¹6. åˆ†éš”ç¬¦ä¸å†æ‰“å°

```
pythonå¤åˆ¶ç¼–è¾‘print('-' * 50)
print(std.mean_)
print(std.var_)
```

- å†æ¬¡æ‰“å°ä¸€æ¬¡å‡å€¼å’Œæ–¹å·®ï¼Œè¯æ˜ `.transform()` å¯¹æµ‹è¯•é›†ä¸ä¼šæ”¹å˜å‡å€¼æ–¹å·®ï¼Œè€Œæ˜¯å¤ç”¨äº†è®­ç»ƒé›†çš„æ ‡å‡†ã€‚

------

## âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤            | ç›®çš„                       |
| --------------- | -------------------------- |
| åˆ’åˆ†è®­ç»ƒ/æµ‹è¯•é›† | ä¸ºæ¨¡å‹è®­ç»ƒå‡†å¤‡æ•°æ®         |
| åˆ›å»ºæ ‡å‡†åŒ–å™¨    | åˆå§‹åŒ–æ ‡å‡†åŒ–æ“ä½œå·¥å…·       |
| è®­ç»ƒé›†æ ‡å‡†åŒ–    | è®¡ç®—å‡å€¼/æ–¹å·®å¹¶è½¬æ¢        |
| æµ‹è¯•é›†æ ‡å‡†åŒ–    | ä½¿ç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡è½¬æ¢æµ‹è¯•é›† |
| æŸ¥çœ‹å‡å€¼æ–¹å·®    | éªŒè¯æ ‡å‡†åŒ–æ­£ç¡®æ€§           |



------

## â—è¡¥å……è¯´æ˜ï¼šä¸ºä»€ä¹ˆæ ‡å‡†åŒ–å¾ˆé‡è¦ï¼Ÿ

- KNN æ˜¯**åŸºäºè·ç¦»è®¡ç®—**çš„ç®—æ³•ï¼Œä¸åŒé‡çº²çš„ç‰¹å¾ä¼šä¸¥é‡å½±å“ç»“æœï¼›
- æ¯”å¦‚ï¼š`x` å’Œ `y` æ˜¯ [0~~10]ï¼Œä½† `accuracy` æ˜¯ [0~~1000]ï¼Œä¸æ ‡å‡†åŒ–çš„è¯æ¨¡å‹ä¼šåå‘ `accuracy`ã€‚

------

å¦‚æœä½ ä¸‹ä¸€æ­¥è¦ç”¨ `KNeighborsClassifier` è¿›è¡Œå»ºæ¨¡é¢„æµ‹ï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥å¸®ä½ å†™å‡ºå®Œæ•´ä»£ç ã€‚



##### æ‚¨è¯´ï¼š

\# # è¿›è¡Œç®—æ³•æµç¨‹ # è¶…å‚æ•°ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®n_neighbors=5ï¼Œæ¥è°ƒæ•´ç»“æœå¥½å knn = KNeighborsClassifier(n_neighbors=6) # # fitï¼Œ predict,scoreï¼Œè®­ç»ƒï¼Œknnçš„fitæ˜¯ä¸è®­ç»ƒçš„ï¼Œåªæ˜¯æŠŠè®­ç»ƒé›†çš„ç‰¹å¾å€¼å’Œç›®æ ‡å€¼æ”¾å…¥åˆ°å†…å­˜ä¸­ knn.fit(x_train, y_train) # # # # # # å¾—å‡ºé¢„æµ‹ç»“æœ y_predict = knn.predict(x_test) # # print("é¢„æµ‹çš„ç›®æ ‡ç­¾åˆ°ä½ç½®ä¸ºï¼š", y_predict[0:10]) # # # # # # # å¾—å‡ºå‡†ç¡®ç‡,æ˜¯è¯„ä¼°æŒ‡æ ‡ print("é¢„æµ‹çš„å‡†ç¡®ç‡:", knn.score(x_test, y_test)) # print(y_predict) # y_testä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç æ˜¯å…¸å‹çš„æœºå™¨å­¦ä¹ åˆ†ç±»ä»»åŠ¡ä¸­çš„**æ¨¡å‹æ„å»ºä¸è¯„ä¼°æµç¨‹**ï¼Œä½¿ç”¨çš„æ˜¯ **K-è¿‘é‚»ï¼ˆKNNï¼‰ç®—æ³•** æ¥é¢„æµ‹ç”¨æˆ·çš„ç­¾åˆ°ä½ç½® `place_id`ã€‚ä¸‹é¢æŒ‰æ­¥éª¤è¯¦ç»†è§£é‡Šæ¯ä¸€è¡Œçš„ä½œç”¨ï¼š

------

## ğŸ”¹1. æ¨¡å‹åˆå§‹åŒ–

```
python


å¤åˆ¶ç¼–è¾‘
knn = KNeighborsClassifier(n_neighbors=6)
```

- å®ä¾‹åŒ–ä¸€ä¸ª **KNN åˆ†ç±»å™¨å¯¹è±¡**ï¼Œæ¥è‡ª `sklearn.neighbors`ã€‚
- å‚æ•° `n_neighbors=6` è¡¨ç¤ºï¼š
  - é¢„æµ‹æ—¶å‚è€ƒâ€œæœ€è¿‘çš„ 6 ä¸ªé‚»å±…â€çš„æ ‡ç­¾ï¼Œç”¨å¤šæ•°æŠ•ç¥¨å†³å®šåˆ†ç±»ç»“æœã€‚
- è¿™æ˜¯ KNN çš„**è¶…å‚æ•°**ï¼Œå¯ä»¥è°ƒæ•´ä»¥ä¼˜åŒ–æ¨¡å‹æ€§èƒ½ã€‚

------

## ğŸ”¹2. æ¨¡å‹â€œè®­ç»ƒâ€ï¼ˆfitï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
knn.fit(x_train, y_train)
```

- å¯¹ KNN æ¥è¯´ï¼Œ**æ²¡æœ‰çœŸæ­£çš„è®­ç»ƒè¿‡ç¨‹**ï¼ˆä¸åƒ SVMã€ç¥ç»ç½‘ç»œä¼šè®­ç»ƒå‚æ•°ï¼‰ï¼›
- å®ƒåªæ˜¯ **æŠŠè®­ç»ƒé›†çš„ç‰¹å¾å’Œæ ‡ç­¾ä¿å­˜ä¸‹æ¥**ï¼Œä¾›ä¹‹åé¢„æµ‹æ—¶ä½¿ç”¨ã€‚
- æ‰€ä»¥ fit çš„ä½œç”¨æ˜¯ï¼š**è®°ä½è®­ç»ƒæ•°æ®ï¼Œç”¨äºåç»­è·ç¦»è®¡ç®—å’ŒæŠ•ç¥¨**ã€‚

------

## ğŸ”¹3. æ¨¡å‹é¢„æµ‹

```
python


å¤åˆ¶ç¼–è¾‘
y_predict = knn.predict(x_test)
```

- ä½¿ç”¨ KNN å¯¹æµ‹è¯•é›† `x_test` è¿›è¡Œé¢„æµ‹ï¼Œè¿”å›é¢„æµ‹çš„ `place_id` ç»“æœã€‚
- å†…éƒ¨æœºåˆ¶ï¼š
  - å¯¹æ¯æ¡æµ‹è¯•æ•°æ®è®¡ç®—ä¸è®­ç»ƒé›†ä¸­æ‰€æœ‰æ•°æ®çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼›
  - é€‰å‡ºæœ€è¿‘çš„ 6 ä¸ªé‚»å±…ï¼›
  - å–è¿™ 6 ä¸ªé‚»å±…ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ `place_id` ä½œä¸ºé¢„æµ‹å€¼ã€‚

------

## ğŸ”¹4. è¾“å‡ºéƒ¨åˆ†é¢„æµ‹ç»“æœ

```
python


å¤åˆ¶ç¼–è¾‘
print("é¢„æµ‹çš„ç›®æ ‡ç­¾åˆ°ä½ç½®ä¸ºï¼š", y_predict[0:10])
```

- æ‰“å°å‰ 10 ä¸ªé¢„æµ‹ç»“æœï¼ˆé¢„æµ‹çš„ç­¾åˆ°åœ°ç‚¹ç¼–å·ï¼‰ï¼Œç”¨äºè§‚å¯Ÿæ¨¡å‹è¾“å‡ºæ˜¯å¦åˆç†ã€‚

------

## ğŸ”¹5. è¯„ä¼°æ¨¡å‹å‡†ç¡®ç‡

```
python


å¤åˆ¶ç¼–è¾‘
print("é¢„æµ‹çš„å‡†ç¡®ç‡:", knn.score(x_test, y_test))
```

- `.score()` æ–¹æ³•ä¼šè®¡ç®—æ¨¡å‹çš„å‡†ç¡®ç‡ï¼ˆaccuracyï¼‰ï¼š

  accuracy=é¢„æµ‹æ­£ç¡®çš„æ•°é‡æ€»æµ‹è¯•æ ·æœ¬æ•°\text{accuracy} = \frac{\text{é¢„æµ‹æ­£ç¡®çš„æ•°é‡}}{\text{æ€»æµ‹è¯•æ ·æœ¬æ•°}}accuracy=æ€»æµ‹è¯•æ ·æœ¬æ•°é¢„æµ‹æ­£ç¡®çš„æ•°é‡

- `x_test` æ˜¯è¾“å…¥ï¼Œ`y_test` æ˜¯çœŸå®çš„ç­¾åˆ°ä½ç½®ï¼Œå¯¹æ¯” `y_predict` çœ‹å‘½ä¸­å¤šå°‘ã€‚

------

## âœ… æ€»ç»“ä»£ç ä½œç”¨ï¼š

| æ­¥éª¤         | ä½œç”¨                           |
| ------------ | ------------------------------ |
| åˆå§‹åŒ–æ¨¡å‹   | åˆ›å»ºä¸€ä¸ª KNN åˆ†ç±»å™¨å¯¹è±¡ï¼ˆk=6ï¼‰ |
| è®­ç»ƒæ¨¡å‹     | ä¿å­˜è®­ç»ƒæ•°æ®ç”¨äºé¢„æµ‹           |
| é¢„æµ‹æµ‹è¯•é›†   | å¯¹æ–°æ•°æ®è¿›è¡Œç­¾åˆ°ä½ç½®é¢„æµ‹       |
| è¾“å‡ºé¢„æµ‹ç»“æœ | æŸ¥çœ‹å‰å‡ ä¸ªé¢„æµ‹å€¼æ˜¯å¦åˆç†       |
| è¯„ä¼°å‡†ç¡®ç‡   | æµ‹è¯•æ¨¡å‹åœ¨çœŸå®æ•°æ®ä¸Šçš„é¢„æµ‹æ€§èƒ½ |



------

## ğŸ” ç¤ºä¾‹è¾“å‡ºå¯èƒ½é•¿è¿™æ ·ï¼š

```
textå¤åˆ¶ç¼–è¾‘é¢„æµ‹çš„ç›®æ ‡ç­¾åˆ°ä½ç½®ä¸ºï¼š [1234567890 1234567890 9876543210 ...]
é¢„æµ‹çš„å‡†ç¡®ç‡: 0.9427
```

è¡¨ç¤ºé¢„æµ‹ç»“æœå¾ˆå¥½ï¼ˆè¯´æ˜ä½ å‰é¢åšçš„æ•°æ®æ¸…æ´—ã€æ ‡å‡†åŒ–å’Œç‰¹å¾æå–æ˜¯æœ‰æ•ˆçš„ ğŸ‘ï¼‰

------

å¦‚æœä½ æƒ³è¿›ä¸€æ­¥ä¼˜åŒ–å‡†ç¡®ç‡ï¼Œæˆ‘å¯ä»¥å¸®ä½ ï¼š

- è‡ªåŠ¨è°ƒå‚ï¼ˆæ¯”å¦‚ç”¨ `GridSearchCV`ï¼‰
- ç»˜åˆ¶æ··æ·†çŸ©é˜µåˆ†æåˆ†ç±»é”™è¯¯
- è¯„ä¼°æ¯ä¸ªæ—¶é—´ç‰¹å¾çš„è´¡çŒ®

éœ€è¦æˆ‘ç»§ç»­ï¼Ÿéšæ—¶å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

\#ç½‘æ ¼æœç´¢æ—¶è®²è§£ # # æ„é€ ä¸€äº›å‚æ•°ï¼ˆè¶…å‚ï¼‰çš„å€¼è¿›è¡Œæœç´¢ param = {"n_neighbors": [3, 5, 10, 12, 15],'weights':['uniform', 'distance']} # # è¿›è¡Œç½‘æ ¼æœç´¢ï¼Œcv=3æ˜¯3æŠ˜äº¤å‰éªŒè¯ï¼Œç”¨å…¶ä¸­2æŠ˜è®­ç»ƒï¼Œ1æŠ˜éªŒè¯ gc = GridSearchCV(knn, param_grid=param, cv=3) gc.fit(x_train, y_train)  #ä½ ç»™å®ƒçš„x_trainï¼Œå®ƒåˆåˆ†ä¸ºè®­ç»ƒé›†ï¼ŒéªŒè¯é›† # é¢„æµ‹å‡†ç¡®ç‡ï¼Œä¸ºäº†ç»™å¤§å®¶çœ‹çœ‹ print("åœ¨æµ‹è¯•é›†ä¸Šå‡†ç¡®ç‡ï¼š", gc.score(x_test, y_test)) print("åœ¨äº¤å‰éªŒè¯å½“ä¸­æœ€å¥½çš„ç»“æœï¼š", gc.best_score_) #æœ€å¥½çš„ç»“æœ print("é€‰æ‹©æœ€å¥½çš„æ¨¡å‹æ˜¯ï¼š", gc.best_estimator_) #æœ€å¥½çš„æ¨¡å‹,å‘Šè¯‰ä½ ç”¨äº†å“ªäº›å‚æ•° print("æ¯ä¸ªè¶…å‚æ•°æ¯æ¬¡äº¤å‰éªŒè¯çš„ç»“æœï¼š") gc.cv_results_ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨ **ç½‘æ ¼æœç´¢ï¼ˆGrid Searchï¼‰+ äº¤å‰éªŒè¯ï¼ˆCross Validationï¼‰** æ¥ä¸º KNN æ¨¡å‹ **è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜è¶…å‚æ•°ç»„åˆ**ï¼Œå¹¶è¯„ä¼°æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„æœ€ç»ˆå‡†ç¡®ç‡ã€‚

ä¸‹é¢æ˜¯æ¯ä¸€éƒ¨åˆ†çš„è¯¦ç»†è®²è§£ï¼š

------

## ğŸ”¹1. æ„é€ ç½‘æ ¼æœç´¢çš„å‚æ•°ç©ºé—´

```
pythonå¤åˆ¶ç¼–è¾‘param = {
    "n_neighbors": [3, 5, 10, 12, 15],
    "weights": ['uniform', 'distance']
}
```

### âœ… æ„æ€ï¼š

- ä½ å¸Œæœ›åœ¨è®­ç»ƒä¸­å°è¯•å¤šä¸ª `K` çš„å–å€¼ï¼ˆé‚»å±…ä¸ªæ•°ï¼‰ï¼›
- ä½ è¿˜å¸Œæœ›å°è¯•ä¸¤ç§æƒé‡ç­–ç•¥ï¼š
  - `'uniform'`ï¼šæ‰€æœ‰é‚»å±…æƒé‡ç›¸ç­‰ï¼›
  - `'distance'`ï¼šè·ç¦»è¿‘çš„é‚»å±…æƒé‡æ›´é«˜ã€‚

ğŸ§  è¿™ä¼šç»„åˆæˆ 5 Ã— 2 = 10 ç»„è¶…å‚æ•°ã€‚

------

## ğŸ”¹2. ä½¿ç”¨ GridSearchCV è¿›è¡Œç½‘æ ¼æœç´¢ + äº¤å‰éªŒè¯

```
python


å¤åˆ¶ç¼–è¾‘
gc = GridSearchCV(knn, param_grid=param, cv=3)
```

### âœ… å«ä¹‰ï¼š

- `knn` æ˜¯ä½ ä¹‹å‰åˆ›å»ºçš„ KNN æ¨¡å‹ï¼›
- `param_grid=param`ï¼šæŒ‡å®šè¦æœç´¢çš„å‚æ•°ç»„åˆï¼›
- `cv=3`ï¼šä½¿ç”¨ **3 æŠ˜äº¤å‰éªŒè¯**ï¼š
  - æŠŠ `x_train` åˆ†æˆ 3 ä»½ï¼Œæ¯æ¬¡ç”¨ 2 ä»½è®­ç»ƒï¼Œ1 ä»½éªŒè¯ï¼Œè½®æµæ‰§è¡Œ 3 æ¬¡ï¼›
  - å¯¹æ¯ç»„è¶…å‚æ•°éƒ½è¿›è¡Œ 3 æ¬¡éªŒè¯ï¼Œå–å¹³å‡å€¼ã€‚

------

## ğŸ”¹3. æ‹Ÿåˆæ¨¡å‹ï¼ˆåŒ…å«äº¤å‰éªŒè¯ + è¶…å‚æ•°æœç´¢ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
gc.fit(x_train, y_train)
```

- **è¿‡ç¨‹è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹å†…å®¹**ï¼š
  - å¯¹æ¯ç§å‚æ•°ç»„åˆï¼Œåš 3 æ¬¡è®­ç»ƒ+éªŒè¯ï¼›
  - æ‰¾å‡ºå“ªç»„å‚æ•°è¡¨ç°æœ€å¥½ï¼›
  - è‡ªåŠ¨ç”¨**æœ€ä¼˜å‚æ•°æ¨¡å‹**è¿›è¡Œæœ€ç»ˆæ‹Ÿåˆã€‚

------

## ğŸ”¹4. åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æœ€ä¼˜æ¨¡å‹æ•ˆæœ

```
python


å¤åˆ¶ç¼–è¾‘
print("åœ¨æµ‹è¯•é›†ä¸Šå‡†ç¡®ç‡ï¼š", gc.score(x_test, y_test))
```

- ä½¿ç”¨ `gc.score(...)` ç­‰ä»·äºå¯¹ `gc.best_estimator_` è°ƒç”¨ `.score(...)`ã€‚
- è¿™æ˜¯åœ¨ä½ ä¿ç•™çš„ `x_test` ä¸Šè¯„ä¼°æœ€ç»ˆæ³›åŒ–æ•ˆæœã€‚

------

## ğŸ”¹5. è¾“å‡ºæœ€ä½³äº¤å‰éªŒè¯å‡†ç¡®ç‡

```
python


å¤åˆ¶ç¼–è¾‘
print("åœ¨äº¤å‰éªŒè¯å½“ä¸­æœ€å¥½çš„ç»“æœï¼š", gc.best_score_)
```

- è¿™æ˜¯**äº¤å‰éªŒè¯**ä¸­è¡¨ç°æœ€å¥½çš„å¹³å‡å‡†ç¡®ç‡ï¼Œä»£è¡¨æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„æœ€ä¼˜ç¨³å®šè¡¨ç°ã€‚

------

## ğŸ”¹6. è¾“å‡ºæœ€ä½³å‚æ•°ç»„åˆå¯¹åº”çš„æ¨¡å‹

```
python


å¤åˆ¶ç¼–è¾‘
print("é€‰æ‹©æœ€å¥½çš„æ¨¡å‹æ˜¯ï¼š", gc.best_estimator_)
```

- ä¼šè¾“å‡ºç±»ä¼¼ï¼š

```
text


å¤åˆ¶ç¼–è¾‘
KNeighborsClassifier(n_neighbors=10, weights='distance')
```

- å‘Šè¯‰ä½ ç½‘æ ¼æœç´¢æ‰¾åˆ°çš„â€œæœ€ä¼˜å‚æ•°é…ç½®â€ã€‚

------

## ğŸ”¹7. è¾“å‡ºæ‰€æœ‰è¶…å‚æ•°ç»„åˆçš„äº¤å‰éªŒè¯å¾—åˆ†

```
pythonå¤åˆ¶ç¼–è¾‘print("æ¯ä¸ªè¶…å‚æ•°æ¯æ¬¡äº¤å‰éªŒè¯çš„ç»“æœï¼š")
gc.cv_results_
```

- `gc.cv_results_` æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å‚æ•°ç»„åˆå¾—åˆ†çš„å­—å…¸ï¼Œå¯ä»¥è¿›ä¸€æ­¥åˆ†ææˆ–ç”»å›¾ã€‚

ä¾‹å¦‚ä½ å¯ä»¥æŸ¥çœ‹ï¼š

```
pythonå¤åˆ¶ç¼–è¾‘import pandas as pd
pd.DataFrame(gc.cv_results_)[["params", "mean_test_score", "rank_test_score"]]
```

------

## âœ… æ€»ç»“æ•´æ®µä»£ç ä½œç”¨ï¼š

| æ­¥éª¤                | è¯´æ˜                                |
| ------------------- | ----------------------------------- |
| å®šä¹‰æœç´¢ç©ºé—´        | æšä¸¾å¤šä¸ª `n_neighbors` å’Œ `weights` |
| ç½‘æ ¼æœç´¢ + äº¤å‰éªŒè¯ | æ‰¾å‡ºæœ€ä¼˜è¶…å‚æ•°ç»„åˆ                  |
| è®­ç»ƒæ¨¡å‹            | ç”¨æœ€ä¼˜è¶…å‚æ•°åœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆ          |
| åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°      | å¾—å‡ºæ³›åŒ–èƒ½åŠ›ï¼ˆæœ€ç»ˆå‡†ç¡®ç‡ï¼‰          |
| è¾“å‡ºæœ€ä½³å‚æ•°ä¸ç»“æœ  | ç¡®è®¤å“ªç»„å‚æ•°æ•ˆæœæœ€å¥½                |



------

### âœ… ä¸ºä»€ä¹ˆè¦ç”¨ç½‘æ ¼æœç´¢ + äº¤å‰éªŒè¯ï¼Ÿ

å› ä¸ºï¼š

- æ‰‹åŠ¨è°ƒå‚æ•ˆç‡ä½ï¼›
- è¶…å‚æ•°å¯¹æ¨¡å‹æ€§èƒ½å½±å“å¾ˆå¤§ï¼›
- äº¤å‰éªŒè¯å¯ä»¥å‡å°‘å¶ç„¶æ€§ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

------

å¦‚æœä½ æƒ³ç”»å‡ºä¸åŒ `K` å€¼ä¸‹çš„å‡†ç¡®ç‡å˜åŒ–å›¾ã€æˆ–è€…æƒ³ç”¨ `GridSearchCV` è‡ªåŠ¨å¯è§†åŒ–ï¼Œéšæ—¶å¯ä»¥å‘Šè¯‰æˆ‘ã€‚



##### æ‚¨è¯´ï¼š

""" æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±» :return: None """ news = fetch_20newsgroups(subset='all', data_home='data') print(len(news.data))  #æ ·æœ¬æ•°ï¼ŒåŒ…å«çš„ç‰¹å¾ print('-'*50) print(news.data[0]) #ç¬¬ä¸€ä¸ªæ ·æœ¬ ç‰¹å¾ print('-'*50) print(news.target) #æ ‡ç­¾ print(np.unique(news.target)) #æ ‡ç­¾çš„ç±»åˆ« print(news.target_names) #æ ‡ç­¾çš„åå­— ä»£ç ä½œç”¨



###### ChatGPT è¯´ï¼š

ä½ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š

> **åŠ è½½ `20ç±»æ–°é—»æ•°æ®é›†`ï¼Œå¹¶æŸ¥çœ‹å…¶ä¸­çš„æ–‡æœ¬æ ·æœ¬ã€æ ‡ç­¾ç§ç±»ä¸æ•°é‡**ï¼Œä¸ºåç»­çš„æœ´ç´ è´å¶æ–¯ï¼ˆNaive Bayesï¼‰æ–‡æœ¬åˆ†ç±»ä»»åŠ¡åšå‡†å¤‡ã€‚

------

### ğŸ” é€è¡Œè¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼š

------

### ğŸ“Œ æ•°æ®åŠ è½½

```
python


å¤åˆ¶ç¼–è¾‘
news = fetch_20newsgroups(subset='all', data_home='data')
```

- ä» `sklearn.datasets` åŠ è½½ [20ç±»æ–°é—»æ•°æ®é›†ï¼ˆ20 newsgroupsï¼‰]ã€‚
- å‚æ•°è¯´æ˜ï¼š
  - `subset='all'`ï¼šåŠ è½½ **æ‰€æœ‰æ•°æ®**ï¼ˆè®­ç»ƒé›† + æµ‹è¯•é›†ï¼Œä¸€å…±çº¦ 18,000 æ¡ï¼‰ï¼›
  - `data_home='data'`ï¼šæ•°æ®ä¿å­˜æˆ–è¯»å–çš„ä½ç½®ï¼ˆæœ¬åœ° `data/` æ–‡ä»¶å¤¹ï¼‰ã€‚

ğŸ“¦ æ•°æ®é›†ä¸­æ¯æ¡æ ·æœ¬æ˜¯ä¸€ä¸ªæ–°é—»æ–‡æœ¬ï¼Œç›®æ ‡æ˜¯è¦åˆ†ç±»å‡ºå®ƒå±äºå“ªä¸€ç±»æ–°é—»ä¸»é¢˜ã€‚

------

### ğŸ“Š æ ·æœ¬æ€»æ•°

```
python


å¤åˆ¶ç¼–è¾‘
print(len(news.data))
```

- è¾“å‡ºæ ·æœ¬æ€»æ•°ï¼Œå³æ–°é—»æ¡æ•°ã€‚

- è¾“å‡ºç»“æœå¤§çº¦æ˜¯ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  18846
  ```

------

### ğŸ“„ æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ ·æœ¬çš„å†…å®¹

```
pythonå¤åˆ¶ç¼–è¾‘print('-'*50)
print(news.data[0])
```

- `news.data[0]` æ˜¯ç¬¬ 1 æ¡æ–°é—»çš„åŸå§‹æ–‡æœ¬å†…å®¹ï¼ˆæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œæ ¼å¼å¦‚ç”µå­é‚®ä»¶æ­£æ–‡ï¼ŒåŒ…æ‹¬å‘ä»¶äººã€ä¸»é¢˜ã€æ­£æ–‡ç­‰ã€‚

------

### ğŸ·ï¸ æŸ¥çœ‹æ ‡ç­¾ï¼ˆå¯¹åº”ç±»åˆ«ç´¢å¼•ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘print('-'*50)
print(news.target)
```

- è¾“å‡ºæ‰€æœ‰æ ·æœ¬å¯¹åº”çš„æ ‡ç­¾ï¼ˆæ˜¯æ•°å­—ï¼‰ï¼Œå¦‚ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  [10  3 17 ...  3  1  7]
  ```

- è¿™äº›æ•°å­—æ˜¯æ¯æ¡æ–‡æœ¬å¯¹åº”çš„ç±»åˆ«ç¼–å·ï¼ˆ0~19ï¼‰ï¼Œå…± 20 ç±»ã€‚

------

### ğŸ”¢ æŸ¥çœ‹æ‰€æœ‰å”¯ä¸€æ ‡ç­¾ï¼ˆç±»åˆ«ç§ç±»ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
print(np.unique(news.target))
```

- è¾“å‡º `target` ä¸­æ‰€æœ‰**ä¸åŒçš„æ ‡ç­¾**ï¼ˆä» 0 åˆ° 19ï¼‰ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  [ 0  1  2 ... 19]
  ```

- è¯´æ˜è¿™ä¸ªæ•°æ®é›†ä¸€å…±åŒ…æ‹¬ 20 ä¸ªç±»åˆ«ã€‚

------

### ğŸ·ï¸ æŸ¥çœ‹æ¯ä¸ªç±»åˆ«çš„åç§°ï¼ˆæ ‡ç­¾åå­—ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
print(news.target_names)
```

- è¾“å‡ºæ ‡ç­¾å¯¹åº”çš„ç±»åˆ«åï¼Œå¦‚ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  ['alt.atheism', 'comp.graphics', 'comp.os.ms-windows.misc', ..., 'talk.religion.misc']
  ```

- è¿™äº›æ˜¯æ–°é—»çš„å®é™…ä¸»é¢˜ï¼Œå¦‚å®—æ•™ã€ä½“è‚²ã€ç§‘å­¦ã€æ”¿æ²»ç­‰ã€‚

------

### âœ… æ€»ç»“ï¼šæ¯è¡Œä»£ç ä½œç”¨ä¸€è§ˆè¡¨

| ä»£ç è¡Œ                    | ä½œç”¨                         |
| ------------------------- | ---------------------------- |
| `fetch_20newsgroups(...)` | ä¸‹è½½å¹¶åŠ è½½æ–°é—»æ–‡æœ¬å’Œæ ‡ç­¾     |
| `len(news.data)`          | è¾“å‡ºæ€»æ ·æœ¬æ•°é‡               |
| `news.data[0]`            | æŸ¥çœ‹ç¬¬ 1 æ¡æ–°é—»æ–‡æœ¬          |
| `news.target`             | æ‰€æœ‰æ ·æœ¬çš„æ ‡ç­¾ç¼–å·ï¼ˆ0~19ï¼‰   |
| `np.unique(news.target)`  | æ ‡ç­¾çš„å»é‡åˆ—è¡¨ï¼ˆç±»åˆ«æ•°é‡ï¼‰   |
| `news.target_names`       | æ ‡ç­¾ç¼–å·å¯¹åº”çš„å®é™…æ–°é—»ç±»åˆ«å |



------

### âœ… ç”¨å¤„ï¼šè¿™æ®µä»£ç æ˜¯åšæœ´ç´ è´å¶æ–¯æ–‡æœ¬åˆ†ç±»å‰çš„**æ•°æ®æ¢ç´¢**éƒ¨åˆ†ï¼Œå¯ä»¥å¸®åŠ©ä½ ï¼š

- çŸ¥é“æ ·æœ¬æ•°å’Œç±»åˆ«ï¼›
- äº†è§£æ–‡æœ¬å†…å®¹æ ¼å¼ï¼›
- ä¸ºå‘é‡åŒ–æ–‡æœ¬ã€å»ºæ¨¡ç­‰æ­¥éª¤æ‰“åŸºç¡€ã€‚

éœ€è¦æˆ‘ç»§ç»­å¸®ä½ å†™åç»­çš„æ–‡æœ¬å‘é‡åŒ–ï¼ˆ`CountVectorizer`ã€`TfidfVectorizer`ï¼‰å’Œæœ´ç´ è´å¶æ–¯å»ºæ¨¡ä»£ç å—ï¼Ÿåªéœ€ä¸€å¥è¯ âœ…ã€‚



##### æ‚¨è¯´ï¼š

ä»£ç ä½œç”¨ï¼šint(news.target_names) #æ ‡ç­¾çš„åå­— #%% print('-'*50) # è¿›è¡Œæ•°æ®åˆ†å‰² x_train, x_test, y_train, y_test = train_test_split(news.data, news.target, test_size=0.25, random_state=1) # å¯¹æ•°æ®é›†è¿›è¡Œç‰¹å¾æŠ½å– tf = TfidfVectorizer() # ä»¥è®­ç»ƒé›†å½“ä¸­çš„è¯çš„åˆ—è¡¨è¿›è¡Œæ¯ç¯‡æ–‡ç« é‡è¦æ€§ç»Ÿè®¡['a','b','c','d'] x_train = tf.fit_transform(x_train) #é’ˆå¯¹ç‰¹å¾å†…å®¹ï¼Œå¯ä»¥è‡ªè¡Œæ‰“å°ï¼Œä¸‹é¢çš„æ‰“å°å¯ä»¥å¾—åˆ°ç‰¹å¾æ•°ç›®ï¼Œæ€»è®¡æœ‰15ä¸‡ç‰¹å¾ print(len(tf.get_feature_names_out())) #%% print(tf.get_feature_names_out()[100000]) #%% print(tf.get_feature_names_out()[0:10]) #%% import time # è¿›è¡Œæœ´ç´ è´å¶æ–¯ç®—æ³•çš„é¢„æµ‹,alphaæ˜¯æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°ï¼Œåˆ†å­å’Œåˆ†æ¯åŠ ä¸Šä¸€ä¸ªç³»æ•°ï¼Œåˆ†æ¯åŠ alpha*ç‰¹å¾è¯æ•°ç›® mlt = MultinomialNB(alpha=1.0) # print(x_train.toarray()) # è®­ç»ƒ start=time.time() mlt.fit(x_train, y_train) end=time.time() end-start #ç»Ÿè®¡è®­ç»ƒæ—¶é—´ #%% x_transform_test = tf.transform(x_test)  #ç‰¹å¾æ•°ç›®ä¸å‘ç”Ÿæ”¹å˜ print(len(tf.get_feature_names_out())) #æŸ¥çœ‹ç‰¹å¾æ•°ç›® #%% start=time.time() y_predict = mlt.predict(x_transform_test) print("é¢„æµ‹çš„å‰é¢10ç¯‡æ–‡ç« ç±»åˆ«ä¸ºï¼š", y_predict[0:10]) # å¾—å‡ºå‡†ç¡®ç‡,è¿™ä¸ªæ˜¯å¾ˆéš¾æé«˜å‡†ç¡®ç‡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ print("å‡†ç¡®ç‡ä¸ºï¼š", mlt.score(x_transform_test, y_test)) end=time.time() end-start #%% #é¢„æµ‹çš„æ–‡ç« æ•°ç›® len(y_predict) #%% # ç›®å‰è¿™ä¸ªåœºæ™¯æˆ‘ä»¬ä¸éœ€è¦å¬å›ç‡ï¼Œsupportæ˜¯çœŸå®çš„ä¸ºé‚£ä¸ªç±»åˆ«çš„æœ‰å¤šå°‘ä¸ªæ ·æœ¬ print(classification_report(y_test, y_predict,      target_names=news.target_names)) #%% y_test.shape #æµ‹è¯•é›†ä¸­æœ‰å¤šå°‘ æ ·æœ¬ #%% y_test1 = np.where(y_test == 0, 1, 0) print(y_test1.sum()) #labelä¸º0çš„æ ·æœ¬æ•° #%% y_predict1 = np.where(y_predict == 0, 1, 0) print(y_predict1.sum()) #%% (y_test1*y_predict1).sum() #%% 153/168 #%% 153/199 #%% max(y_test),min(y_test) #%% # æŠŠ0-19æ€»è®¡20ä¸ªåˆ†ç±»ï¼Œå˜ä¸º0å’Œ1 # 5æ˜¯å¯ä»¥æ”¹ä¸º0åˆ°19çš„ y_test1 = np.where(y_test == 5, 1, 0) print(y_test1.sum()) #labelä¸º5çš„æ ·æœ¬æ•° y_predict1 = np.where(y_predict == 5, 1, 0) print(y_predict1.sum()) # roc_auc_scoreçš„y_teståªèƒ½æ˜¯äºŒåˆ†ç±»,é’ˆå¯¹å¤šåˆ†ç±»å¦‚ä½•è®¡ç®—AUC print("AUCæŒ‡æ ‡ï¼š", roc_auc_score(y_test1, y_predict1)) #%% y_test1,y_predict1 #%% #ç®—å¤šåˆ†ç±»çš„ç²¾ç¡®ç‡ï¼Œå¬å›ç‡ï¼ŒF1-score FP=np.where((np.array(y_test1)-np.array(y_predict1))==-1,1,0).sum()   #FPæ˜¯18 TP=y_predict1.sum()-FP #TPæ˜¯196 print(TP) FN=np.where((np.array(y_test1)-np.array(y_predict1))==1,1,0).sum() #FNæ˜¯34 print(FN)#FNæ˜¯1 TN=np.where(y_test1==0,1,0).sum()-FP  #4464 print(TN) #%% TP/(TP+FP) #ç²¾ç¡®ç‡ #%% TP/(TP+FN)  #å¬å›ç‡ #%% #F1-score 2*TP/(2*TP+FP+FN) #%% md #%% del news del x_train del x_test del y_test del y_predict del tf



###### ChatGPT è¯´ï¼š

è¿™æ®µä»£ç çš„æ•´ä½“ä½œç”¨æ˜¯ï¼š

> **ä½¿ç”¨æœ´ç´ è´å¶æ–¯ï¼ˆMultinomialNBï¼‰ç®—æ³•å¯¹ `20ç±»æ–°é—»æ–‡æœ¬æ•°æ®é›†` è¿›è¡Œåˆ†ç±»å»ºæ¨¡ï¼Œå¹¶è¿›è¡Œå¤šåˆ†ç±»è¯„ä¼°ä¸äºŒåˆ†ç±»è½¬æ¢åæ‰‹åŠ¨è®¡ç®— AUCã€ç²¾ç¡®ç‡ã€å¬å›ç‡å’Œ F1-score ç­‰æŒ‡æ ‡ã€‚**

------

## ğŸ” **åˆ†æ®µè§£é‡Šæ¯éƒ¨åˆ†ä»£ç ä½œç”¨å¦‚ä¸‹ï¼š**

------

### ğŸ“¦ 1. åŠ è½½å¹¶æŸ¥çœ‹æ ‡ç­¾å

```
python


å¤åˆ¶ç¼–è¾‘
int(news.target_names)
```

âŒ æŠ¥é”™ä»£ç ï¼š`news.target_names` æ˜¯åˆ—è¡¨ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•´æ•°ã€‚åº”è¯¥æ˜¯è¯¯å†™ï¼Œå¯ä»¥åˆ æ‰ã€‚

------

### âœ‚ï¸ 2. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test = train_test_split(news.data, news.target, test_size=0.25, random_state=1)
```

- å°†æ–‡æœ¬æ•°æ® `news.data` æŒ‰ 75% è®­ç»ƒ / 25% æµ‹è¯•åˆ’åˆ†ã€‚
- `random_state=1` ä¿è¯å¯å¤ç°ã€‚

------

### ğŸ”  3. æ–‡æœ¬ç‰¹å¾æå–ï¼ˆTF-IDFï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘tf = TfidfVectorizer()
x_train = tf.fit_transform(x_train)
```

- `TfidfVectorizer` å°†æ–‡æœ¬è½¬ä¸ºå‘é‡ï¼ˆTF-IDFï¼‰ï¼Œé€‚åˆæ–‡æœ¬åˆ†ç±»ã€‚
- `fit_transform()` ä¼šç»Ÿè®¡è®­ç»ƒé›†ä¸­çš„è¯è¯­ï¼Œå¹¶ç”Ÿæˆå‘é‡ã€‚

```
python


å¤åˆ¶ç¼–è¾‘
len(tf.get_feature_names_out())
```

- æŸ¥çœ‹æå–å‡ºçš„ç‰¹å¾è¯æ•°é‡ï¼ˆå¤§çº¦åœ¨15ä¸‡ä¸ªå·¦å³ï¼‰ã€‚

------

### ğŸ” 4. ç‰¹å¾è¯æŸ¥çœ‹

```
pythonå¤åˆ¶ç¼–è¾‘tf.get_feature_names_out()[100000]
tf.get_feature_names_out()[0:10]
```

- è¾“å‡ºæŸäº›è¯è¯­ï¼Œç¡®è®¤ç‰¹å¾åˆ—è¡¨ã€‚

------

### â±ï¸ 5. æœ´ç´ è´å¶æ–¯æ¨¡å‹è®­ç»ƒä¸é¢„æµ‹

```
pythonå¤åˆ¶ç¼–è¾‘mlt = MultinomialNB(alpha=1.0)
mlt.fit(x_train, y_train)
```

- ä½¿ç”¨å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯è¿›è¡Œè®­ç»ƒï¼›
- `alpha=1.0` æ˜¯æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘å‚æ•°ï¼Œé˜²æ­¢æ¦‚ç‡ä¸º0ã€‚

------

### ğŸ’¡ 6. æµ‹è¯•é›†å‘é‡åŒ–ã€é¢„æµ‹

```
pythonå¤åˆ¶ç¼–è¾‘x_transform_test = tf.transform(x_test)
y_predict = mlt.predict(x_transform_test)
```

- æµ‹è¯•é›†ä½¿ç”¨ **è®­ç»ƒé›†çš„è¯è¡¨** æ¥è½¬æ¢ã€‚
- `predict` å¾—åˆ°é¢„æµ‹ç»“æœã€‚

------

### ğŸ¯ 7. æ¨¡å‹è¯„ä¼°

```
python


å¤åˆ¶ç¼–è¾‘
mlt.score(x_transform_test, y_test)
```

- è¯„ä¼°å‡†ç¡®ç‡ï¼ˆå¤šåˆ†ç±»å‡†ç¡®ç‡ï¼‰

```
python


å¤åˆ¶ç¼–è¾‘
classification_report(y_test, y_predict, target_names=news.target_names)
```

- è¾“å‡ºæ¯ç±»çš„å‡†ç¡®ç‡ã€å¬å›ç‡ã€F1-scoreã€æ”¯æŒæ•°ã€‚

------

### ğŸ“Š 8. æ‰‹åŠ¨è¿›è¡ŒäºŒåˆ†ç±»ï¼ˆå°†ç¬¬ `x` ç±»è®¾ä¸º 1ï¼Œå…¶ä½™ä¸º 0ï¼‰

```
pythonå¤åˆ¶ç¼–è¾‘y_test1 = np.where(y_test == 0, 1, 0)
y_predict1 = np.where(y_predict == 0, 1, 0)
```

- æŠŠåŸå§‹çš„ 20 ç±»æ•°æ®å˜æˆäºŒåˆ†ç±»ï¼Œä¾¿äºä½¿ç”¨ `roc_auc_score` ç­‰è¯„ä¼°æŒ‡æ ‡ã€‚

```
python


å¤åˆ¶ç¼–è¾‘
roc_auc_score(y_test1, y_predict1)
```

- è®¡ç®— AUC æŒ‡æ ‡ï¼ˆäºŒåˆ†ç±»æƒ…å†µä¸‹å¯ç”¨ï¼‰

------

### ğŸ“ 9. æ‰‹åŠ¨è®¡ç®—æ··æ·†çŸ©é˜µåŠè¯„ä¼°æŒ‡æ ‡

```
pythonå¤åˆ¶ç¼–è¾‘FP = ...
TP = ...
FN = ...
TN = ...
```

å¹¶åˆ†åˆ«è®¡ç®—ï¼š

- ç²¾ç¡®ç‡ï¼š`TP / (TP + FP)`
- å¬å›ç‡ï¼š`TP / (TP + FN)`
- F1-scoreï¼š`2 * TP / (2*TP + FP + FN)`

è¿™äº›è®¡ç®—å’Œ `classification_report` ä¸­çš„ä¸€è‡´ï¼Œåªä¸è¿‡æ˜¯æ‰‹åŠ¨å®ç°äº†ä¸€éã€‚

------

### ğŸ§¹ 10. é‡Šæ”¾å†…å­˜

```
pythonå¤åˆ¶ç¼–è¾‘del news
del x_train
del x_test
del y_test
del y_predict
del tf
```

- åˆ é™¤å¤§å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡å®éªŒæˆ–å¾ªç¯æµ‹è¯•åœºæ™¯ã€‚

------

## âœ… æ€»ç»“ï¼šè¿™æ®µä»£ç å®Œæˆäº†å®Œæ•´çš„æ–‡æœ¬åˆ†ç±»æµç¨‹ï¼š

| æ­¥éª¤               | è¯´æ˜                             |
| ------------------ | -------------------------------- |
| æ•°æ®åŠ è½½           | åŠ è½½ `20newsgroups` æ–‡æœ¬æ•°æ®     |
| é¢„å¤„ç†             | TF-IDF æå–æ–‡æœ¬ç‰¹å¾              |
| åˆ’åˆ†æ•°æ®           | æ‹†åˆ†è®­ç»ƒé›†/æµ‹è¯•é›†                |
| å»ºæ¨¡è®­ç»ƒ           | ç”¨ `MultinomialNB` æ¨¡å‹è®­ç»ƒ      |
| æ¨¡å‹é¢„æµ‹           | ç”¨æµ‹è¯•é›†é¢„æµ‹æ–‡æœ¬æ‰€å±ç±»åˆ«         |
| æ¨¡å‹è¯„ä¼°           | è¾“å‡ºå¤šåˆ†ç±»è¯„ä¼°æŠ¥å‘Š               |
| äºŒåˆ†ç±»è½¬æ¢         | å°†å¤šåˆ†ç±»è½¬æˆäºŒåˆ†ç±»ï¼Œæ‰‹åŠ¨è¯„ä¼°     |
| è®¡ç®— AUCã€ç²¾ç¡®ç‡ç­‰ | æ·±å…¥åˆ†æç¬¬ 0 æˆ–ç¬¬ 5 ç±»çš„é¢„æµ‹æ•ˆæœ |



------

å¦‚æœä½ å¸Œæœ›æŠŠè¿™æ®µæµç¨‹å°è£…æˆä¸€ä¸ªå‡½æ•°ã€æˆ–æ‰¹é‡åˆ†ææ¯ä¸ªç±»åˆ«çš„äºŒåˆ†ç±»æ•ˆæœï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥å¸®ä½ è‡ªåŠ¨åŒ–æ•´ç†ã€‚



##### æ‚¨è¯´ï¼š

è¯¦ç»†ä»‹ç»ä»£ç ä½œç”¨å’ŒåŸç†ï¼šfrom sklearn.model_selection import train_test_split, GridSearchCV from sklearn.feature_extraction import DictVectorizer from sklearn.tree import DecisionTreeClassifier, export_graphviz from sklearn.ensemble import RandomForestClassifier import pandas as pd import numpy as np #%% np.log2(1/32) #%% 1 / 2 * np.log2(1 /2) + 1 / 2 * np.log2(1 /2) #%% 1 / 3 * np.log2(1 / 3) + 2 / 3 * np.log2(2 / 3) #%% 0.01 * np.log2(0.01) + 0.99 * np.log2(0.99) #%% """ å†³ç­–æ ‘å¯¹æ³°å¦å°¼å…‹å·è¿›è¡Œé¢„æµ‹ç”Ÿæ­» :return: None """ # è·å–æ•°æ® titan = pd.read_csv("./data/titanic.txt") titan.info() #%% # å¤„ç†æ•°æ®ï¼Œæ‰¾å‡ºç‰¹å¾å€¼å’Œç›®æ ‡å€¼ x = titan[['pclass', 'age', 'sex']] y = titan['survived'] print(x.info())  # ç”¨æ¥åˆ¤æ–­æ˜¯å¦æœ‰ç©ºå€¼ x.describe(include='all') #%% x.loc[:,'age'].max() #%% # ä¸€å®šè¦è¿›è¡Œç¼ºå¤±å€¼å¤„ç†,å¡«ä¸ºå‡å€¼ mean=x['age'].mean() x.loc[:,'age']=x.loc[:,'age'].fillna(mean) #%% x.info() #%%  # åˆ†å‰²æ•°æ®é›†åˆ°è®­ç»ƒé›†åˆæµ‹è¯•é›† x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=4) print(x_train.head()) #%% type(x_train) #%% sum(y_train) #%% #æ€§åˆ«æ˜¯å¥³æ€§çš„æ•°é‡ x_train[x_train['sex'] == 'female'].count() #%% y_train #%% #å¥³æ€§ä¸­å­˜æ´»çš„æƒ…å†µå¯¹æ¯” z=x_train.copy() #zæ˜¯ä¸ºäº†æŠŠç‰¹å¾å’Œç›®æ ‡å­˜å‚¨åˆ°ä¸€èµ· z['survived'] = y_train #æŠŠç›®æ ‡å€¼å­˜å‚¨åˆ°zä¸­ z[z['sex'] == 'female']['survived'].value_counts() #ç”·æ€§ä¸­å­˜æ´»çš„æƒ…å†µ #%% y_train.value_counts() #æ²¡å­˜æ´»çš„æ˜¯650ï¼Œå­˜æ´»çš„æ˜¯334 #%% x_train.loc[:,'sex'].value_counts() #%% 230/(230+111) #%% #æŸ¥çœ‹æœªå­˜æ´»çš„äººçš„æ•°é‡ x_train #%% x_train.to_dict(orient="records") #æŠŠdfå˜ä¸ºå­—å…¸ï¼Œæ ·æœ¬å˜ä¸ºä¸€ä¸ªä¸€ä¸ªçš„å­—å…¸ï¼Œå­—å…¸ä¸­åˆ—åå˜ä¸ºé”® #%% # è¿›è¡Œå¤„ç†ï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰ç‰¹å¾-ã€‹ç±»åˆ«-ã€‹one_hotç¼–ç  dict = DictVectorizer(sparse=False) # è¿™ä¸€æ­¥æ˜¯å¯¹å­—å…¸è¿›è¡Œç‰¹å¾æŠ½å–,to_dictå¯ä»¥æŠŠdfå˜ä¸ºå­—å…¸ï¼Œrecordsä»£è¡¨åˆ—åå˜ä¸ºé”® x_train = dict.fit_transform(x_train.to_dict(orient="records")) print(type(x_train)) print(dict.get_feature_names_out()) print('-' * 50) x_test = dict.transform(x_test.to_dict(orient="records")) print(x_train) #%% # ç”¨å†³ç­–æ ‘è¿›è¡Œé¢„æµ‹ï¼Œä¿®æ”¹max_depthè¯•è¯•,ä¿®æ”¹criterionä¸ºentropy #æ ‘è¿‡äºå¤æ‚ï¼Œå°±ä¼šäº§ç”Ÿè¿‡æ‹Ÿåˆ dec = DecisionTreeClassifier() #è®­ç»ƒ dec.fit(x_train, y_train) # é¢„æµ‹å‡†ç¡®ç‡ print("é¢„æµ‹çš„å‡†ç¡®ç‡ï¼š", dec.score(x_test, y_test)) # å¯¼å‡ºå†³ç­–æ ‘çš„ç»“æ„ export_graphviz(dec, out_file="tree.dot",                feature_names=['age', 'pclass=1st', 'pclass=2nd', 'pclass=3rd', 'female', 'male']) #%% #è°ƒæ•´å†³ç­–æ ‘çš„å‚æ•° # åˆ†å‰²æ•°æ®é›†åˆ°è®­ç»ƒé›†åˆæµ‹è¯•é›† x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=4) # è¿›è¡Œå¤„ç†ï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰ç‰¹å¾-ã€‹ç±»åˆ«-ã€‹one_hotç¼–ç  dict = DictVectorizer(sparse=False) # è¿™ä¸€æ­¥æ˜¯å¯¹å­—å…¸è¿›è¡Œç‰¹å¾æŠ½å– x_train = dict.fit_transform(x_train.to_dict(orient="records")) x_test = dict.transform(x_test.to_dict(orient="records")) # print(x_train) # # ç”¨å†³ç­–æ ‘è¿›è¡Œé¢„æµ‹ï¼Œä¿®æ”¹max_depthä¸º10ï¼Œå‘ç°æå‡äº†,min_impurity_decreaseå¸¦æ¥çš„å¢ç›Šè¦å¤§äº0.01æ‰ä¼šè¿›è¡Œåˆ’åˆ† dec = DecisionTreeClassifier(max_depth=7,min_impurity_decrease=0.01,min_samples_split=20) dec.fit(x_train, y_train) # # # é¢„æµ‹å‡†ç¡®ç‡ print("é¢„æµ‹çš„å‡†ç¡®ç‡ï¼š", dec.score(x_test, y_test)) # # # å¯¼å‡ºå†³ç­–æ ‘çš„ç»“æ„ export_graphviz(dec, out_file="tree1.dot",                feature_names=dict.get_feature_names_out()) #%% y_train.shape #%% x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=4) # è¿›è¡Œå¤„ç†ï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰ç‰¹å¾-ã€‹ç±»åˆ«-ã€‹one_hotç¼–ç  dict = DictVectorizer(sparse=False) # è¿™ä¸€æ­¥æ˜¯å¯¹å­—å…¸è¿›è¡Œç‰¹å¾æŠ½å– x_train = dict.fit_transform(x_train.to_dict(orient="records")) x_test = dict.transform(x_test.to_dict(orient="records")) #%% # éšæœºæ£®æ—è¿›è¡Œé¢„æµ‹ ï¼ˆè¶…å‚æ•°è°ƒä¼˜ï¼‰ï¼Œn_jobså……åˆ†åˆ©ç”¨å¤šæ ¸çš„ä¸€ä¸ªå‚æ•° rf = RandomForestClassifier(n_jobs=-1) # 120, 200, 300, 500, 800, 1200,n_estimatorsæ£®æ—ä¸­å†³ç­–æ ‘çš„æ•°ç›®ï¼Œä¹Ÿå°±æ˜¯åˆ†ç±»å™¨çš„æ•°ç›® # max_samples  æ˜¯æœ€å¤§æ ·æœ¬æ•° #baggingç±»å‹ param = {"n_estimators": [1500,2000, 5000], "max_depth": [2, 3, 5, 8, 15, 25]} # ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯ gc = GridSearchCV(rf, param_grid=param, cv=3) gc.fit(x_train, y_train) print("å‡†ç¡®ç‡ï¼š", gc.score(x_test, y_test)) print("æŸ¥çœ‹é€‰æ‹©çš„å‚æ•°æ¨¡å‹ï¼š", gc.best_params_) print("é€‰æ‹©æœ€å¥½çš„æ¨¡å‹æ˜¯ï¼š", gc.best_estimator_) # print("æ¯ä¸ªè¶…å‚æ•°æ¯æ¬¡äº¤å‰éªŒè¯çš„ç»“æœï¼š", gc.cv_results_)



###### ChatGPT è¯´ï¼š

å·²æ›´æ–°ä¿å­˜çš„è®°å¿†

ä¸‹é¢æ˜¯ä½ æä¾›çš„è¿™æ®µä»£ç çš„è¯¦ç»†ä½œç”¨ä¸åŸç†è§£æï¼Œæ¶µç›–äº†ä»å¯¼åŒ…ã€ä¿¡æ¯ç†µè®¡ç®—ã€æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€å†³ç­–æ ‘å»ºæ¨¡ä¸å¯è§†åŒ–ã€å†åˆ°éšæœºæ£®æ—è°ƒå‚çš„å…¨æµç¨‹ã€‚

------

## ğŸ§  **ä¸€ã€å¯¼å…¥ç›¸å…³åº“**

```
pythonå¤åˆ¶ç¼–è¾‘from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.feature_extraction import DictVectorizer
from sklearn.tree import DecisionTreeClassifier, export_graphviz
from sklearn.ensemble import RandomForestClassifier
import pandas as pd
import numpy as np
```

ğŸ”¹ ä½œç”¨ï¼š

- `train_test_split`ï¼šç”¨äºåˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼›
- `DictVectorizer`ï¼šç”¨äºå°†ç±»åˆ«ç‰¹å¾ï¼ˆå¦‚æ€§åˆ«ï¼‰One-Hotç¼–ç ï¼›
- `DecisionTreeClassifier`ï¼šæ„å»ºå†³ç­–æ ‘æ¨¡å‹ï¼›
- `export_graphviz`ï¼šå¯¼å‡ºå†³ç­–æ ‘ä¸ºå¯è§†åŒ– `.dot` æ–‡ä»¶ï¼›
- `RandomForestClassifier`ï¼šæ„å»ºéšæœºæ£®æ—æ¨¡å‹ï¼›
- `GridSearchCV`ï¼šè¶…å‚æ•°è°ƒä¼˜ï¼ˆç½‘æ ¼æœç´¢+äº¤å‰éªŒè¯ï¼‰ï¼›
- `pandas / numpy`ï¼šæ•°æ®æ“ä½œå·¥å…·ã€‚

------

## ğŸ“ˆ **äºŒã€ä¿¡æ¯ç†µç›¸å…³è®¡ç®—ï¼ˆäº†è§£åŸç†ï¼‰**

```
pythonå¤åˆ¶ç¼–è¾‘np.log2(1/32)
1/2 * np.log2(1/2) + 1/2 * np.log2(1/2)
```

ğŸ”¹ åŸç†è¯´æ˜ï¼š

- å†³ç­–æ ‘ï¼ˆå¦‚ ID3ï¼‰ä½¿ç”¨**ä¿¡æ¯ç†µ**æˆ–**åŸºå°¼ç³»æ•°**é€‰æ‹©æœ€ä¼˜åˆ’åˆ†å±æ€§ï¼›

- ç†µçš„å…¬å¼ï¼š

  Entropy=âˆ’âˆ‘ipilogâ¡2(pi)Entropy = - \sum_i p_i \log_2(p_i)Entropy=âˆ’iâˆ‘pilog2(pi)

- æ‰€ä»¥ä½ è¿™é‡Œçš„è®¡ç®—æ˜¯ä¸ºäº†ç†è§£ï¼š

  - å•ä¸€åˆ†ç±»çš„ç†µä¸º 0ï¼›
  - å¤šåˆ†ç±»æ—¶ï¼Œç†µè¶Šå¤§ï¼Œä¸ç¡®å®šæ€§è¶Šå¤§ã€‚

------

## ğŸš¢ **ä¸‰ã€è¯»å–æ³°å¦å°¼å…‹å·æ•°æ®å¹¶äº†è§£ç‰¹å¾**

```
pythonå¤åˆ¶ç¼–è¾‘titan = pd.read_csv("./data/titanic.txt")
x = titan[['pclass', 'age', 'sex']]
y = titan['survived']
```

ğŸ”¹ æ•°æ®å­—æ®µå«ä¹‰ï¼š

- `pclass`: ä¹˜å®¢ç­‰çº§ï¼ˆ1/2/3 ç­‰èˆ±ä½ï¼‰ï¼›
- `age`: å¹´é¾„ï¼›
- `sex`: æ€§åˆ«ï¼›
- `survived`: æ˜¯å¦ç”Ÿå­˜ï¼ˆç›®æ ‡å˜é‡ï¼Œ0/1ï¼‰ã€‚

------

## ğŸ”§ **å››ã€å¤„ç†ç¼ºå¤±å€¼**

```
python


å¤åˆ¶ç¼–è¾‘
x['age'] = x['age'].fillna(x['age'].mean())
```

ğŸ”¹ `age` æœ‰ç¼ºå¤±å€¼ï¼Œç”¨å¹³å‡æ•°å¡«è¡¥ã€‚

------

## ğŸ” **äº”ã€åˆ’åˆ†è®­ç»ƒé›†ä¸æµ‹è¯•é›†**

```
python


å¤åˆ¶ç¼–è¾‘
x_train, x_test, y_train, y_test = train_test_split(...)
```

- ä¿ç•™ 25% ä¸ºæµ‹è¯•é›†ï¼›
- `random_state` æ§åˆ¶åˆ’åˆ†çš„éšæœºæ€§ï¼Œä¿è¯å¤ç°ã€‚

------

## ğŸ·ï¸ **å…­ã€ç±»åˆ«ç‰¹å¾ç¼–ç ï¼ˆOne-Hotï¼‰**

```
pythonå¤åˆ¶ç¼–è¾‘dict = DictVectorizer(sparse=False)
x_train = dict.fit_transform(x_train.to_dict(orient="records"))
```

ğŸ”¹ åŸç†è¯´æ˜ï¼š

- `sex`, `pclass` æ˜¯ç±»åˆ«å˜é‡ï¼Œæ¨¡å‹æ— æ³•ç›´æ¥ä½¿ç”¨ï¼›

- ä½¿ç”¨ `DictVectorizer` å°†å®ƒä»¬è½¬æ¢ä¸º One-Hot ç¼–ç ï¼›

- ç¤ºä¾‹ï¼š

  ```
  python
  
  
  å¤åˆ¶ç¼–è¾‘
  {'sex': 'male', 'pclass': '1st'} â†’ ['sex=male', 'sex=female', 'pclass=1st', 'pclass=2nd', 'pclass=3rd']
  ```

------

## ğŸŒ² **ä¸ƒã€è®­ç»ƒå†³ç­–æ ‘æ¨¡å‹**

```
pythonå¤åˆ¶ç¼–è¾‘dec = DecisionTreeClassifier()
dec.fit(x_train, y_train)
```

- ä¸è®¾ç½®å‚æ•°æ—¶ä½¿ç”¨é»˜è®¤é…ç½®ï¼›
- `.score(...)` è®¡ç®—æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ã€‚

------

## ğŸ“Š **å…«ã€å†³ç­–æ ‘å¯è§†åŒ–**

```
python


å¤åˆ¶ç¼–è¾‘
export_graphviz(dec, out_file="tree.dot", feature_names=[...])
```

- è¾“å‡º `.dot` æ–‡ä»¶ï¼Œç”¨ Graphviz å¯è§†åŒ–æ ‘ç»“æ„ã€‚

------

## ğŸ›ï¸ **ä¹ã€è°ƒæ•´å†³ç­–æ ‘è¶…å‚æ•°**

```
pythonå¤åˆ¶ç¼–è¾‘DecisionTreeClassifier(
    max_depth=7,
    min_impurity_decrease=0.01,
    min_samples_split=20
)
```

ğŸ”¹ å‚æ•°å«ä¹‰ï¼š

- `max_depth`ï¼šæœ€å¤§æ·±åº¦ï¼Œæ§åˆ¶è¿‡æ‹Ÿåˆï¼›
- `min_impurity_decrease`ï¼šä¿¡æ¯å¢ç›Šé˜ˆå€¼ï¼Œå°äºè¿™ä¸ªå€¼å°±ä¸å†åˆ†è£‚ï¼›
- `min_samples_split`ï¼šåˆ†è£‚æ‰€éœ€æœ€å°æ ·æœ¬æ•°ã€‚

------

## ğŸŒ³ **åã€ä½¿ç”¨éšæœºæ£®æ— + ç½‘æ ¼æœç´¢è°ƒå‚**

```
pythonå¤åˆ¶ç¼–è¾‘rf = RandomForestClassifier(n_jobs=-1)
param = {"n_estimators": [1500, 2000, 5000], "max_depth": [2, 3, 5, 8, 15, 25]}
gc = GridSearchCV(rf, param_grid=param, cv=3)
```

ğŸ”¹ éšæœºæ£®æ—ä»‹ç»ï¼š

- æ˜¯é›†æˆå­¦ä¹ ç®—æ³•ï¼Œæ„å»ºå¤šä¸ªå†³ç­–æ ‘ï¼Œç„¶åæŠ•ç¥¨ï¼›
- `n_estimators`: æ ‘çš„æ•°é‡ï¼›
- `max_depth`: æ ‘çš„æœ€å¤§æ·±åº¦ï¼›
- `n_jobs=-1`: åˆ©ç”¨æ‰€æœ‰CPUæ ¸ã€‚

ğŸ”¹ ç½‘æ ¼æœç´¢ï¼š

- ä¼šéå†æ‰€æœ‰å‚æ•°ç»„åˆï¼›
- æ¯ç»„å‚æ•°è¿›è¡Œ `cv=3` æŠ˜äº¤å‰éªŒè¯ï¼›
- è‡ªåŠ¨æ‰¾åˆ° `best_params_`ï¼ˆæœ€ä½³å‚æ•°ï¼‰å’Œ `best_estimator_`ï¼ˆæœ€ä¼˜æ¨¡å‹ï¼‰ã€‚

------

## âœ… **æ€»ç»“ï¼šæ•´ä¸ªæµç¨‹é€»è¾‘æ¸…æ™°**

| æ­¥éª¤          | è¯´æ˜                     |
| ------------- | ------------------------ |
| 1. æ•°æ®åŠ è½½   | è¯»å–æ³°å¦å°¼å…‹å·æ•°æ®       |
| 2. ç¼ºå¤±å€¼å¤„ç† | `age` å¡«è¡¥å‡å€¼           |
| 3. ç‰¹å¾å¤„ç†   | ç±»åˆ«å˜é‡ One-Hot ç¼–ç     |
| 4. å»ºæ¨¡é¢„æµ‹   | å†³ç­–æ ‘è®­ç»ƒä¸é¢„æµ‹         |
| 5. æ¨¡å‹å¯è§†åŒ– | å¯¼å‡º `.dot` æ–‡ä»¶æŸ¥çœ‹ç»“æ„ |
| 6. è°ƒå‚ä¼˜åŒ–   | æ§åˆ¶è¿‡æ‹Ÿåˆã€æå‡æ³›åŒ–èƒ½åŠ› |
| 7. éšæœºæ£®æ—   | é›†æˆæ¨¡å‹è¿›ä¸€æ­¥ä¼˜åŒ–æ•ˆæœ   |
| 8. ç½‘æ ¼æœç´¢   | è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜è¶…å‚æ•°ç»„åˆ   |



------

å¦‚æœä½ å¸Œæœ›æŠŠè¿™æ•´å¥—æµç¨‹å°è£…ä¸ºä¸€ä¸ªå‡½æ•°ã€Notebook æ•™ç¨‹æˆ– GUI åº”ç”¨ï¼Œä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥æŒ‰éœ€ç”Ÿæˆ âœ…ã€‚å¦å¤–ï¼Œå¦‚æœä½ æƒ³å¯¹æ¯” ID3ã€CARTã€éšæœºæ£®æ—ç­‰æ¨¡å‹ä¼˜åŠ£ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·åˆ†æã€‚